!function(t){function e(n){if(i[n])return i[n].exports;var s=i[n]={exports:{},id:n,loaded:!1};return t[n].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){var n=i(1),s=i(2);s(function(){var t=new n;t.start()})},function(t,e,i){var n=i(2),s=(i(3),i(7),i(8)),o=i(12),r=i(13),a=i(14),l=i(15),d=i(18),c=i(19),u=i(113),h=i(120),g=i(133),p=i(135),f=s.Application.extend({radio:r,initialize:function(t){},start:function(){this.createRequestAnimationFramePolyfill(),o.setup(ajaxurl);var t=new d,e=(new c({model:t}),new l({rootModel:t}));new u({}),new h({});if(vlsGFData.tutorialStatus.manager&&vlsGFData.tutorialStatus.folder&&vlsGFData.tutorialStatus.album&&vlsGFData.tutorialStatus.image)n("#vls-gf-layer-tutorial").remove();else{vlsGFData.tutorialStatus.manager||p.setup();new g({model:t})}var i=new a({controller:e});e.start(),i.start(),this.attachGlobalUIHandlers()},debugMessage:function(t){var e="debug: "+(t.message?t.message:"");console.log(e)},createRequestAnimationFramePolyfill:function(){window.vlsGfRequestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}()},attachGlobalUIHandlers:function(){n(document).on("mouseenter.vls-gf","[data-vls-gf-tooltip]:not(.vls-gf-no-tooltip)",function(){var t,e,i,s=n(this),o=n(window),r=s.offset(),a=s.outerHeight(),l=s.outerWidth(),d=o.width(),c=o.scrollTop(),u=s.data("vlsGfTooltipEl");if(u)return void u.addClass("vls-gf-visible");var h=s.data("vlsGfTooltip"),g=s.data("vlsGfPosition"),p=s.data("vlsGfOffset");p=p?p:0,h&&(u=n('<div class="vls-gf-tooltip"></div>').html(h),"left"===g?(t=Math.round(r.top+a/2-c),i=Math.round(d-r.left),u.addClass("vls-gf-left").css({top:t,right:i+p})):(t=Math.round(r.top+a-c),e=Math.round(r.left+l/2),d-e<40?u.addClass("vls-gf-below-edge-r").css({top:t+p,right:8}):u.addClass("vls-gf-below").css({top:t+p,left:e})),s.data("vlsGfTooltipEl",u),n("#vls-gf-app").append(u),setTimeout(function(){u.css("width",2*Math.ceil((u.outerWidth()+2)/2)),u.addClass("vls-gf-visible")},10))}),n(document).on("mouseleave.vls-gf","[data-vls-gf-tooltip]",function(){var t=n(this),e=t.data("vlsGfTooltipEl");e&&(e.removeClass("vls-gf-visible"),t.data("vlsGfTooltipEl",null),setTimeout(function(){e.remove()},200))}),n(document).on("focus.vls-gf",".vls-gf-field>input, .vls-gf-field>select, .vls-gf-field>textarea",function(){n(this).closest(".vls-gf-field").addClass("vls-gf-focus")}),n(document).on("blur.vls-gf",".vls-gf-field>input, .vls-gf-field>select, .vls-gf-field>textarea",function(){n(this).closest(".vls-gf-field").removeClass("vls-gf-focus")})}});t.exports=f},function(t,e){t.exports=jQuery.noConflict()},function(t,e,i){var n=i(4);t.exports=n.noConflict()},function(t,e,i){var n,s;(function(o){!function(r){var a="object"==typeof self&&self.self==self&&self||"object"==typeof o&&o.global==o&&o;n=[i(5),i(2),e],s=function(t,e,i){a.Backbone=r(a,i,t,e)}.apply(e,n),!(void 0!==s&&(t.exports=s))}(function(t,e,i,n){var s=t.Backbone,o=Array.prototype.slice;e.VERSION="1.2.3",e.$=n,e.noConflict=function(){return t.Backbone=s,this},e.emulateHTTP=!1,e.emulateJSON=!1;var r=function(t,e,n){switch(t){case 1:return function(){return i[e](this[n])};case 2:return function(t){return i[e](this[n],t)};case 3:return function(t,s){return i[e](this[n],l(t,this),s)};case 4:return function(t,s,o){return i[e](this[n],l(t,this),s,o)};default:return function(){var t=o.call(arguments);return t.unshift(this[n]),i[e].apply(i,t)}}},a=function(t,e,n){i.each(e,function(e,s){i[s]&&(t.prototype[s]=r(e,s,n))})},l=function(t,e){return i.isFunction(t)?t:i.isObject(t)&&!e._isModel(t)?d(t):i.isString(t)?function(e){return e.get(t)}:t},d=function(t){var e=i.matches(t);return function(t){return e(t.attributes)}},c=e.Events={},u=/\s+/,h=function(t,e,n,s,o){var r,a=0;if(n&&"object"==typeof n){void 0!==s&&"context"in o&&void 0===o.context&&(o.context=s);for(r=i.keys(n);a<r.length;a++)e=h(t,e,r[a],n[r[a]],o)}else if(n&&u.test(n))for(r=n.split(u);a<r.length;a++)e=t(e,r[a],s,o);else e=t(e,n,s,o);return e};c.on=function(t,e,i){return g(this,t,e,i)};var g=function(t,e,i,n,s){if(t._events=h(p,t._events||{},e,i,{context:n,ctx:t,listening:s}),s){var o=t._listeners||(t._listeners={});o[s.id]=s}return t};c.listenTo=function(t,e,n){if(!t)return this;var s=t._listenId||(t._listenId=i.uniqueId("l")),o=this._listeningTo||(this._listeningTo={}),r=o[s];if(!r){var a=this._listenId||(this._listenId=i.uniqueId("l"));r=o[s]={obj:t,objId:s,id:a,listeningTo:o,count:0}}return g(t,e,n,this,r),this};var p=function(t,e,i,n){if(i){var s=t[e]||(t[e]=[]),o=n.context,r=n.ctx,a=n.listening;a&&a.count++,s.push({callback:i,context:o,ctx:o||r,listening:a})}return t};c.off=function(t,e,i){return this._events?(this._events=h(f,this._events,t,e,{context:i,listeners:this._listeners}),this):this},c.stopListening=function(t,e,n){var s=this._listeningTo;if(!s)return this;for(var o=t?[t._listenId]:i.keys(s),r=0;r<o.length;r++){var a=s[o[r]];if(!a)break;a.obj.off(e,n,this)}return i.isEmpty(s)&&(this._listeningTo=void 0),this};var f=function(t,e,n,s){if(t){var o,r=0,a=s.context,l=s.listeners;if(e||n||a){for(var d=e?[e]:i.keys(t);r<d.length;r++){e=d[r];var c=t[e];if(!c)break;for(var u=[],h=0;h<c.length;h++){var g=c[h];n&&n!==g.callback&&n!==g.callback._callback||a&&a!==g.context?u.push(g):(o=g.listening,o&&0===--o.count&&(delete l[o.id],delete o.listeningTo[o.objId]))}u.length?t[e]=u:delete t[e]}return i.size(t)?t:void 0}for(var p=i.keys(l);r<p.length;r++)o=l[p[r]],delete l[o.id],delete o.listeningTo[o.objId]}};c.once=function(t,e,n){var s=h(v,{},t,e,i.bind(this.off,this));return this.on(s,void 0,n)},c.listenToOnce=function(t,e,n){var s=h(v,{},e,n,i.bind(this.stopListening,this,t));return this.listenTo(t,s)};var v=function(t,e,n,s){if(n){var o=t[e]=i.once(function(){s(e,o),n.apply(this,arguments)});o._callback=n}return t};c.trigger=function(t){if(!this._events)return this;for(var e=Math.max(0,arguments.length-1),i=Array(e),n=0;n<e;n++)i[n]=arguments[n+1];return h(m,this._events,t,void 0,i),this};var m=function(t,e,i,n){if(t){var s=t[e],o=t.all;s&&o&&(o=o.slice()),s&&_(s,n),o&&_(o,[e].concat(n))}return t},_=function(t,e){var i,n=-1,s=t.length,o=e[0],r=e[1],a=e[2];switch(e.length){case 0:for(;++n<s;)(i=t[n]).callback.call(i.ctx);return;case 1:for(;++n<s;)(i=t[n]).callback.call(i.ctx,o);return;case 2:for(;++n<s;)(i=t[n]).callback.call(i.ctx,o,r);return;case 3:for(;++n<s;)(i=t[n]).callback.call(i.ctx,o,r,a);return;default:for(;++n<s;)(i=t[n]).callback.apply(i.ctx,e);return}};c.bind=c.on,c.unbind=c.off,i.extend(e,c);var b=e.Model=function(t,e){var n=t||{};e||(e={}),this.cid=i.uniqueId(this.cidPrefix),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(n=this.parse(n,e)||{}),n=i.defaults({},n,i.result(this,"defaults")),this.set(n,e),this.changed={},this.initialize.apply(this,arguments)};i.extend(b.prototype,c,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(t){return i.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return i.escape(this.get(t))},has:function(t){return null!=this.get(t)},matches:function(t){return!!i.iteratee(t,this)(this.attributes)},set:function(t,e,n){if(null==t)return this;var s;if("object"==typeof t?(s=t,n=e):(s={})[t]=e,n||(n={}),!this._validate(s,n))return!1;var o=n.unset,r=n.silent,a=[],l=this._changing;this._changing=!0,l||(this._previousAttributes=i.clone(this.attributes),this.changed={});var d=this.attributes,c=this.changed,u=this._previousAttributes;for(var h in s)e=s[h],i.isEqual(d[h],e)||a.push(h),i.isEqual(u[h],e)?delete c[h]:c[h]=e,o?delete d[h]:d[h]=e;if(this.id=this.get(this.idAttribute),!r){a.length&&(this._pending=n);for(var g=0;g<a.length;g++)this.trigger("change:"+a[g],this,d[a[g]],n)}if(l)return this;if(!r)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,i.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var n in this.attributes)e[n]=void 0;return this.set(e,i.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!i.isEmpty(this.changed):i.has(this.changed,t)},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&i.clone(this.changed);var e=this._changing?this._previousAttributes:this.attributes,n={};for(var s in t){var o=t[s];i.isEqual(e[s],o)||(n[s]=o)}return!!i.size(n)&&n},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return i.clone(this._previousAttributes)},fetch:function(t){t=i.extend({parse:!0},t);var e=this,n=t.success;return t.success=function(i){var s=t.parse?e.parse(i,t):i;return!!e.set(s,t)&&(n&&n.call(t.context,e,i,t),void e.trigger("sync",e,i,t))},V(this,t),this.sync("read",this,t)},save:function(t,e,n){var s;null==t||"object"==typeof t?(s=t,n=e):(s={})[t]=e,n=i.extend({validate:!0,parse:!0},n);var o=n.wait;if(s&&!o){if(!this.set(s,n))return!1}else if(!this._validate(s,n))return!1;var r=this,a=n.success,l=this.attributes;n.success=function(t){r.attributes=l;var e=n.parse?r.parse(t,n):t;return o&&(e=i.extend({},s,e)),!(e&&!r.set(e,n))&&(a&&a.call(n.context,r,t,n),void r.trigger("sync",r,t,n))},V(this,n),s&&o&&(this.attributes=i.extend({},l,s));var d=this.isNew()?"create":n.patch?"patch":"update";"patch"!==d||n.attrs||(n.attrs=s);var c=this.sync(d,this,n);return this.attributes=l,c},destroy:function(t){t=t?i.clone(t):{};var e=this,n=t.success,s=t.wait,o=function(){e.stopListening(),e.trigger("destroy",e,e.collection,t)};t.success=function(i){s&&o(),n&&n.call(t.context,e,i,t),e.isNew()||e.trigger("sync",e,i,t)};var r=!1;return this.isNew()?i.defer(t.success):(V(this,t),r=this.sync("delete",this,t)),s||o(),r},url:function(){var t=i.result(this,"urlRoot")||i.result(this.collection,"url")||F();if(this.isNew())return t;var e=this.get(this.idAttribute);return t.replace(/[^\/]$/,"$&/")+encodeURIComponent(e)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},i.defaults({validate:!0},t))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=i.extend({},this.attributes,t);var n=this.validationError=this.validate(t,e)||null;return!n||(this.trigger("invalid",this,n,i.extend(e,{validationError:n})),!1)}});var y={keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1};a(b,y,"attributes");var w=e.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,i.extend({silent:!0},e))},x={add:!0,remove:!0,merge:!0},M={add:!0,remove:!1},C=function(t,e,i){i=Math.min(Math.max(i,0),t.length);for(var n=Array(t.length-i),s=e.length,o=0;o<n.length;o++)n[o]=t[o+i];for(o=0;o<s;o++)t[o+i]=e[o];for(o=0;o<n.length;o++)t[o+s+i]=n[o]};i.extend(w.prototype,c,{model:b,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return e.sync.apply(this,arguments)},add:function(t,e){return this.set(t,i.extend({merge:!1},e,M))},remove:function(t,e){e=i.extend({},e);var n=!i.isArray(t);t=n?[t]:i.clone(t);var s=this._removeModels(t,e);return!e.silent&&s&&this.trigger("update",this,e),n?s[0]:s},set:function(t,e){if(null!=t){e=i.defaults({},e,x),e.parse&&!this._isModel(t)&&(t=this.parse(t,e));var n=!i.isArray(t);t=n?[t]:t.slice();var s=e.at;null!=s&&(s=+s),s<0&&(s+=this.length+1);for(var o,r=[],a=[],l=[],d={},c=e.add,u=e.merge,h=e.remove,g=!1,p=this.comparator&&null==s&&e.sort!==!1,f=i.isString(this.comparator)?this.comparator:null,v=0;v<t.length;v++){o=t[v];var m=this.get(o);if(m){if(u&&o!==m){var _=this._isModel(o)?o.attributes:o;e.parse&&(_=m.parse(_,e)),m.set(_,e),p&&!g&&(g=m.hasChanged(f))}d[m.cid]||(d[m.cid]=!0,r.push(m)),t[v]=m}else c&&(o=t[v]=this._prepareModel(o,e),o&&(a.push(o),this._addReference(o,e),d[o.cid]=!0,r.push(o)))}if(h){for(v=0;v<this.length;v++)o=this.models[v],d[o.cid]||l.push(o);l.length&&this._removeModels(l,e)}var b=!1,y=!p&&c&&h;if(r.length&&y?(b=this.length!=r.length||i.some(this.models,function(t,e){return t!==r[e]}),this.models.length=0,C(this.models,r,0),this.length=this.models.length):a.length&&(p&&(g=!0),C(this.models,a,null==s?this.length:s),this.length=this.models.length),g&&this.sort({silent:!0}),!e.silent){for(v=0;v<a.length;v++)null!=s&&(e.index=s+v),o=a[v],o.trigger("add",o,this,e);(g||b)&&this.trigger("sort",this,e),(a.length||l.length)&&this.trigger("update",this,e)}return n?t[0]:t}},reset:function(t,e){e=e?i.clone(e):{};for(var n=0;n<this.models.length;n++)this._removeReference(this.models[n],e);return e.previousModels=this.models,this._reset(),t=this.add(t,i.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,i.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t)},unshift:function(t,e){return this.add(t,i.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t)},slice:function(){return o.apply(this.models,arguments)},get:function(t){if(null!=t){var e=this.modelId(this._isModel(t)?t.attributes:t);return this._byId[t]||this._byId[e]||this._byId[t.cid]}},at:function(t){return t<0&&(t+=this.length),this.models[t]},where:function(t,e){return this[e?"find":"filter"](t)},findWhere:function(t){return this.where(t,!0)},sort:function(t){var e=this.comparator;if(!e)throw new Error("Cannot sort a set without a comparator");t||(t={});var n=e.length;return i.isFunction(e)&&(e=i.bind(e,this)),1===n||i.isString(e)?this.models=this.sortBy(e):this.models.sort(e),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return i.invoke(this.models,"get",t)},fetch:function(t){t=i.extend({parse:!0},t);var e=t.success,n=this;return t.success=function(i){var s=t.reset?"reset":"set";n[s](i,t),e&&e.call(t.context,n,i,t),n.trigger("sync",n,i,t)},V(this,t),this.sync("read",this,t)},create:function(t,e){e=e?i.clone(e):{};var n=e.wait;if(t=this._prepareModel(t,e),!t)return!1;n||this.add(t,e);var s=this,o=e.success;return e.success=function(t,e,i){n&&s.add(t,i),o&&o.call(i.context,t,e,i)},t.save(null,e),t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(t){return t[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(this._isModel(t))return t.collection||(t.collection=this),t;e=e?i.clone(e):{},e.collection=this;var n=new this.model(t,e);return n.validationError?(this.trigger("invalid",this,n.validationError,e),!1):n},_removeModels:function(t,e){for(var i=[],n=0;n<t.length;n++){var s=this.get(t[n]);if(s){var o=this.indexOf(s);this.models.splice(o,1),this.length--,e.silent||(e.index=o,s.trigger("remove",s,this,e)),i.push(s),this._removeReference(s,e)}}return!!i.length&&i},_isModel:function(t){return t instanceof b},_addReference:function(t,e){this._byId[t.cid]=t;var i=this.modelId(t.attributes);null!=i&&(this._byId[i]=t),t.on("all",this._onModelEvent,this)},_removeReference:function(t,e){delete this._byId[t.cid];var i=this.modelId(t.attributes);null!=i&&delete this._byId[i],this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,n){if("add"!==t&&"remove"!==t||i===this){if("destroy"===t&&this.remove(e,n),"change"===t){var s=this.modelId(e.previousAttributes()),o=this.modelId(e.attributes);s!==o&&(null!=s&&delete this._byId[s],null!=o&&(this._byId[o]=e))}this.trigger.apply(this,arguments)}}});var S={forEach:3,each:3,map:3,collect:3,reduce:4,foldl:4,inject:4,reduceRight:4,foldr:4,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3};a(w,S,"models");var I=e.View=function(t){this.cid=i.uniqueId("view"),i.extend(this,i.pick(t,D)),this._ensureElement(),this.initialize.apply(this,arguments)},T=/^(\S+)\s*(.*)$/,D=["model","collection","el","id","attributes","className","tagName","events"];i.extend(I.prototype,c,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(t){return this.undelegateEvents(),this._setElement(t),this.delegateEvents(),this},_setElement:function(t){this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0]},delegateEvents:function(t){if(t||(t=i.result(this,"events")),!t)return this;this.undelegateEvents();for(var e in t){var n=t[e];if(i.isFunction(n)||(n=this[n]),n){var s=e.match(T);this.delegate(s[1],s[2],i.bind(n,this))}}return this},delegate:function(t,e,i){return this.$el.on(t+".delegateEvents"+this.cid,e,i),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(t,e,i){return this.$el.off(t+".delegateEvents"+this.cid,e,i),this},_createElement:function(t){return document.createElement(t)},_ensureElement:function(){if(this.el)this.setElement(i.result(this,"el"));else{var t=i.extend({},i.result(this,"attributes"));this.id&&(t.id=i.result(this,"id")),this.className&&(t.class=i.result(this,"className")),this.setElement(this._createElement(i.result(this,"tagName"))),this._setAttributes(t)}},_setAttributes:function(t){this.$el.attr(t)}}),e.sync=function(t,n,s){var o=A[t];i.defaults(s||(s={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var r={type:o,dataType:"json"};if(s.url||(r.url=i.result(n,"url")||F()),null!=s.data||!n||"create"!==t&&"update"!==t&&"patch"!==t||(r.contentType="application/json",r.data=JSON.stringify(s.attrs||n.toJSON(s))),s.emulateJSON&&(r.contentType="application/x-www-form-urlencoded",r.data=r.data?{model:r.data}:{}),s.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){r.type="POST",s.emulateJSON&&(r.data._method=o);var a=s.beforeSend;s.beforeSend=function(t){if(t.setRequestHeader("X-HTTP-Method-Override",o),a)return a.apply(this,arguments)}}"GET"===r.type||s.emulateJSON||(r.processData=!1);var l=s.error;s.error=function(t,e,i){s.textStatus=e,s.errorThrown=i,l&&l.call(s.context,t,e,i)};var d=s.xhr=e.ajax(i.extend(r,s));return n.trigger("request",n,d,s),d};var A={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var j=e.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},N=/\((.*?)\)/g,k=/(\(\?)?:\w+/g,L=/\*\w+/g,z=/[\-{}\[\]+?.,\\\^$|#\s]/g;i.extend(j.prototype,c,{initialize:function(){},route:function(t,n,s){i.isRegExp(t)||(t=this._routeToRegExp(t)),i.isFunction(n)&&(s=n,n=""),s||(s=this[n]);var o=this;return e.history.route(t,function(i){var r=o._extractParameters(t,i);o.execute(s,r,n)!==!1&&(o.trigger.apply(o,["route:"+n].concat(r)),o.trigger("route",n,r),e.history.trigger("route",o,n,r))}),this},execute:function(t,e,i){t&&t.apply(this,e)},navigate:function(t,i){return e.history.navigate(t,i),this},_bindRoutes:function(){if(this.routes){this.routes=i.result(this,"routes");for(var t,e=i.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(z,"\\$&").replace(N,"(?:$1)?").replace(k,function(t,e){return e?t:"([^/?]+)"}).replace(L,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,e){var n=t.exec(e).slice(1);return i.map(n,function(t,e){return e===n.length-1?t||null:t?decodeURIComponent(t):null})}});var E=e.History=function(){this.handlers=[],this.checkUrl=i.bind(this.checkUrl,this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},O=/^[#\/]|\s+$/g,B=/^\/+|\/+$/g,R=/#.*$/;E.started=!1,i.extend(E.prototype,c,{interval:50,atRoot:function(){var t=this.location.pathname.replace(/[^\/]$/,"$&/");return t===this.root&&!this.getSearch()},matchRoot:function(){var t=this.decodeFragment(this.location.pathname),e=t.slice(0,this.root.length-1)+"/";return e===this.root},decodeFragment:function(t){return decodeURI(t.replace(/%25/g,"%2525"))},getSearch:function(){var t=this.location.href.replace(/#.*/,"").match(/\?.+/);return t?t[0]:""},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getPath:function(){var t=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===t.charAt(0)?t.slice(1):t},getFragment:function(t){return null==t&&(t=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),t.replace(O,"")},start:function(t){if(E.started)throw new Error("Backbone.history has already been started");if(E.started=!0,this.options=i.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(B,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var e=this.root.slice(0,-1)||"/";return this.location.replace(e+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var n=document.body,s=n.insertBefore(this.iframe,n.firstChild).contentWindow;s.document.open(),s.document.close(),s.location.hash="#"+this.fragment}var o=window.addEventListener||function(t,e){return attachEvent("on"+t,e)};if(this._usePushState?o("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?o("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),!this.options.silent)return this.loadUrl()},stop:function(){var t=window.removeEventListener||function(t,e){return detachEvent("on"+t,e)};this._usePushState?t("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&t("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),E.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getHash(this.iframe.contentWindow)),e!==this.fragment&&(this.iframe&&this.navigate(e),void this.loadUrl())},loadUrl:function(t){return!!this.matchRoot()&&(t=this.fragment=this.getFragment(t),i.some(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0}))},navigate:function(t,e){if(!E.started)return!1;e&&e!==!0||(e={trigger:!!e}),t=this.getFragment(t||"");var i=this.root;""!==t&&"?"!==t.charAt(0)||(i=i.slice(0,-1)||"/");var n=i+t;if(t=this.decodeFragment(t.replace(R,"")),this.fragment!==t){if(this.fragment=t,this._usePushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);if(this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getHash(this.iframe.contentWindow)){var s=this.iframe.contentWindow;e.replace||(s.document.open(),s.document.close()),this._updateHash(s.location,t,e.replace)}}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,i){if(i){var n=t.href.replace(/(javascript:|#).*$/,"");t.replace(n+"#"+e)}else t.hash="#"+e}}),e.history=new E;var P=function(t,e){var n,s=this;n=t&&i.has(t,"constructor")?t.constructor:function(){return s.apply(this,arguments)},i.extend(n,s,e);var o=function(){this.constructor=n};return o.prototype=s.prototype,n.prototype=new o,t&&i.extend(n.prototype,t),n.__super__=s.prototype,n};b.extend=w.extend=j.extend=I.extend=E.extend=P;var F=function(){throw new Error('A "url" property or function must be specified')},V=function(t,e){var i=e.error;e.error=function(n){i&&i.call(e.context,t,n,e),t.trigger("error",t,n,e)}};return e})}).call(e,function(){return this}())},function(t,e,i){var n=i(6);t.exports=n.noConflict()},function(t,e,i){var n,s;(function(){function i(t){function e(e,i,n,s,o,r){for(;o>=0&&o<r;o+=t){var a=s?s[o]:o;n=i(n,e[a],a,e)}return n}return function(i,n,s,o){n=M(n,o,4);var r=!j(i)&&x.keys(i),a=(r||i).length,l=t>0?0:a-1;return arguments.length<3&&(s=i[r?r[l]:l],l+=t),e(i,n,s,r,l,a)}}function o(t){return function(e,i,n){i=C(i,n);for(var s=A(e),o=t>0?0:s-1;o>=0&&o<s;o+=t)if(i(e[o],o,e))return o;return-1}}function r(t,e,i){return function(n,s,o){var r=0,a=A(n);if("number"==typeof o)t>0?r=o>=0?o:Math.max(o+a,r):a=o>=0?Math.min(o+1,a):o+a+1;else if(i&&o&&a)return o=i(n,s),n[o]===s?o:-1;if(s!==s)return o=e(p.call(n,r,a),x.isNaN),o>=0?o+r:-1;for(o=t>0?r:a-1;o>=0&&o<a;o+=t)if(n[o]===s)return o;return-1}}function a(t,e){var i=E.length,n=t.constructor,s=x.isFunction(n)&&n.prototype||u,o="constructor";for(x.has(t,o)&&!x.contains(e,o)&&e.push(o);i--;)o=E[i],o in t&&t[o]!==s[o]&&!x.contains(e,o)&&e.push(o)}var l=this,d=l._,c=Array.prototype,u=Object.prototype,h=Function.prototype,g=c.push,p=c.slice,f=u.toString,v=u.hasOwnProperty,m=Array.isArray,_=Object.keys,b=h.bind,y=Object.create,w=function(){},x=function(t){return t instanceof x?t:this instanceof x?void(this._wrapped=t):new x(t)};"undefined"!=typeof t&&t.exports&&(e=t.exports=x),e._=x,x.VERSION="1.8.3";var M=function(t,e,i){if(void 0===e)return t;switch(null==i?3:i){case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,s){return t.call(e,i,n,s)};case 4:return function(i,n,s,o){return t.call(e,i,n,s,o)}}return function(){return t.apply(e,arguments)}},C=function(t,e,i){return null==t?x.identity:x.isFunction(t)?M(t,e,i):x.isObject(t)?x.matcher(t):x.property(t)};x.iteratee=function(t,e){return C(t,e,1/0)};var S=function(t,e){return function(i){var n=arguments.length;if(n<2||null==i)return i;for(var s=1;s<n;s++)for(var o=arguments[s],r=t(o),a=r.length,l=0;l<a;l++){var d=r[l];e&&void 0!==i[d]||(i[d]=o[d])}return i}},I=function(t){if(!x.isObject(t))return{};if(y)return y(t);w.prototype=t;var e=new w;return w.prototype=null,e},T=function(t){return function(e){return null==e?void 0:e[t]}},D=Math.pow(2,53)-1,A=T("length"),j=function(t){var e=A(t);return"number"==typeof e&&e>=0&&e<=D};x.each=x.forEach=function(t,e,i){e=M(e,i);var n,s;if(j(t))for(n=0,s=t.length;n<s;n++)e(t[n],n,t);else{var o=x.keys(t);for(n=0,s=o.length;n<s;n++)e(t[o[n]],o[n],t)}return t},x.map=x.collect=function(t,e,i){e=C(e,i);for(var n=!j(t)&&x.keys(t),s=(n||t).length,o=Array(s),r=0;r<s;r++){var a=n?n[r]:r;o[r]=e(t[a],a,t)}return o},x.reduce=x.foldl=x.inject=i(1),x.reduceRight=x.foldr=i(-1),x.find=x.detect=function(t,e,i){var n;if(n=j(t)?x.findIndex(t,e,i):x.findKey(t,e,i),void 0!==n&&n!==-1)return t[n]},x.filter=x.select=function(t,e,i){var n=[];return e=C(e,i),x.each(t,function(t,i,s){e(t,i,s)&&n.push(t)}),n},x.reject=function(t,e,i){return x.filter(t,x.negate(C(e)),i)},x.every=x.all=function(t,e,i){e=C(e,i);for(var n=!j(t)&&x.keys(t),s=(n||t).length,o=0;o<s;o++){var r=n?n[o]:o;if(!e(t[r],r,t))return!1}return!0},x.some=x.any=function(t,e,i){e=C(e,i);for(var n=!j(t)&&x.keys(t),s=(n||t).length,o=0;o<s;o++){var r=n?n[o]:o;if(e(t[r],r,t))return!0}return!1},x.contains=x.includes=x.include=function(t,e,i,n){return j(t)||(t=x.values(t)),("number"!=typeof i||n)&&(i=0),x.indexOf(t,e,i)>=0},x.invoke=function(t,e){var i=p.call(arguments,2),n=x.isFunction(e);return x.map(t,function(t){var s=n?e:t[e];return null==s?s:s.apply(t,i)})},x.pluck=function(t,e){return x.map(t,x.property(e))},x.where=function(t,e){return x.filter(t,x.matcher(e))},x.findWhere=function(t,e){return x.find(t,x.matcher(e))},x.max=function(t,e,i){var n,s,o=-(1/0),r=-(1/0);if(null==e&&null!=t){t=j(t)?t:x.values(t);for(var a=0,l=t.length;a<l;a++)n=t[a],n>o&&(o=n)}else e=C(e,i),x.each(t,function(t,i,n){s=e(t,i,n),(s>r||s===-(1/0)&&o===-(1/0))&&(o=t,r=s)});return o},x.min=function(t,e,i){var n,s,o=1/0,r=1/0;if(null==e&&null!=t){t=j(t)?t:x.values(t);for(var a=0,l=t.length;a<l;a++)n=t[a],n<o&&(o=n)}else e=C(e,i),x.each(t,function(t,i,n){s=e(t,i,n),(s<r||s===1/0&&o===1/0)&&(o=t,r=s)});return o},x.shuffle=function(t){for(var e,i=j(t)?t:x.values(t),n=i.length,s=Array(n),o=0;o<n;o++)e=x.random(0,o),e!==o&&(s[o]=s[e]),s[e]=i[o];return s},x.sample=function(t,e,i){return null==e||i?(j(t)||(t=x.values(t)),t[x.random(t.length-1)]):x.shuffle(t).slice(0,Math.max(0,e))},x.sortBy=function(t,e,i){return e=C(e,i),x.pluck(x.map(t,function(t,i,n){return{value:t,index:i,criteria:e(t,i,n)}}).sort(function(t,e){var i=t.criteria,n=e.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(i<n||void 0===n)return-1}return t.index-e.index}),"value")};var N=function(t){return function(e,i,n){var s={};return i=C(i,n),x.each(e,function(n,o){var r=i(n,o,e);t(s,n,r)}),s}};x.groupBy=N(function(t,e,i){x.has(t,i)?t[i].push(e):t[i]=[e]}),x.indexBy=N(function(t,e,i){t[i]=e}),x.countBy=N(function(t,e,i){x.has(t,i)?t[i]++:t[i]=1}),x.toArray=function(t){return t?x.isArray(t)?p.call(t):j(t)?x.map(t,x.identity):x.values(t):[]},x.size=function(t){return null==t?0:j(t)?t.length:x.keys(t).length},x.partition=function(t,e,i){e=C(e,i);var n=[],s=[];return x.each(t,function(t,i,o){(e(t,i,o)?n:s).push(t)}),[n,s]},x.first=x.head=x.take=function(t,e,i){if(null!=t)return null==e||i?t[0]:x.initial(t,t.length-e)},x.initial=function(t,e,i){return p.call(t,0,Math.max(0,t.length-(null==e||i?1:e)))},x.last=function(t,e,i){if(null!=t)return null==e||i?t[t.length-1]:x.rest(t,Math.max(0,t.length-e))},x.rest=x.tail=x.drop=function(t,e,i){return p.call(t,null==e||i?1:e)},x.compact=function(t){return x.filter(t,x.identity)};var k=function(t,e,i,n){for(var s=[],o=0,r=n||0,a=A(t);r<a;r++){var l=t[r];if(j(l)&&(x.isArray(l)||x.isArguments(l))){e||(l=k(l,e,i));var d=0,c=l.length;for(s.length+=c;d<c;)s[o++]=l[d++]}else i||(s[o++]=l)}return s};x.flatten=function(t,e){return k(t,e,!1)},x.without=function(t){return x.difference(t,p.call(arguments,1))},x.uniq=x.unique=function(t,e,i,n){x.isBoolean(e)||(n=i,i=e,e=!1),null!=i&&(i=C(i,n));for(var s=[],o=[],r=0,a=A(t);r<a;r++){var l=t[r],d=i?i(l,r,t):l;e?(r&&o===d||s.push(l),o=d):i?x.contains(o,d)||(o.push(d),s.push(l)):x.contains(s,l)||s.push(l)}return s},x.union=function(){return x.uniq(k(arguments,!0,!0))},x.intersection=function(t){for(var e=[],i=arguments.length,n=0,s=A(t);n<s;n++){var o=t[n];if(!x.contains(e,o)){for(var r=1;r<i&&x.contains(arguments[r],o);r++);r===i&&e.push(o)}}return e},x.difference=function(t){var e=k(arguments,!0,!0,1);return x.filter(t,function(t){return!x.contains(e,t)})},x.zip=function(){return x.unzip(arguments)},x.unzip=function(t){for(var e=t&&x.max(t,A).length||0,i=Array(e),n=0;n<e;n++)i[n]=x.pluck(t,n);return i},x.object=function(t,e){for(var i={},n=0,s=A(t);n<s;n++)e?i[t[n]]=e[n]:i[t[n][0]]=t[n][1];return i},x.findIndex=o(1),x.findLastIndex=o(-1),x.sortedIndex=function(t,e,i,n){i=C(i,n,1);for(var s=i(e),o=0,r=A(t);o<r;){var a=Math.floor((o+r)/2);i(t[a])<s?o=a+1:r=a}return o},x.indexOf=r(1,x.findIndex,x.sortedIndex),x.lastIndexOf=r(-1,x.findLastIndex),x.range=function(t,e,i){
null==e&&(e=t||0,t=0),i=i||1;for(var n=Math.max(Math.ceil((e-t)/i),0),s=Array(n),o=0;o<n;o++,t+=i)s[o]=t;return s};var L=function(t,e,i,n,s){if(!(n instanceof e))return t.apply(i,s);var o=I(t.prototype),r=t.apply(o,s);return x.isObject(r)?r:o};x.bind=function(t,e){if(b&&t.bind===b)return b.apply(t,p.call(arguments,1));if(!x.isFunction(t))throw new TypeError("Bind must be called on a function");var i=p.call(arguments,2),n=function(){return L(t,n,e,this,i.concat(p.call(arguments)))};return n},x.partial=function(t){var e=p.call(arguments,1),i=function(){for(var n=0,s=e.length,o=Array(s),r=0;r<s;r++)o[r]=e[r]===x?arguments[n++]:e[r];for(;n<arguments.length;)o.push(arguments[n++]);return L(t,i,this,this,o)};return i},x.bindAll=function(t){var e,i,n=arguments.length;if(n<=1)throw new Error("bindAll must be passed function names");for(e=1;e<n;e++)i=arguments[e],t[i]=x.bind(t[i],t);return t},x.memoize=function(t,e){var i=function(n){var s=i.cache,o=""+(e?e.apply(this,arguments):n);return x.has(s,o)||(s[o]=t.apply(this,arguments)),s[o]};return i.cache={},i},x.delay=function(t,e){var i=p.call(arguments,2);return setTimeout(function(){return t.apply(null,i)},e)},x.defer=x.partial(x.delay,x,1),x.throttle=function(t,e,i){var n,s,o,r=null,a=0;i||(i={});var l=function(){a=i.leading===!1?0:x.now(),r=null,o=t.apply(n,s),r||(n=s=null)};return function(){var d=x.now();a||i.leading!==!1||(a=d);var c=e-(d-a);return n=this,s=arguments,c<=0||c>e?(r&&(clearTimeout(r),r=null),a=d,o=t.apply(n,s),r||(n=s=null)):r||i.trailing===!1||(r=setTimeout(l,c)),o}},x.debounce=function(t,e,i){var n,s,o,r,a,l=function(){var d=x.now()-r;d<e&&d>=0?n=setTimeout(l,e-d):(n=null,i||(a=t.apply(o,s),n||(o=s=null)))};return function(){o=this,s=arguments,r=x.now();var d=i&&!n;return n||(n=setTimeout(l,e)),d&&(a=t.apply(o,s),o=s=null),a}},x.wrap=function(t,e){return x.partial(e,t)},x.negate=function(t){return function(){return!t.apply(this,arguments)}},x.compose=function(){var t=arguments,e=t.length-1;return function(){for(var i=e,n=t[e].apply(this,arguments);i--;)n=t[i].call(this,n);return n}},x.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},x.before=function(t,e){var i;return function(){return--t>0&&(i=e.apply(this,arguments)),t<=1&&(e=null),i}},x.once=x.partial(x.before,2);var z=!{toString:null}.propertyIsEnumerable("toString"),E=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];x.keys=function(t){if(!x.isObject(t))return[];if(_)return _(t);var e=[];for(var i in t)x.has(t,i)&&e.push(i);return z&&a(t,e),e},x.allKeys=function(t){if(!x.isObject(t))return[];var e=[];for(var i in t)e.push(i);return z&&a(t,e),e},x.values=function(t){for(var e=x.keys(t),i=e.length,n=Array(i),s=0;s<i;s++)n[s]=t[e[s]];return n},x.mapObject=function(t,e,i){e=C(e,i);for(var n,s=x.keys(t),o=s.length,r={},a=0;a<o;a++)n=s[a],r[n]=e(t[n],n,t);return r},x.pairs=function(t){for(var e=x.keys(t),i=e.length,n=Array(i),s=0;s<i;s++)n[s]=[e[s],t[e[s]]];return n},x.invert=function(t){for(var e={},i=x.keys(t),n=0,s=i.length;n<s;n++)e[t[i[n]]]=i[n];return e},x.functions=x.methods=function(t){var e=[];for(var i in t)x.isFunction(t[i])&&e.push(i);return e.sort()},x.extend=S(x.allKeys),x.extendOwn=x.assign=S(x.keys),x.findKey=function(t,e,i){e=C(e,i);for(var n,s=x.keys(t),o=0,r=s.length;o<r;o++)if(n=s[o],e(t[n],n,t))return n},x.pick=function(t,e,i){var n,s,o={},r=t;if(null==r)return o;x.isFunction(e)?(s=x.allKeys(r),n=M(e,i)):(s=k(arguments,!1,!1,1),n=function(t,e,i){return e in i},r=Object(r));for(var a=0,l=s.length;a<l;a++){var d=s[a],c=r[d];n(c,d,r)&&(o[d]=c)}return o},x.omit=function(t,e,i){if(x.isFunction(e))e=x.negate(e);else{var n=x.map(k(arguments,!1,!1,1),String);e=function(t,e){return!x.contains(n,e)}}return x.pick(t,e,i)},x.defaults=S(x.allKeys,!0),x.create=function(t,e){var i=I(t);return e&&x.extendOwn(i,e),i},x.clone=function(t){return x.isObject(t)?x.isArray(t)?t.slice():x.extend({},t):t},x.tap=function(t,e){return e(t),t},x.isMatch=function(t,e){var i=x.keys(e),n=i.length;if(null==t)return!n;for(var s=Object(t),o=0;o<n;o++){var r=i[o];if(e[r]!==s[r]||!(r in s))return!1}return!0};var O=function(t,e,i,n){if(t===e)return 0!==t||1/t===1/e;if(null==t||null==e)return t===e;t instanceof x&&(t=t._wrapped),e instanceof x&&(e=e._wrapped);var s=f.call(t);if(s!==f.call(e))return!1;switch(s){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!==+t?+e!==+e:0===+t?1/+t===1/e:+t===+e;case"[object Date]":case"[object Boolean]":return+t===+e}var o="[object Array]"===s;if(!o){if("object"!=typeof t||"object"!=typeof e)return!1;var r=t.constructor,a=e.constructor;if(r!==a&&!(x.isFunction(r)&&r instanceof r&&x.isFunction(a)&&a instanceof a)&&"constructor"in t&&"constructor"in e)return!1}i=i||[],n=n||[];for(var l=i.length;l--;)if(i[l]===t)return n[l]===e;if(i.push(t),n.push(e),o){if(l=t.length,l!==e.length)return!1;for(;l--;)if(!O(t[l],e[l],i,n))return!1}else{var d,c=x.keys(t);if(l=c.length,x.keys(e).length!==l)return!1;for(;l--;)if(d=c[l],!x.has(e,d)||!O(t[d],e[d],i,n))return!1}return i.pop(),n.pop(),!0};x.isEqual=function(t,e){return O(t,e)},x.isEmpty=function(t){return null==t||(j(t)&&(x.isArray(t)||x.isString(t)||x.isArguments(t))?0===t.length:0===x.keys(t).length)},x.isElement=function(t){return!(!t||1!==t.nodeType)},x.isArray=m||function(t){return"[object Array]"===f.call(t)},x.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},x.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(t){x["is"+t]=function(e){return f.call(e)==="[object "+t+"]"}}),x.isArguments(arguments)||(x.isArguments=function(t){return x.has(t,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(x.isFunction=function(t){return"function"==typeof t||!1}),x.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},x.isNaN=function(t){return x.isNumber(t)&&t!==+t},x.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"===f.call(t)},x.isNull=function(t){return null===t},x.isUndefined=function(t){return void 0===t},x.has=function(t,e){return null!=t&&v.call(t,e)},x.noConflict=function(){return l._=d,this},x.identity=function(t){return t},x.constant=function(t){return function(){return t}},x.noop=function(){},x.property=T,x.propertyOf=function(t){return null==t?function(){}:function(e){return t[e]}},x.matcher=x.matches=function(t){return t=x.extendOwn({},t),function(e){return x.isMatch(e,t)}},x.times=function(t,e,i){var n=Array(Math.max(0,t));e=M(e,i,1);for(var s=0;s<t;s++)n[s]=e(s);return n},x.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},x.now=Date.now||function(){return(new Date).getTime()};var B={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},R=x.invert(B),P=function(t){var e=function(e){return t[e]},i="(?:"+x.keys(t).join("|")+")",n=RegExp(i),s=RegExp(i,"g");return function(t){return t=null==t?"":""+t,n.test(t)?t.replace(s,e):t}};x.escape=P(B),x.unescape=P(R),x.result=function(t,e,i){var n=null==t?void 0:t[e];return void 0===n&&(n=i),x.isFunction(n)?n.call(t):n};var F=0;x.uniqueId=function(t){var e=++F+"";return t?t+e:e},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var V=/(.)^/,H={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},$=/\\|'|\r|\n|\u2028|\u2029/g,G=function(t){return"\\"+H[t]};x.template=function(t,e,i){!e&&i&&(e=i),e=x.defaults({},e,x.templateSettings);var n=RegExp([(e.escape||V).source,(e.interpolate||V).source,(e.evaluate||V).source].join("|")+"|$","g"),s=0,o="__p+='";t.replace(n,function(e,i,n,r,a){return o+=t.slice(s,a).replace($,G),s=a+e.length,i?o+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'":n?o+="'+\n((__t=("+n+"))==null?'':__t)+\n'":r&&(o+="';\n"+r+"\n__p+='"),e}),o+="';\n",e.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{var r=new Function(e.variable||"obj","_",o)}catch(t){throw t.source=o,t}var a=function(t){return r.call(this,t,x)},l=e.variable||"obj";return a.source="function("+l+"){\n"+o+"}",a},x.chain=function(t){var e=x(t);return e._chain=!0,e};var W=function(t,e){return t._chain?x(e).chain():e};x.mixin=function(t){x.each(x.functions(t),function(e){var i=x[e]=t[e];x.prototype[e]=function(){var t=[this._wrapped];return g.apply(t,arguments),W(this,i.apply(x,t))}})},x.mixin(x),x.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=c[t];x.prototype[t]=function(){var i=this._wrapped;return e.apply(i,arguments),"shift"!==t&&"splice"!==t||0!==i.length||delete i[0],W(this,i)}}),x.each(["concat","join","slice"],function(t){var e=c[t];x.prototype[t]=function(){return W(this,e.apply(this._wrapped,arguments))}}),x.prototype.value=function(){return this._wrapped},x.prototype.valueOf=x.prototype.toJSON=x.prototype.value,x.prototype.toString=function(){return""+this._wrapped},n=[],s=function(){return x}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(this)},function(t,e,i){var n,s;n=[i(8),i(11),i(5)],s=function(t,e,i){"use strict";t.Application.prototype._initChannel=function(){this.channelName=i.result(this,"channelName")||"global",this.channel=i.result(this,"channel")||e.channel(this.channelName)}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;!function(o,r){n=[i(3),i(5),i(9),i(10)],s=function(t,e){return o.Marionette=o.Mn=r(o,t,e)}.apply(e,n),!(void 0!==s&&(t.exports=s))}(this,function(t,e,i){"use strict";var n=t.Marionette,s=t.Mn,o=e.Marionette={};o.VERSION="2.4.7",o.noConflict=function(){return t.Marionette=n,t.Mn=s,this},o.Deferred=e.$.Deferred,o.FEATURES={},o.isEnabled=function(t){return!!o.FEATURES[t]},o.extend=e.Model.extend,o.isNodeAttached=function(t){return e.$.contains(document.documentElement,t)},o.mergeOptions=function(t,e){t&&i.extend(this,i.pick(t,e))},o.getOption=function(t,e){if(t&&e)return t.options&&void 0!==t.options[e]?t.options[e]:t[e]},o.proxyGetOption=function(t){return o.getOption(this,t)},o._getValue=function(t,e,n){return i.isFunction(t)&&(t=n?t.apply(e,n):t.call(e)),t},o.normalizeMethods=function(t){return i.reduce(t,function(t,e,n){return i.isFunction(e)||(e=this[e]),e&&(t[n]=e),t},{},this)},o.normalizeUIString=function(t,e){return t.replace(/@ui\.[a-zA-Z-_$0-9]*/g,function(t){return e[t.slice(4)]})},o.normalizeUIKeys=function(t,e){return i.reduce(t,function(t,i,n){var s=o.normalizeUIString(n,e);return t[s]=i,t},{})},o.normalizeUIValues=function(t,e,n){return i.each(t,function(s,r){i.isString(s)?t[r]=o.normalizeUIString(s,e):i.isObject(s)&&i.isArray(n)&&(i.extend(s,o.normalizeUIValues(i.pick(s,n),e)),i.each(n,function(t){var n=s[t];i.isString(n)&&(s[t]=o.normalizeUIString(n,e))}))}),t},o.actAsCollection=function(t,e){var n=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];i.each(n,function(n){t[n]=function(){var t=i.values(i.result(this,e)),s=[t].concat(i.toArray(arguments));return i[n].apply(i,s)}})};var r=o.deprecate=function(t,e){i.isObject(t)&&(t=t.prev+" is going to be removed in the future. Please use "+t.next+" instead."+(t.url?" See: "+t.url:"")),void 0!==e&&e||r._cache[t]||(r._warn("Deprecation warning: "+t),r._cache[t]=!0)};r._console="undefined"!=typeof console?console:{},r._warn=function(){var t=r._console.warn||r._console.log||function(){};return t.apply(r._console,arguments)},r._cache={},o._triggerMethod=function(){function t(t,e,i){return i.toUpperCase()}var e=/(^|:)(\w)/gi;return function(n,s,o){var r=arguments.length<3;r&&(o=s,s=o[0]);var a,l="on"+s.replace(e,t),d=n[l];return i.isFunction(d)&&(a=d.apply(n,r?i.rest(o):o)),i.isFunction(n.trigger)&&(r+o.length>1?n.trigger.apply(n,r?o:[s].concat(i.drop(o,0))):n.trigger(s)),a}}(),o.triggerMethod=function(t){return o._triggerMethod(this,arguments)},o.triggerMethodOn=function(t){var e=i.isFunction(t.triggerMethod)?t.triggerMethod:o.triggerMethod;return e.apply(t,i.rest(arguments))},o.MonitorDOMRefresh=function(t){function e(){t._isShown=!0,n()}function i(){t._isRendered=!0,n()}function n(){t._isShown&&t._isRendered&&o.isNodeAttached(t.el)&&o.triggerMethodOn(t,"dom:refresh",t)}t._isDomRefreshMonitored||(t._isDomRefreshMonitored=!0,t.on({show:e,render:i}))},function(t){function e(e,n,s,o){var r=o.split(/\s+/);i.each(r,function(i){var o=e[i];if(!o)throw new t.Error('Method "'+i+'" was configured as an event handler, but does not exist.');e.listenTo(n,s,o)})}function n(t,e,i,n){t.listenTo(e,i,n)}function s(t,e,n,s){var o=s.split(/\s+/);i.each(o,function(i){var s=t[i];t.stopListening(e,n,s)})}function o(t,e,i,n){t.stopListening(e,i,n)}function r(e,n,s,o,r){if(n&&s){if(!i.isObject(s))throw new t.Error({message:"Bindings must be an object or function.",url:"marionette.functions.html#marionettebindentityevents"});s=t._getValue(s,e),i.each(s,function(t,s){i.isFunction(t)?o(e,n,s,t):r(e,n,s,t)})}}t.bindEntityEvents=function(t,i,s){r(t,i,s,n,e)},t.unbindEntityEvents=function(t,e,i){r(t,e,i,o,s)},t.proxyBindEntityEvents=function(e,i){return t.bindEntityEvents(this,e,i)},t.proxyUnbindEntityEvents=function(e,i){return t.unbindEntityEvents(this,e,i)}}(o);var a=["description","fileName","lineNumber","name","message","number"];return o.Error=o.extend.call(Error,{urlRoot:"http://marionettejs.com/docs/v"+o.VERSION+"/",constructor:function(t,e){i.isObject(t)?(e=t,t=e.message):e||(e={});var n=Error.call(this,t);i.extend(this,i.pick(n,a),i.pick(e,a)),this.captureStackTrace(),e.url&&(this.url=this.urlRoot+e.url)},captureStackTrace:function(){Error.captureStackTrace&&Error.captureStackTrace(this,o.Error)},toString:function(){return this.name+": "+this.message+(this.url?" See: "+this.url:"")}}),o.Error.extend=o.extend,o.Callbacks=function(){this._deferred=o.Deferred(),this._callbacks=[]},i.extend(o.Callbacks.prototype,{add:function(t,e){var n=i.result(this._deferred,"promise");this._callbacks.push({cb:t,ctx:e}),n.then(function(i){e&&(i.context=e),t.call(i.context,i.options)})},run:function(t,e){this._deferred.resolve({options:t,context:e})},reset:function(){var t=this._callbacks;this._deferred=o.Deferred(),this._callbacks=[],i.each(t,function(t){this.add(t.cb,t.ctx)},this)}}),o.Controller=function(t){this.options=t||{},i.isFunction(this.initialize)&&this.initialize(this.options)},o.Controller.extend=o.extend,i.extend(o.Controller.prototype,e.Events,{destroy:function(){return o._triggerMethod(this,"before:destroy",arguments),o._triggerMethod(this,"destroy",arguments),this.stopListening(),this.off(),this},triggerMethod:o.triggerMethod,mergeOptions:o.mergeOptions,getOption:o.proxyGetOption}),o.Object=function(t){this.options=i.extend({},i.result(this,"options"),t),this.initialize.apply(this,arguments)},o.Object.extend=o.extend,i.extend(o.Object.prototype,e.Events,{initialize:function(){},destroy:function(t){return t=t||{},this.triggerMethod("before:destroy",t),this.triggerMethod("destroy",t),this.stopListening(),this},triggerMethod:o.triggerMethod,mergeOptions:o.mergeOptions,getOption:o.proxyGetOption,bindEntityEvents:o.proxyBindEntityEvents,unbindEntityEvents:o.proxyUnbindEntityEvents}),o.Region=o.Object.extend({constructor:function(t){if(this.options=t||{},this.el=this.getOption("el"),this.el=this.el instanceof e.$?this.el[0]:this.el,!this.el)throw new o.Error({name:"NoElError",message:'An "el" must be specified for a region.'});this.$el=this.getEl(this.el),o.Object.call(this,t)},show:function(t,e){if(this._ensureElement()){this._ensureViewIsIntact(t),o.MonitorDOMRefresh(t);var n=e||{},s=t!==this.currentView,r=!!n.preventDestroy,a=!!n.forceShow,l=!!this.currentView,d=s&&!r,c=s||a;if(l&&this.triggerMethod("before:swapOut",this.currentView,this,e),this.currentView&&s&&delete this.currentView._parent,d?this.empty():l&&c&&this.currentView.off("destroy",this.empty,this),c){t.once("destroy",this.empty,this),t._parent=this,this._renderView(t),l&&this.triggerMethod("before:swap",t,this,e),this.triggerMethod("before:show",t,this,e),o.triggerMethodOn(t,"before:show",t,this,e),l&&this.triggerMethod("swapOut",this.currentView,this,e);var u=o.isNodeAttached(this.el),h=[],g=i.extend({triggerBeforeAttach:this.triggerBeforeAttach,triggerAttach:this.triggerAttach},n);return u&&g.triggerBeforeAttach&&(h=this._displayedViews(t),this._triggerAttach(h,"before:")),this.attachHtml(t),this.currentView=t,u&&g.triggerAttach&&(h=this._displayedViews(t),this._triggerAttach(h)),l&&this.triggerMethod("swap",t,this,e),this.triggerMethod("show",t,this,e),o.triggerMethodOn(t,"show",t,this,e),this}return this}},triggerBeforeAttach:!0,triggerAttach:!0,_triggerAttach:function(t,e){var n=(e||"")+"attach";i.each(t,function(t){o.triggerMethodOn(t,n,t,this)},this)},_displayedViews:function(t){return i.union([t],i.result(t,"_getNestedViews")||[])},_renderView:function(t){t.supportsRenderLifecycle||o.triggerMethodOn(t,"before:render",t),t.render(),t.supportsRenderLifecycle||o.triggerMethodOn(t,"render",t)},_ensureElement:function(){if(i.isObject(this.el)||(this.$el=this.getEl(this.el),this.el=this.$el[0]),!this.$el||0===this.$el.length){if(this.getOption("allowMissingEl"))return!1;throw new o.Error('An "el" '+this.$el.selector+" must exist in DOM")}return!0},_ensureViewIsIntact:function(t){if(!t)throw new o.Error({name:"ViewNotValid",message:"The view passed is undefined and therefore invalid. You must pass a view instance to show."});if(t.isDestroyed)throw new o.Error({name:"ViewDestroyedError",message:'View (cid: "'+t.cid+'") has already been destroyed and cannot be used.'})},getEl:function(t){return e.$(t,o._getValue(this.options.parentEl,this))},attachHtml:function(t){this.$el.contents().detach(),this.el.appendChild(t.el)},empty:function(t){var e=this.currentView,i=t||{},n=!!i.preventDestroy;return e?(e.off("destroy",this.empty,this),this.triggerMethod("before:empty",e),n||this._destroyView(),this.triggerMethod("empty",e),delete this.currentView,n&&this.$el.contents().detach(),this):this},_destroyView:function(){var t=this.currentView;t.isDestroyed||(t.supportsDestroyLifecycle||o.triggerMethodOn(t,"before:destroy",t),t.destroy?t.destroy():(t.remove(),t.isDestroyed=!0),t.supportsDestroyLifecycle||o.triggerMethodOn(t,"destroy",t))},attachView:function(t){return this.currentView&&delete this.currentView._parent,t._parent=this,this.currentView=t,this},hasView:function(){return!!this.currentView},reset:function(){return this.empty(),this.$el&&(this.el=this.$el.selector),delete this.$el,this}},{buildRegion:function(t,e){if(i.isString(t))return this._buildRegionFromSelector(t,e);if(t.selector||t.el||t.regionClass)return this._buildRegionFromObject(t,e);if(i.isFunction(t))return this._buildRegionFromRegionClass(t);throw new o.Error({message:"Improper region configuration type.",url:"marionette.region.html#region-configuration-types"})},_buildRegionFromSelector:function(t,e){return new e({el:t})},_buildRegionFromObject:function(t,e){var n=t.regionClass||e,s=i.omit(t,"selector","regionClass");return t.selector&&!s.el&&(s.el=t.selector),new n(s)},_buildRegionFromRegionClass:function(t){return new t}}),o.RegionManager=o.Controller.extend({constructor:function(t){this._regions={},this.length=0,o.Controller.call(this,t),this.addRegions(this.getOption("regions"))},addRegions:function(t,e){return t=o._getValue(t,this,arguments),i.reduce(t,function(t,n,s){return i.isString(n)&&(n={selector:n}),n.selector&&(n=i.defaults({},n,e)),t[s]=this.addRegion(s,n),t},{},this)},addRegion:function(t,e){var i;return i=e instanceof o.Region?e:o.Region.buildRegion(e,o.Region),this.triggerMethod("before:add:region",t,i),i._parent=this,this._store(t,i),this.triggerMethod("add:region",t,i),i},get:function(t){return this._regions[t]},getRegions:function(){return i.clone(this._regions)},removeRegion:function(t){var e=this._regions[t];return this._remove(t,e),e},removeRegions:function(){var t=this.getRegions();return i.each(this._regions,function(t,e){this._remove(e,t)},this),t},emptyRegions:function(){var t=this.getRegions();return i.invoke(t,"empty"),t},destroy:function(){return this.removeRegions(),o.Controller.prototype.destroy.apply(this,arguments)},_store:function(t,e){this._regions[t]||this.length++,this._regions[t]=e},_remove:function(t,e){this.triggerMethod("before:remove:region",t,e),e.empty(),e.stopListening(),delete e._parent,delete this._regions[t],this.length--,this.triggerMethod("remove:region",t,e)}}),o.actAsCollection(o.RegionManager.prototype,"_regions"),o.TemplateCache=function(t){this.templateId=t},i.extend(o.TemplateCache,{templateCaches:{},get:function(t,e){var i=this.templateCaches[t];return i||(i=new o.TemplateCache(t),this.templateCaches[t]=i),i.load(e)},clear:function(){var t,e=i.toArray(arguments),n=e.length;if(n>0)for(t=0;t<n;t++)delete this.templateCaches[e[t]];else this.templateCaches={}}}),i.extend(o.TemplateCache.prototype,{load:function(t){if(this.compiledTemplate)return this.compiledTemplate;var e=this.loadTemplate(this.templateId,t);return this.compiledTemplate=this.compileTemplate(e,t),this.compiledTemplate},loadTemplate:function(t,i){var n=e.$(t);if(!n.length)throw new o.Error({name:"NoTemplateError",message:'Could not find template: "'+t+'"'});return n.html()},compileTemplate:function(t,e){return i.template(t,e)}}),o.Renderer={render:function(t,e){if(!t)throw new o.Error({name:"TemplateNotFoundError",message:"Cannot render the template since its false, null or undefined."});var n=i.isFunction(t)?t:o.TemplateCache.get(t);return n(e)}},o.View=e.View.extend({isDestroyed:!1,supportsRenderLifecycle:!0,supportsDestroyLifecycle:!0,constructor:function(t){this.render=i.bind(this.render,this),t=o._getValue(t,this),this.options=i.extend({},i.result(this,"options"),t),this._behaviors=o.Behaviors(this),e.View.call(this,this.options),o.MonitorDOMRefresh(this)},getTemplate:function(){return this.getOption("template")},serializeModel:function(t){return t.toJSON.apply(t,i.rest(arguments))},mixinTemplateHelpers:function(t){t=t||{};var e=this.getOption("templateHelpers");return e=o._getValue(e,this),i.extend(t,e)},normalizeUIKeys:function(t){var e=i.result(this,"_uiBindings");return o.normalizeUIKeys(t,e||i.result(this,"ui"))},normalizeUIValues:function(t,e){var n=i.result(this,"ui"),s=i.result(this,"_uiBindings");return o.normalizeUIValues(t,s||n,e)},configureTriggers:function(){if(this.triggers){var t=this.normalizeUIKeys(i.result(this,"triggers"));return i.reduce(t,function(t,e,i){return t[i]=this._buildViewTrigger(e),t},{},this)}},delegateEvents:function(t){return this._delegateDOMEvents(t),this.bindEntityEvents(this.model,this.getOption("modelEvents")),this.bindEntityEvents(this.collection,this.getOption("collectionEvents")),i.each(this._behaviors,function(t){t.bindEntityEvents(this.model,t.getOption("modelEvents")),t.bindEntityEvents(this.collection,t.getOption("collectionEvents"))},this),this},_delegateDOMEvents:function(t){var n=o._getValue(t||this.events,this);n=this.normalizeUIKeys(n),i.isUndefined(t)&&(this.events=n);var s={},r=i.result(this,"behaviorEvents")||{},a=this.configureTriggers(),l=i.result(this,"behaviorTriggers")||{};i.extend(s,r,n,a,l),e.View.prototype.delegateEvents.call(this,s)},undelegateEvents:function(){return e.View.prototype.undelegateEvents.apply(this,arguments),this.unbindEntityEvents(this.model,this.getOption("modelEvents")),this.unbindEntityEvents(this.collection,this.getOption("collectionEvents")),i.each(this._behaviors,function(t){t.unbindEntityEvents(this.model,t.getOption("modelEvents")),t.unbindEntityEvents(this.collection,t.getOption("collectionEvents"))},this),this},_ensureViewIsIntact:function(){if(this.isDestroyed)throw new o.Error({name:"ViewDestroyedError",message:'View (cid: "'+this.cid+'") has already been destroyed and cannot be used.'})},destroy:function(){if(this.isDestroyed)return this;var t=i.toArray(arguments);return this.triggerMethod.apply(this,["before:destroy"].concat(t)),this.isDestroyed=!0,this.triggerMethod.apply(this,["destroy"].concat(t)),this.unbindUIElements(),this.isRendered=!1,this.remove(),i.invoke(this._behaviors,"destroy",t),this},bindUIElements:function(){this._bindUIElements(),i.invoke(this._behaviors,this._bindUIElements)},_bindUIElements:function(){if(this.ui){this._uiBindings||(this._uiBindings=this.ui);var t=i.result(this,"_uiBindings");this.ui={},i.each(t,function(t,e){this.ui[e]=this.$(t)},this)}},unbindUIElements:function(){this._unbindUIElements(),i.invoke(this._behaviors,this._unbindUIElements)},_unbindUIElements:function(){this.ui&&this._uiBindings&&(i.each(this.ui,function(t,e){delete this.ui[e]},this),this.ui=this._uiBindings,delete this._uiBindings)},_buildViewTrigger:function(t){var e=i.defaults({},t,{preventDefault:!0,stopPropagation:!0}),n=i.isObject(t)?e.event:t;return function(t){t&&(t.preventDefault&&e.preventDefault&&t.preventDefault(),t.stopPropagation&&e.stopPropagation&&t.stopPropagation());var i={view:this,model:this.model,collection:this.collection};this.triggerMethod(n,i)}},setElement:function(){var t=e.View.prototype.setElement.apply(this,arguments);return i.invoke(this._behaviors,"proxyViewProperties",this),t},triggerMethod:function(){var t=o._triggerMethod(this,arguments);return this._triggerEventOnBehaviors(arguments),this._triggerEventOnParentLayout(arguments[0],i.rest(arguments)),t},_triggerEventOnBehaviors:function(t){for(var e=o._triggerMethod,i=this._behaviors,n=0,s=i&&i.length;n<s;n++)e(i[n],t)},_triggerEventOnParentLayout:function(t,e){var n=this._parentLayoutView();if(n){var s=o.getOption(n,"childViewEventPrefix"),r=s+":"+t,a=[this].concat(e);o._triggerMethod(n,r,a);var l=o.getOption(n,"childEvents");l=o._getValue(l,n);var d=n.normalizeMethods(l);d&&i.isFunction(d[t])&&d[t].apply(n,a)}},_getImmediateChildren:function(){return[]},_getNestedViews:function(){var t=this._getImmediateChildren();return t.length?i.reduce(t,function(t,e){return e._getNestedViews?t.concat(e._getNestedViews()):t},t):t},_parentLayoutView:function(){for(var t=this._parent;t;){if(t instanceof o.LayoutView)return t;t=t._parent}},normalizeMethods:o.normalizeMethods,mergeOptions:o.mergeOptions,getOption:o.proxyGetOption,bindEntityEvents:o.proxyBindEntityEvents,unbindEntityEvents:o.proxyUnbindEntityEvents}),o.ItemView=o.View.extend({constructor:function(){o.View.apply(this,arguments)},serializeData:function(){if(!this.model&&!this.collection)return{};var t=[this.model||this.collection];return arguments.length&&t.push.apply(t,arguments),this.model?this.serializeModel.apply(this,t):{items:this.serializeCollection.apply(this,t)}},serializeCollection:function(t){return t.toJSON.apply(t,i.rest(arguments))},render:function(){return this._ensureViewIsIntact(),this.triggerMethod("before:render",this),this._renderTemplate(),this.isRendered=!0,this.bindUIElements(),this.triggerMethod("render",this),this},_renderTemplate:function(){var t=this.getTemplate();if(t!==!1){if(!t)throw new o.Error({name:"UndefinedTemplateError",message:"Cannot render the template since it is null or undefined."});var e=this.mixinTemplateHelpers(this.serializeData()),i=o.Renderer.render(t,e,this);return this.attachElContent(i),this}},attachElContent:function(t){return this.$el.html(t),this}}),o.CollectionView=o.View.extend({childViewEventPrefix:"childview",sort:!0,constructor:function(t){this.once("render",this._initialEvents),this._initChildViewStorage(),o.View.apply(this,arguments),this.on({"before:show":this._onBeforeShowCalled,show:this._onShowCalled,"before:attach":this._onBeforeAttachCalled,attach:this._onAttachCalled}),this.initRenderBuffer()},initRenderBuffer:function(){this._bufferedChildren=[]},startBuffering:function(){this.initRenderBuffer(),this.isBuffering=!0},endBuffering:function(){var t,e=this._isShown&&o.isNodeAttached(this.el);this.isBuffering=!1,this._isShown&&this._triggerMethodMany(this._bufferedChildren,this,"before:show"),e&&this._triggerBeforeAttach&&(t=this._getNestedViews(),this._triggerMethodMany(t,this,"before:attach")),this.attachBuffer(this,this._createBuffer()),e&&this._triggerAttach&&(t=this._getNestedViews(),this._triggerMethodMany(t,this,"attach")),this._isShown&&this._triggerMethodMany(this._bufferedChildren,this,"show"),this.initRenderBuffer()},_triggerMethodMany:function(t,e,n){var s=i.drop(arguments,3);i.each(t,function(t){o.triggerMethodOn.apply(t,[t,n,t,e].concat(s))})},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"remove",this._onCollectionRemove),this.listenTo(this.collection,"reset",this.render),this.getOption("sort")&&this.listenTo(this.collection,"sort",this._sortViews))},_onCollectionAdd:function(t,e,n){var s=void 0!==n.at&&(n.index||e.indexOf(t));if((this.getOption("filter")||s===!1)&&(s=i.indexOf(this._filteredSortedModels(s),t)),this._shouldAddChild(t,s)){this.destroyEmptyView();var o=this.getChildView(t);this.addChild(t,o,s)}},_onCollectionRemove:function(t){var e=this.children.findByModel(t);this.removeChildView(e),this.checkEmpty()},_onBeforeShowCalled:function(){this._triggerBeforeAttach=this._triggerAttach=!1,this.children.each(function(t){o.triggerMethodOn(t,"before:show",t)})},_onShowCalled:function(){this.children.each(function(t){o.triggerMethodOn(t,"show",t)})},_onBeforeAttachCalled:function(){this._triggerBeforeAttach=!0},_onAttachCalled:function(){this._triggerAttach=!0},render:function(){return this._ensureViewIsIntact(),this.triggerMethod("before:render",this),this._renderChildren(),this.isRendered=!0,this.triggerMethod("render",this),this},reorder:function(){var t=this.children,e=this._filteredSortedModels();if(!e.length&&this._showingEmptyView)return this;var n=i.some(e,function(e){return!t.findByModel(e)});if(n)this.render();else{var s=i.map(e,function(e,i){var n=t.findByModel(e);return n._index=i,n.el}),o=t.filter(function(t){return!i.contains(s,t.el)});this.triggerMethod("before:reorder"),this._appendReorderedChildren(s),i.each(o,this.removeChildView,this),this.checkEmpty(),this.triggerMethod("reorder")}},resortView:function(){o.getOption(this,"reorderOnSort")?this.reorder():this.render()},_sortViews:function(){var t=this._filteredSortedModels(),e=i.find(t,function(t,e){var i=this.children.findByModel(t);return!i||i._index!==e},this);e&&this.resortView()},_emptyViewIndex:-1,_appendReorderedChildren:function(t){this.$el.append(t)},_renderChildren:function(){this.destroyEmptyView(),this.destroyChildren({checkEmpty:!1}),this.isEmpty(this.collection)?this.showEmptyView():(this.triggerMethod("before:render:collection",this),this.startBuffering(),this.showCollection(),this.endBuffering(),this.triggerMethod("render:collection",this),this.children.isEmpty()&&this.getOption("filter")&&this.showEmptyView())},showCollection:function(){var t,e=this._filteredSortedModels();i.each(e,function(e,i){t=this.getChildView(e),this.addChild(e,t,i)},this)},_filteredSortedModels:function(t){var e=this.getViewComparator(),n=this.collection.models;if(t=Math.min(Math.max(t,0),n.length-1),e){var s;t&&(s=n[t],n=n.slice(0,t).concat(n.slice(t+1))),n=this._sortModelsBy(n,e),s&&n.splice(t,0,s)}return this.getOption("filter")&&(n=i.filter(n,function(t,e){return this._shouldAddChild(t,e)},this)),n},_sortModelsBy:function(t,e){return"string"==typeof e?i.sortBy(t,function(t){return t.get(e)},this):1===e.length?i.sortBy(t,e,this):t.sort(i.bind(e,this))},showEmptyView:function(){var t=this.getEmptyView();if(t&&!this._showingEmptyView){this.triggerMethod("before:render:empty"),this._showingEmptyView=!0;var i=new e.Model;this.addEmptyView(i,t),this.triggerMethod("render:empty")}},destroyEmptyView:function(){this._showingEmptyView&&(this.triggerMethod("before:remove:empty"),this.destroyChildren(),delete this._showingEmptyView,this.triggerMethod("remove:empty"))},getEmptyView:function(){return this.getOption("emptyView")},addEmptyView:function(t,e){var n,s=this._isShown&&!this.isBuffering&&o.isNodeAttached(this.el),r=this.getOption("emptyViewOptions")||this.getOption("childViewOptions");
i.isFunction(r)&&(r=r.call(this,t,this._emptyViewIndex));var a=this.buildChildView(t,e,r);a._parent=this,this.proxyChildEvents(a),a.once("render",function(){this._isShown&&o.triggerMethodOn(a,"before:show",a),s&&this._triggerBeforeAttach&&(n=this._getViewAndNested(a),this._triggerMethodMany(n,this,"before:attach"))},this),this.children.add(a),this.renderChildView(a,this._emptyViewIndex),s&&this._triggerAttach&&(n=this._getViewAndNested(a),this._triggerMethodMany(n,this,"attach")),this._isShown&&o.triggerMethodOn(a,"show",a)},getChildView:function(t){var e=this.getOption("childView");if(!e)throw new o.Error({name:"NoChildViewError",message:'A "childView" must be specified'});return e},addChild:function(t,e,i){var n=this.getOption("childViewOptions");n=o._getValue(n,this,[t,i]);var s=this.buildChildView(t,e,n);return this._updateIndices(s,!0,i),this.triggerMethod("before:add:child",s),this._addChildView(s,i),this.triggerMethod("add:child",s),s._parent=this,s},_updateIndices:function(t,e,i){this.getOption("sort")&&(e&&(t._index=i),this.children.each(function(i){i._index>=t._index&&(i._index+=e?1:-1)}))},_addChildView:function(t,e){var i,n=this._isShown&&!this.isBuffering&&o.isNodeAttached(this.el);this.proxyChildEvents(t),t.once("render",function(){this._isShown&&!this.isBuffering&&o.triggerMethodOn(t,"before:show",t),n&&this._triggerBeforeAttach&&(i=this._getViewAndNested(t),this._triggerMethodMany(i,this,"before:attach"))},this),this.children.add(t),this.renderChildView(t,e),n&&this._triggerAttach&&(i=this._getViewAndNested(t),this._triggerMethodMany(i,this,"attach")),this._isShown&&!this.isBuffering&&o.triggerMethodOn(t,"show",t)},renderChildView:function(t,e){return t.supportsRenderLifecycle||o.triggerMethodOn(t,"before:render",t),t.render(),t.supportsRenderLifecycle||o.triggerMethodOn(t,"render",t),this.attachHtml(this,t,e),t},buildChildView:function(t,e,n){var s=i.extend({model:t},n),r=new e(s);return o.MonitorDOMRefresh(r),r},removeChildView:function(t){return t?(this.triggerMethod("before:remove:child",t),t.supportsDestroyLifecycle||o.triggerMethodOn(t,"before:destroy",t),t.destroy?t.destroy():t.remove(),t.supportsDestroyLifecycle||o.triggerMethodOn(t,"destroy",t),delete t._parent,this.stopListening(t),this.children.remove(t),this.triggerMethod("remove:child",t),this._updateIndices(t,!1),t):t},isEmpty:function(){return!this.collection||0===this.collection.length},checkEmpty:function(){this.isEmpty(this.collection)&&this.showEmptyView()},attachBuffer:function(t,e){t.$el.append(e)},_createBuffer:function(){var t=document.createDocumentFragment();return i.each(this._bufferedChildren,function(e){t.appendChild(e.el)}),t},attachHtml:function(t,e,i){t.isBuffering?t._bufferedChildren.splice(i,0,e):t._insertBefore(e,i)||t._insertAfter(e)},_insertBefore:function(t,e){var i,n=this.getOption("sort")&&e<this.children.length-1;return n&&(i=this.children.find(function(t){return t._index===e+1})),!!i&&(i.$el.before(t.el),!0)},_insertAfter:function(t){this.$el.append(t.el)},_initChildViewStorage:function(){this.children=new e.ChildViewContainer},destroy:function(){return this.isDestroyed?this:(this.triggerMethod("before:destroy:collection"),this.destroyChildren({checkEmpty:!1}),this.triggerMethod("destroy:collection"),o.View.prototype.destroy.apply(this,arguments))},destroyChildren:function(t){var e=t||{},n=!0,s=this.children.map(i.identity);return i.isUndefined(e.checkEmpty)||(n=e.checkEmpty),this.children.each(this.removeChildView,this),n&&this.checkEmpty(),s},_shouldAddChild:function(t,e){var n=this.getOption("filter");return!i.isFunction(n)||n.call(this,t,e,this.collection)},proxyChildEvents:function(t){var e=this.getOption("childViewEventPrefix");this.listenTo(t,"all",function(){var n=i.toArray(arguments),s=n[0],o=this.normalizeMethods(i.result(this,"childEvents"));n[0]=e+":"+s,n.splice(1,0,t),"undefined"!=typeof o&&i.isFunction(o[s])&&o[s].apply(this,n.slice(1)),this.triggerMethod.apply(this,n)})},_getImmediateChildren:function(){return i.values(this.children._views)},_getViewAndNested:function(t){return[t].concat(i.result(t,"_getNestedViews")||[])},getViewComparator:function(){return this.getOption("viewComparator")}}),o.CompositeView=o.CollectionView.extend({constructor:function(){o.CollectionView.apply(this,arguments)},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"remove",this._onCollectionRemove),this.listenTo(this.collection,"reset",this._renderChildren),this.getOption("sort")&&this.listenTo(this.collection,"sort",this._sortViews))},getChildView:function(t){var e=this.getOption("childView")||this.constructor;return e},serializeData:function(){var t={};return this.model&&(t=i.partial(this.serializeModel,this.model).apply(this,arguments)),t},render:function(){return this._ensureViewIsIntact(),this._isRendering=!0,this.resetChildViewContainer(),this.triggerMethod("before:render",this),this._renderTemplate(),this._renderChildren(),this._isRendering=!1,this.isRendered=!0,this.triggerMethod("render",this),this},_renderChildren:function(){(this.isRendered||this._isRendering)&&o.CollectionView.prototype._renderChildren.call(this)},_renderTemplate:function(){var t={};t=this.serializeData(),t=this.mixinTemplateHelpers(t),this.triggerMethod("before:render:template");var e=this.getTemplate(),i=o.Renderer.render(e,t,this);this.attachElContent(i),this.bindUIElements(),this.triggerMethod("render:template")},attachElContent:function(t){return this.$el.html(t),this},attachBuffer:function(t,e){var i=this.getChildViewContainer(t);i.append(e)},_insertAfter:function(t){var e=this.getChildViewContainer(this,t);e.append(t.el)},_appendReorderedChildren:function(t){var e=this.getChildViewContainer(this);e.append(t)},getChildViewContainer:function(t,e){if(t.$childViewContainer)return t.$childViewContainer;var i,n=o.getOption(t,"childViewContainer");if(n){var s=o._getValue(n,t);if(i="@"===s.charAt(0)&&t.ui?t.ui[s.substr(4)]:t.$(s),i.length<=0)throw new o.Error({name:"ChildViewContainerMissingError",message:'The specified "childViewContainer" was not found: '+t.childViewContainer})}else i=t.$el;return t.$childViewContainer=i,i},resetChildViewContainer:function(){this.$childViewContainer&&(this.$childViewContainer=void 0)}}),o.LayoutView=o.ItemView.extend({regionClass:o.Region,options:{destroyImmediate:!1},childViewEventPrefix:"childview",constructor:function(t){t=t||{},this._firstRender=!0,this._initializeRegions(t),o.ItemView.call(this,t)},render:function(){return this._ensureViewIsIntact(),this._firstRender?this._firstRender=!1:this._reInitializeRegions(),o.ItemView.prototype.render.apply(this,arguments)},destroy:function(){return this.isDestroyed?this:(this.getOption("destroyImmediate")===!0&&this.$el.remove(),this.regionManager.destroy(),o.ItemView.prototype.destroy.apply(this,arguments))},showChildView:function(t,e,n){var s=this.getRegion(t);return s.show.apply(s,i.rest(arguments))},getChildView:function(t){return this.getRegion(t).currentView},addRegion:function(t,e){var i={};return i[t]=e,this._buildRegions(i)[t]},addRegions:function(t){return this.regions=i.extend({},this.regions,t),this._buildRegions(t)},removeRegion:function(t){return delete this.regions[t],this.regionManager.removeRegion(t)},getRegion:function(t){return this.regionManager.get(t)},getRegions:function(){return this.regionManager.getRegions()},_buildRegions:function(t){var e={regionClass:this.getOption("regionClass"),parentEl:i.partial(i.result,this,"el")};return this.regionManager.addRegions(t,e)},_initializeRegions:function(t){var e;this._initRegionManager(),e=o._getValue(this.regions,this,[t])||{};var n=this.getOption.call(t,"regions");n=o._getValue(n,this,[t]),i.extend(e,n),e=this.normalizeUIValues(e,["selector","el"]),this.addRegions(e)},_reInitializeRegions:function(){this.regionManager.invoke("reset")},getRegionManager:function(){return new o.RegionManager},_initRegionManager:function(){this.regionManager=this.getRegionManager(),this.regionManager._parent=this,this.listenTo(this.regionManager,"before:add:region",function(t){this.triggerMethod("before:add:region",t)}),this.listenTo(this.regionManager,"add:region",function(t,e){this[t]=e,this.triggerMethod("add:region",t,e)}),this.listenTo(this.regionManager,"before:remove:region",function(t){this.triggerMethod("before:remove:region",t)}),this.listenTo(this.regionManager,"remove:region",function(t,e){delete this[t],this.triggerMethod("remove:region",t,e)})},_getImmediateChildren:function(){return i.chain(this.regionManager.getRegions()).pluck("currentView").compact().value()}}),o.Behavior=o.Object.extend({constructor:function(t,e){this.view=e,this.defaults=i.result(this,"defaults")||{},this.options=i.extend({},this.defaults,t),this.ui=i.extend({},i.result(e,"ui"),i.result(this,"ui")),o.Object.apply(this,arguments)},$:function(){return this.view.$.apply(this.view,arguments)},destroy:function(){return this.stopListening(),this},proxyViewProperties:function(t){this.$el=t.$el,this.el=t.el}}),o.Behaviors=function(t,e){function i(t,n){return e.isObject(t.behaviors)?(n=i.parseBehaviors(t,n||e.result(t,"behaviors")),i.wrap(t,n,e.keys(r)),n):{}}function n(t,e){this._view=t,this._behaviors=e,this._triggers={}}function s(t){return t._uiBindings||t.ui}var o=/^(\S+)\s*(.*)$/,r={behaviorTriggers:function(t,e){var i=new n(this,e);return i.buildBehaviorTriggers()},behaviorEvents:function(i,n){var r={};return e.each(n,function(i,n){var a={},l=e.clone(e.result(i,"events"))||{};l=t.normalizeUIKeys(l,s(i));var d=0;e.each(l,function(t,s){var r=s.match(o),l=r[1]+"."+[this.cid,n,d++," "].join(""),c=r[2],u=l+c,h=e.isFunction(t)?t:i[t];h&&(a[u]=e.bind(h,i))},this),r=e.extend(r,a)},this),r}};return e.extend(i,{behaviorsLookup:function(){throw new t.Error({message:"You must define where your behaviors are stored.",url:"marionette.behaviors.html#behaviorslookup"})},getBehaviorClass:function(e,n){return e.behaviorClass?e.behaviorClass:t._getValue(i.behaviorsLookup,this,[e,n])[n]},parseBehaviors:function(t,n){return e.chain(n).map(function(n,s){var o=i.getBehaviorClass(n,s),r=new o(n,t),a=i.parseBehaviors(t,e.result(r,"behaviors"));return[r].concat(a)}).flatten().value()},wrap:function(t,i,n){e.each(n,function(n){t[n]=e.partial(r[n],t[n],i)})}}),e.extend(n.prototype,{buildBehaviorTriggers:function(){return e.each(this._behaviors,this._buildTriggerHandlersForBehavior,this),this._triggers},_buildTriggerHandlersForBehavior:function(i,n){var o=e.clone(e.result(i,"triggers"))||{};o=t.normalizeUIKeys(o,s(i)),e.each(o,e.bind(this._setHandlerForBehavior,this,i,n))},_setHandlerForBehavior:function(t,e,i,n){var s=n.replace(/^\S+/,function(t){return t+".behaviortriggers"+e});this._triggers[s]=this._view._buildViewTrigger(i)}}),i}(o,i),o.AppRouter=e.Router.extend({constructor:function(t){this.options=t||{},e.Router.apply(this,arguments);var i=this.getOption("appRoutes"),n=this._getController();this.processAppRoutes(n,i),this.on("route",this._processOnRoute,this)},appRoute:function(t,e){var i=this._getController();this._addAppRoute(i,t,e)},_processOnRoute:function(t,e){if(i.isFunction(this.onRoute)){var n=i.invert(this.getOption("appRoutes"))[t];this.onRoute(t,n,e)}},processAppRoutes:function(t,e){if(e){var n=i.keys(e).reverse();i.each(n,function(i){this._addAppRoute(t,i,e[i])},this)}},_getController:function(){return this.getOption("controller")},_addAppRoute:function(t,e,n){var s=t[n];if(!s)throw new o.Error('Method "'+n+'" was not found on the controller');this.route(e,n,i.bind(s,t))},mergeOptions:o.mergeOptions,getOption:o.proxyGetOption,triggerMethod:o.triggerMethod,bindEntityEvents:o.proxyBindEntityEvents,unbindEntityEvents:o.proxyUnbindEntityEvents}),o.Application=o.Object.extend({constructor:function(t){this._initializeRegions(t),this._initCallbacks=new o.Callbacks,this.submodules={},i.extend(this,t),this._initChannel(),o.Object.apply(this,arguments)},execute:function(){this.commands.execute.apply(this.commands,arguments)},request:function(){return this.reqres.request.apply(this.reqres,arguments)},addInitializer:function(t){this._initCallbacks.add(t)},start:function(t){this.triggerMethod("before:start",t),this._initCallbacks.run(t,this),this.triggerMethod("start",t)},addRegions:function(t){return this._regionManager.addRegions(t)},emptyRegions:function(){return this._regionManager.emptyRegions()},removeRegion:function(t){return this._regionManager.removeRegion(t)},getRegion:function(t){return this._regionManager.get(t)},getRegions:function(){return this._regionManager.getRegions()},module:function(t,e){var n=o.Module.getClass(e),s=i.toArray(arguments);return s.unshift(this),n.create.apply(n,s)},getRegionManager:function(){return new o.RegionManager},_initializeRegions:function(t){var e=i.isFunction(this.regions)?this.regions(t):this.regions||{};this._initRegionManager();var n=o.getOption(t,"regions");return i.isFunction(n)&&(n=n.call(this,t)),i.extend(e,n),this.addRegions(e),this},_initRegionManager:function(){this._regionManager=this.getRegionManager(),this._regionManager._parent=this,this.listenTo(this._regionManager,"before:add:region",function(){o._triggerMethod(this,"before:add:region",arguments)}),this.listenTo(this._regionManager,"add:region",function(t,e){this[t]=e,o._triggerMethod(this,"add:region",arguments)}),this.listenTo(this._regionManager,"before:remove:region",function(){o._triggerMethod(this,"before:remove:region",arguments)}),this.listenTo(this._regionManager,"remove:region",function(t){delete this[t],o._triggerMethod(this,"remove:region",arguments)})},_initChannel:function(){this.channelName=i.result(this,"channelName")||"global",this.channel=i.result(this,"channel")||e.Wreqr.radio.channel(this.channelName),this.vent=i.result(this,"vent")||this.channel.vent,this.commands=i.result(this,"commands")||this.channel.commands,this.reqres=i.result(this,"reqres")||this.channel.reqres}}),o.Module=function(t,e,n){this.moduleName=t,this.options=i.extend({},this.options,n),this.initialize=n.initialize||this.initialize,this.submodules={},this._setupInitializersAndFinalizers(),this.app=e,i.isFunction(this.initialize)&&this.initialize(t,e,this.options)},o.Module.extend=o.extend,i.extend(o.Module.prototype,e.Events,{startWithParent:!0,initialize:function(){},addInitializer:function(t){this._initializerCallbacks.add(t)},addFinalizer:function(t){this._finalizerCallbacks.add(t)},start:function(t){this._isInitialized||(i.each(this.submodules,function(e){e.startWithParent&&e.start(t)}),this.triggerMethod("before:start",t),this._initializerCallbacks.run(t,this),this._isInitialized=!0,this.triggerMethod("start",t))},stop:function(){this._isInitialized&&(this._isInitialized=!1,this.triggerMethod("before:stop"),i.invoke(this.submodules,"stop"),this._finalizerCallbacks.run(void 0,this),this._initializerCallbacks.reset(),this._finalizerCallbacks.reset(),this.triggerMethod("stop"))},addDefinition:function(t,e){this._runModuleDefinition(t,e)},_runModuleDefinition:function(t,n){if(t){var s=i.flatten([this,this.app,e,o,e.$,i,n]);t.apply(this,s)}},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new o.Callbacks,this._finalizerCallbacks=new o.Callbacks},triggerMethod:o.triggerMethod}),i.extend(o.Module,{create:function(t,e,n){var s=t,o=i.drop(arguments,3);e=e.split(".");var r=e.length,a=[];return a[r-1]=n,i.each(e,function(e,i){var r=s;s=this._getModule(r,e,t,n),this._addModuleDefinition(r,s,a[i],o)},this),s},_getModule:function(t,e,n,s,o){var r=i.extend({},s),a=this.getClass(s),l=t[e];return l||(l=new a(e,n,r),t[e]=l,t.submodules[e]=l),l},getClass:function(t){var e=o.Module;return t?t.prototype instanceof e?t:t.moduleClass||e:e},_addModuleDefinition:function(t,e,i,n){var s=this._getDefine(i),o=this._getStartWithParent(i,e);s&&e.addDefinition(s,n),this._addStartWithParent(t,e,o)},_getStartWithParent:function(t,e){var n;return i.isFunction(t)&&t.prototype instanceof o.Module?(n=e.constructor.prototype.startWithParent,!!i.isUndefined(n)||n):!i.isObject(t)||(n=t.startWithParent,!!i.isUndefined(n)||n)},_getDefine:function(t){return!i.isFunction(t)||t.prototype instanceof o.Module?i.isObject(t)?t.define:null:t},_addStartWithParent:function(t,e,i){e.startWithParent=e.startWithParent&&i,e.startWithParent&&!e.startWithParentIsConfigured&&(e.startWithParentIsConfigured=!0,t.addInitializer(function(t){e.startWithParent&&e.start(t)}))}}),o})},function(t,e){function i(){}t.exports=i},function(t,e,i){var n,s;!function(o,r){n=[i(3),i(5)],s=function(t,e){return r(t,e)}.apply(e,n),!(void 0!==s&&(t.exports=s))}(this,function(t,e){"use strict";var i=t.ChildViewContainer;return t.ChildViewContainer=function(t,e){var i=function(t){this._views={},this._indexByModel={},this._indexByCustom={},this._updateLength(),e.each(t,this.add,this)};e.extend(i.prototype,{add:function(t,e){var i=t.cid;return this._views[i]=t,t.model&&(this._indexByModel[t.model.cid]=i),e&&(this._indexByCustom[e]=i),this._updateLength(),this},findByModel:function(t){return this.findByModelCid(t.cid)},findByModelCid:function(t){var e=this._indexByModel[t];return this.findByCid(e)},findByCustom:function(t){var e=this._indexByCustom[t];return this.findByCid(e)},findByIndex:function(t){return e.values(this._views)[t]},findByCid:function(t){return this._views[t]},remove:function(t){var i=t.cid;return t.model&&delete this._indexByModel[t.model.cid],e.any(this._indexByCustom,function(t,e){if(t===i)return delete this._indexByCustom[e],!0},this),delete this._views[i],this._updateLength(),this},call:function(t){this.apply(t,e.tail(arguments))},apply:function(t,i){e.each(this._views,function(n){e.isFunction(n[t])&&n[t].apply(n,i||[])})},_updateLength:function(){this.length=e.size(this._views)}});var n=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck","reduce"];return e.each(n,function(t){i.prototype[t]=function(){var i=e.values(this._views),n=[i].concat(e.toArray(arguments));return e[t].apply(e,n)}}),i}(t,e),t.ChildViewContainer.VERSION="0.1.10",t.ChildViewContainer.noConflict=function(){return t.ChildViewContainer=i,this},t.ChildViewContainer})},function(t,e,i){!function(e,n){t.exports=n(i(5),i(3))}(this,function(t,e){function i(t,e,i,n){var s=t[e];if(!(i&&i!==s.callback&&i!==s.callback._callback||n&&n!==s.context))return delete t[e],!0}function n(e,n,s,o){e||(e={});for(var r=n?[n]:t.keys(e),a=!1,l=0,d=r.length;l<d;l++)n=r[l],e[n]&&i(e,n,s,o)&&(a=!0);return a}function s(e){return d[e]||(d[e]=t.partial(a.log,e))}function o(e){return t.isFunction(e)?e:function(){return e}}var r=e.Radio,a=e.Radio={};a.VERSION="1.0.2",a.noConflict=function(){return e.Radio=r,this},a.DEBUG=!1,a._debugText=function(t,e,i){return t+(i?" on the "+i+" channel":"")+': "'+e+'"'},a.debugLog=function(t,e,i){a.DEBUG&&console&&console.warn&&console.warn(a._debugText(t,e,i))};var l=/\s+/;a._eventsApi=function(e,i,n,s){if(!n)return!1;var o={};if("object"==typeof n){for(var r in n){var a=e[i].apply(e,[r,n[r]].concat(s));l.test(r)?t.extend(o,a):o[r]=a}return o}if(l.test(n)){for(var d=n.split(l),c=0,u=d.length;c<u;c++)o[d[c]]=e[i].apply(e,[d[c]].concat(s));return o}return!1},a._callHandler=function(t,e,i){var n=i[0],s=i[1],o=i[2];switch(i.length){case 0:return t.call(e);case 1:return t.call(e,n);case 2:return t.call(e,n,s);case 3:return t.call(e,n,s,o);default:return t.apply(e,i)}};var d={};t.extend(a,{log:function(e,i){var n=t.rest(arguments,2);console.log("["+e+'] "'+i+'"',n)},tuneIn:function(t){var e=a.channel(t);return e._tunedIn=!0,e.on("all",s(t)),this},tuneOut:function(t){var e=a.channel(t);return e._tunedIn=!1,e.off("all",s(t)),delete d[t],this}}),a.Requests={request:function(e){var i=t.rest(arguments),n=a._eventsApi(this,"request",e,i);if(n)return n;var s=this.channelName,o=this._requests;if(s&&this._tunedIn&&a.log.apply(this,[s,e].concat(i)),o&&(o[e]||o.default)){var r=o[e]||o.default;return i=o[e]?i:arguments,a._callHandler(r.callback,r.context,i)}a.debugLog("An unhandled request was fired",e,s)},reply:function(t,e,i){return a._eventsApi(this,"reply",t,[e,i])?this:(this._requests||(this._requests={}),this._requests[t]&&a.debugLog("A request was overwritten",t,this.channelName),this._requests[t]={callback:o(e),context:i||this},this)},replyOnce:function(e,i,n){if(a._eventsApi(this,"replyOnce",e,[i,n]))return this;var s=this,r=t.once(function(){return s.stopReplying(e),o(i).apply(this,arguments)});return this.reply(e,r,n)},stopReplying:function(t,e,i){return a._eventsApi(this,"stopReplying",t)?this:(t||e||i?n(this._requests,t,e,i)||a.debugLog("Attempted to remove the unregistered request",t,this.channelName):delete this._requests,this)}},a._channels={},a.channel=function(t){if(!t)throw new Error("You must provide a name for the channel.");return a._channels[t]?a._channels[t]:a._channels[t]=new a.Channel(t)},a.Channel=function(t){this.channelName=t},t.extend(a.Channel.prototype,e.Events,a.Requests,{reset:function(){return this.off(),this.stopListening(),this.stopReplying(),this}});var c,u,h=[e.Events,a.Commands,a.Requests];t.each(h,function(e){t.each(e,function(e,i){a[i]=function(e){return u=t.rest(arguments),c=this.channel(e),c[i].apply(c,u)}})}),a.reset=function(e){var i=e?[this._channels[e]]:this._channels;t.invoke(i,"reset")};var g=a;return g})},function(t,e,i){var n,s;n=[i(5),i(3)],s=function(t,e){"use strict";return{setup:function(i){var n=e.sync;e.sync=function(s,o,r){r=t.extend(r,{url:i+"?action=vls_gf_api_"+o.url,emulateHTTP:!0,emulateJSON:!0}),r.attrs&&"patch"===s&&(r.attrs.id=o.get("id")),"delete"===s&&(r=t.extend(r,{data:{_method:"DELETE",id:o.get("id")}})),r.mode="sync",n.call(e,s,o,r)};var s=e.ajax;e.ajax=function(t,i){t.data._nonce=window.vlsGFData.nonce,s.call(e,t,i)}}}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){"use strict";var n=i(3),s=(i(7),n.Radio.channel("global"));t.exports=s},function(t,e,i){var n=i(3),s=i(8),o=i(13),r=s.AppRouter.extend({radio:o,initialize:function(t){this.listenTo(this.radio,"global:requestHashChange",this.onRequestHashChange)},start:function(){n.history.start()},appRoutes:{manager:"manager","folder/:id":"folder","album/:id":"album","image/:id":"image",settings:"settings",tools:"tools","*defaults":"default"},onRequestHashChange:function(t){this.navigate(t)}});t.exports=r},function(t,e,i){var n=i(2),s=i(8),o=i(13),r=i(16),a=s.Object.extend({radio:o,initialize:function(t){this.rootModel=t.rootModel,n(window).on("resize.vls-gf",this.onWindowResize.bind(this)),n(window).on("scroll.vls-gf",this.onWindowScroll.bind(this)),this.listenTo(this.radio,"global:requestRoute",this.onRequestRoute),this.listenTo(this.radio,"dialog:newFolder:confirmed",this.onNewFolderDialogConfirmed),this.listenTo(this.radio,"dialog:newAlbum:confirmed",this.onNewAlbumDialogConfirmed),this.listenTo(this.radio,"dialog:deleteFolder:confirmed",this.onDeleteFolderDialogConfirmed),this.listenTo(this.radio,"dialog:deleteAlbum:confirmed",this.onDeleteAlbumDialogConfirmed)},onWindowResize:function(t){t.target===window&&this.radio.trigger("global:windowResize",{})},onWindowScroll:function(t){t.target===window&&this.radio.trigger("global:windowScroll",{})},start:function(){n('#adminmenu a[href="admin.php?page=vls_gallery_factory"]').attr("href","admin.php?page=vls_gallery_factory#manager");var t=this.radio;n("#collapse-button").on("click.vls-gf",function(){t.trigger("global:windowResize",{})}),n("html").css("background-color","#fcfcfc"),n("#wpbody-content").css("padding-bottom","0"),n("#wpfooter").hide(),n("#wpbody .update-nag").remove(),n("#wpbody-content > .notice").remove(),n("#wpbody-content > .error").remove(),n("#wpbody-content > .updated").remove(),n("#adminmenuback").css("z-index",200)},default:function(){this.manager()},manager:function(){this.switchMainView({view:"manager"})},folder:function(t){this.switchMainView({view:"folder",id:t})},album:function(t){this.switchMainView({view:"album",id:t})},image:function(t){this.switchMainView({view:"image",id:t})},settings:function(){this.switchMainView({view:"settings"})},tools:function(){this.switchMainView({view:"tools"})},onRequestRoute:function(t){var e=t.view;t.id&&(e+="/"+t.id),this.switchMainView(t),this.radio.trigger("global:requestHashChange",e)},switchMainView:function(t){var e=t.view,i=t.id||"",s=t.name||"",o=t.nodeId||0,r=n("#toplevel_page_vls_gallery_factory > ul");r.find(">li.current").removeClass("current").find("a").removeClass("current");var a="";a="settings"===e||"tools"===e?"#"+e:"#manager",r.find('>li>a[href="admin.php?page=vls_gallery_factory'+a+'"]').addClass("current").closest("li").addClass("current"),this.rootModel.set({currentView:e,currentModel:{id:i,name:s,node_id:o}})},onNewFolderDialogConfirmed:function(t){var e=this.radio,i=t.parentId,n=new r({type:"folder",parent_id:i,name:t.value});n.url="folder",n.save(null,{success:function(){e.trigger("folder:contentChanged",{id:i})}})},onNewAlbumDialogConfirmed:function(t){var e=this.radio,i=t.parentId,n=new r({type:"album",parent_id:i,name:t.value});n.url="folder",n.save(null,{success:function(){e.trigger("folder:contentChanged",{id:i})}})},onDeleteFolderDialogConfirmed:function(t){var e=this.radio,i=t.parentId,n=new r({id:t.id});n.destroy({success:function(){e.trigger("navigation:requested",{id:i,type:"folder"}),e.trigger("folder:contentChanged",{id:i})}})},onDeleteAlbumDialogConfirmed:function(t){var e=this.radio,i=t.parentId,n=new r({id:t.id});n.destroy({success:function(){e.trigger("navigation:requested",{id:i,type:"folder"}),e.trigger("folder:contentChanged",{id:i})}})}});t.exports=a},function(t,e,i){"use strict";var n=i(17),s=n.extend({url:"node",defaults:{type:"",parent_id:0,name:""}});t.exports=s},function(t,e,i){"use strict";var n=i(5),s=i(3),o=s.Model.extend({fetch:function(t){t=t||{};var e=t.data||{};e.id=this.id,this.api_view&&(e.view=this.api_view),t=n.extend(t,{data:e}),s.Model.prototype.fetch.call(this,t)}});t.exports=o},function(t,e,i){var n,s;n=[i(3)],s=function(t){"use strict";var e=t.Model.extend({defaults:{currentView:"",currentId:0,tutorialActive:!1}});return e}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n=i(2),s=i(8),o=i(13),r=i(20),a=i(65),l=i(68),d=i(90),c=i(91),u=i(99),h=i(100),g=i(104),p=s.LayoutView.extend({el:"#vls-gf-app",template:!1,regions:{primaryLayer:"#vls-gf-layer-primary",secondaryLayer:"#vls-gf-layer-secondary"},ui:{primaryLayer:">section:nth-child(1)",secondaryLayer:">section:nth-child(2)"},events:{},modelEvents:{"change:currentView":"switchCurrentView"},radio:o,initialize:function(t){this.animationTicking=!1,this.listenTo(this.radio,"global:windowResize",this.onWindowResize),this.listenTo(this.radio,"global:needAdjustFixedElement",this._adjustFixedElements),this.render()},switchCurrentView:function(){var t=this.model.get("currentView"),e=this.model.get("currentModel");if("manager"===t)this._hideSecondaryLayer(),this.primaryLayer.currentView||this.primaryLayer.show(new r),this.secondaryLayer.empty();else if("folder"===t){this._showSecondaryLayer();var i=new a({id:e.id,name:e.name});this.secondaryLayer.show(new l({model:i}))}else if("image"===t){this._showSecondaryLayer();var i=new d(e);this.secondaryLayer.show(new c({model:i}))}else if("settings"===t){this._showSecondaryLayer();var i=new u;this.secondaryLayer.show(new h({model:i}))}else"tools"===t&&(this._showSecondaryLayer(),this.secondaryLayer.show(new g));this.radio.trigger("global:needAdjustFixedElement",{})},onWindowResize:function(t){this.animationTicking||(this.animationTicking=!0,vlsGfRequestAnimationFrame(this._adjustFixedElements.bind(this)))},_adjustFixedElements:function(){var t=n(window),e=n("#wpadminbar"),i=n("#adminmenuback"),s=n("#wpbody-content"),o=n("#vls-gf-app .vls-gf-fixed-wrapper"),r=n("#vls-gf-app .vls-gf-main-panel"),a=n("#vls-gf-app .vls-gf-nav-panel"),l=n("#vls-gf-app .vls-gf-side-panel"),d=t.height(),c=i.outerWidth(),u=d-e.outerHeight();if(r.css({"min-height":u+"px"}),0!=a.length||0!=l.length){s.height(),t.scrollTop();a.css({left:c+"px"}),o.css({left:c+"px"})}this.animationTicking=!1},_showSecondaryLayer:function(){this.ui.primaryLayer.css({display:"none"}),this.ui.secondaryLayer.css({display:"block"}),this.primaryLayer.currentView&&this.primaryLayer.currentView.hideMoreMenu()},_hideSecondaryLayer:function(){this.ui.primaryLayer.css({display:"block"}),this.ui.secondaryLayer.css({display:"none"})}});t.exports=p},function(t,e,i){var n=i(2),s=i(5),o=i(21),r=i(24),a=i(25),l=i(32),d=i(43),c=i(56),u=i(57),h=i(59),g=i(60),p=i(62),f=i(63),v=o.extend({className:"vls-gf-view-gallery-manager",template:r,templateHelpers:function(){return{t:{navigation:this.l10n.t("navigation"),view:this.l10n.t("view"),toggleNavigation:this.state.navigationPanelVisible?this.l10n.t("hideNavigation"):this.l10n.t("showNavigation"),toggleSummary:this.state.summaryPanelVisible?this.l10n.t("hideSummary"):this.l10n.t("showSummary"),tools:this.l10n.t("tools"),settings:this.l10n.t("settings"),upgradeToPremium:this.l10n.t("upgradeToPremium"),tt:{addNewFolder:this.l10n.t("tooltips.addNewFolder"),addNewAlbum:this.l10n.t("tooltips.addNewAlbum"),menu:this.l10n.t("tooltips.menu"),editAlbum:this.l10n.t("tooltips.editAlbum"),deleteAlbum:this.l10n.t("tooltips.deleteAlbum"),editFolder:this.l10n.t("tooltips.editFolder"),deleteFolder:this.l10n.t("tooltips.deleteFolder")}}}},regions:{navContent:".vls-gf-nav-panel",mainContent:".vls-gf-main-panel",sideContent:".vls-gf-side-panel"},ui:{mainPanelHeader:".vls-gf-fixed-wrapper .vls-gf-primary-toolbar .vls-gf-main h3",toolbarImages:".vls-gf-fixed-wrapper .vls-gf-primary-toolbar ul.vls-gf-images",toolbarStorage:".vls-gf-fixed-wrapper .vls-gf-primary-toolbar ul.vls-gf-library",toolbarFolder:".vls-gf-fixed-wrapper .vls-gf-primary-toolbar ul.vls-gf-folder",toolbarAlbum:".vls-gf-fixed-wrapper .vls-gf-primary-toolbar ul.vls-gf-album",fabWrapper:".vls-gf-fab-wrapper",btnFAB:".vls-gf-fab-wrapper .vls-gf-fab",btnAddFolder:'.vls-gf-fab-wrapper .vls-gf-fab-option[data-action="add-folder"]',btnAddAlbum:'.vls-gf-fab-wrapper .vls-gf-fab-option[data-action="add-album"]',btnMoreMenu:".vls-gf-fixed-wrapper .vls-gf-primary-toolbar .vls-gf-more-menu button",btnMoreMenuSidebars:'.vls-gf-fixed-wrapper .vls-gf-primary-toolbar .vls-gf-more-menu li[data-action="submenu-sidebars"] > span',actionToggleNavigation:'li[data-action="toggle-navigation"]',actionToggleSummary:'li[data-action="toggle-summary"]',btnFolderEdit:'.vls-gf-fixed-wrapper .vls-gf-primary-toolbar ul.vls-gf-folder button[data-action="edit"]',btnFolderDelete:'.vls-gf-fixed-wrapper .vls-gf-primary-toolbar ul.vls-gf-folder button[data-action="delete"]',btnAlbumEdit:'.vls-gf-fixed-wrapper .vls-gf-primary-toolbar ul.vls-gf-album button[data-action="edit"]',btnAlbumDelete:'.vls-gf-fixed-wrapper .vls-gf-primary-toolbar ul.vls-gf-album button[data-action="delete"]',dropdownMoreMenu:".vls-gf-fixed-wrapper .vls-gf-primary-toolbar .vls-gf-more-menu > ul",dropdownMoreSubMenu:'.vls-gf-fixed-wrapper .vls-gf-primary-toolbar .vls-gf-more-menu li[data-action="submenu-sidebars"] > ul'},events:{"click @ui.btnFAB":"onBtnFAB","click @ui.btnAddFolder":"onBtnAddFolder","click @ui.btnAddAlbum":"onBtnAddAlbum","click @ui.mainPanelHeader":"onMainPanelHeaderClick","click @ui.btnFolderEdit, @ui.btnAlbumEdit":"onEditClick","click @ui.btnFolderDelete":"onBtnFolderDelete","click @ui.btnAlbumDelete":"onBtnAlbumDelete","click @ui.btnMoreMenu":"onBtnMoreMenu","click @ui.btnMoreMenuSidebars":"onBtnMoreMenuSidebars","click @ui.actionToggleNavigation":"toggleNavigation","click @ui.actionToggleSummary":"toggleSummary"},initialize:function(t){this.state={navigationPanelVisible:!0,summaryPanelVisible:!0,moreMenuOpened:!1,commandSet:"",currentItem:{type:"",id:0,name:""}},this.state.navigationPanelVisible&&this.$el.addClass("vls-gf-navigation-visible"),this.state.summaryPanelVisible&&this.$el.addClass("vls-gf-summary-visible"),this.listenTo(this.radio,"navigation:itemActivated",this.onNavigationItemActivated),this.listenTo(this.radio,"manager:content:itemActivated",this.onContentItemActivated);
},onRender:function(){this.navContent.show(new a)},onShow:function(){this.radio.trigger("global:needAdjustFixedElement",{})},onNavigationItemActivated:function(t){this.state.currentItem={type:t.type,id:t.id,name:t.name,parentId:t.parentId};var e='<div class="vls-gf-breadcrumbs">';0!==t.id&&(e+='<span data-id="0">'+this.l10n.t("library")+"</span>&nbsp;&gt;&nbsp;"),s.each(t.breadcrumbs,function(t){e+='<span data-id="'+t.id+'">'+t.name+"</span>&nbsp;&gt;&nbsp;"}),e+='<span class="vls-gf-current">'+t.name+"</span></div>",this.ui.mainPanelHeader.html(e),"all_images"===t.type||"unsorted_images"===t.type?(this._switchCommandSet("images"),this.mainContent.show(new d({type:t.type}))):"album"===t.type?(this._switchCommandSet("album"),this.mainContent.show(new d({type:"album",albumId:t.id}))):"library"===t.type?(this._switchCommandSet("library"),this.mainContent.show(new l({folderId:0}))):"folder"===t.type&&(this._switchCommandSet("folder"),this.mainContent.show(new l({folderId:t.id})))},onContentItemActivated:function(t){var e;"folder"===t.type?(e=new c({id:t.id}),this.sideContent.show(new u({model:e}))):"album"===t.type?(e=new h({id:t.id}),this.sideContent.show(new g({model:e}))):"image"===t.type?(e=new p({id:t.imageId,node_id:t.id}),this.sideContent.show(new f({model:e}))):"image_entity"===t.type&&(e=new p({id:t.id}),this.sideContent.show(new f({model:e})))},onEditClick:function(){var t=this.state.currentItem.id,e=this.state.currentItem.name;return this.radio.trigger("global:requestRoute",{view:"folder",id:t,name:e}),!1},onMainPanelHeaderClick:function(t){var e=n(t.target).data("id");"undefined"!=typeof e&&this.radio.trigger("navigation:requested",{id:e,type:e>0?"folder":"library"})},onBtnFAB:function(){if("images"===this.state.commandSet||"album"===this.state.commandSet){var t=this.ui.btnFAB.data("vlsGfTooltipEl");t&&(t.removeClass("vls-gf-visible"),this.ui.btnFAB.data("vlsGfTooltipEl",null),t.remove()),this.radio.trigger("manager:uploadBrowseRequested")}},onBtnAddFolder:function(){"library"!==this.state.commandSet&&"folder"!==this.state.commandSet||this.radio.trigger("dialog:newFolder:requested",{parentId:this.state.currentItem.id})},onBtnAddAlbum:function(){"library"!==this.state.commandSet&&"folder"!==this.state.commandSet||this.radio.trigger("dialog:newAlbum:requested",{parentId:this.state.currentItem.id})},onBtnFolderDelete:function(){"folder"===this.state.commandSet&&this.radio.trigger("dialog:deleteFolder:requested",{id:this.state.currentItem.id,name:this.state.currentItem.name,parentId:this.state.currentItem.parentId})},onBtnAlbumDelete:function(){"album"===this.state.commandSet&&this.radio.trigger("dialog:deleteAlbum:requested",{id:this.state.currentItem.id,name:this.state.currentItem.name,parentId:this.state.currentItem.parentId})},onBtnMoreMenu:function(){if(!this.state.moreMenuOpened){this.state.moreMenuOpened=!0;var t=this,e=this.ui.dropdownMoreMenu;e.css("display","block"),e.width(),e.addClass("vls-gf-visible"),n(document).on("click.vls-gf.menu",function(e){n(e.target).closest(".vls-gf-more-menu").length||t.hideMoreMenu.call(t)})}},onBtnMoreMenuSidebars:function(){if(this.state.moreSubMenuOpened){var t=this;this.state.moreSubMenuOpened=!1;var e=this.ui.dropdownMoreSubMenu;e.removeClass("vls-gf-visible"),setTimeout(function(){t.state.moreSubMenuOpened||e.css("display","none")},400)}else{this.state.moreSubMenuOpened=!0;var e=this.ui.dropdownMoreSubMenu;e.css("display","block"),e.width(),e.addClass("vls-gf-visible")}},hideMoreMenu:function(){this.state.moreMenuOpened=!1,this.state.moreSubMenuOpened&&this.onBtnMoreMenuSidebars(),n(document).off("click.vls-gf.menu");var t=this,e=this.ui.dropdownMoreMenu;e.removeClass("vls-gf-visible"),e.find("vls-gf-visible").removeClass("vls-gf-visible"),setTimeout(function(){t.state.moreMenuOpened||e.css("display","none")},400)},toggleNavigation:function(){var t=this.ui.actionToggleNavigation.find("span"),e=this.l10n;this.state.navigationPanelVisible?(this.$el.removeClass("vls-gf-navigation-visible"),setTimeout(function(){t.html(e.t("showNavigation"))},300)):(this.$el.addClass("vls-gf-navigation-visible"),setTimeout(function(){t.html(e.t("hideNavigation"))},300)),this.state.navigationPanelVisible=!this.state.navigationPanelVisible,this.hideMoreMenu()},toggleSummary:function(){var t=this.ui.actionToggleSummary.find("span"),e=this.l10n;this.state.summaryPanelVisible?(this.$el.removeClass("vls-gf-summary-visible"),setTimeout(function(){t.html(e.t("showSummary"))},300)):(this.$el.addClass("vls-gf-summary-visible"),setTimeout(function(){t.find("span").html(e.t("hideSummary"))},300)),this.state.summaryPanelVisible=!this.state.summaryPanelVisible,this.hideMoreMenu()},_switchCommandSet:function(t){var e=this.state.commandSet;t!==e&&("images"===t||"album"===t?(this.ui.fabWrapper.removeClass("vls-gf-actions-folder").addClass("vls-gf-actions-album"),this.ui.btnFAB.data("vlsGfTooltip",this.l10n.t("tooltips.uploadImages"))):"library"!==t&&"folder"!==t||(this.ui.fabWrapper.removeClass("vls-gf-actions-album").addClass("vls-gf-actions-folder"),this.ui.btnFAB.data("vlsGfTooltip","")),"images"===e?this._fadeOut(this.ui.toolbarImages):"album"===e?this._fadeOut(this.ui.toolbarAlbum):"library"===e?this._fadeOut(this.ui.toolbarStorage):"folder"===e&&this._fadeOut(this.ui.toolbarFolder),"images"===t?this._fadeIn(this.ui.toolbarImages):"album"===t?this._fadeIn(this.ui.toolbarAlbum):"library"===t?this._fadeIn(this.ui.toolbarStorage):"folder"===t&&this._fadeIn(this.ui.toolbarFolder),this.state.commandSet=t)},_fadeOut:function(t){t.addClass("vls-gf-transitioning").removeClass("vls-gf-visible"),setTimeout(function(){t.removeClass("vls-gf-transitioning")},600)},_fadeIn:function(t){t.addClass("vls-gf-transitioning"),setTimeout(function(){t.addClass("vls-gf-visible")},10),setTimeout(function(){t.removeClass("vls-gf-transitioning")},600)}});t.exports=v},function(t,e,i){"use strict";var n=i(8),s=i(13),o=i(22),r=n.LayoutView.extend({l10n:o,radio:s});t.exports=r},function(t,e,i){"use strict";var n=i(23),s=new n({locale:window.vlsGFData.localization.locale,phrases:window.vlsGFData.localization.phrases});t.exports=s},function(t,e,i){var n,s;!function(i,o){n=[],s=function(){return o(i)}.apply(e,n),!(void 0!==s&&(t.exports=s))}(this,function(t){"use strict";function e(t){t=t||{},this.phrases={},this.extend(t.phrases||{}),this.currentLocale=t.locale||"en",this.allowMissing=!!t.allowMissing,this.warn=t.warn||l}function i(t){var e,i,n,s={};for(e in t)if(t.hasOwnProperty(e)){i=t[e];for(n in i)s[i[n]]=e}return s}function n(t){var e=/^\s+|\s+$/g;return t.replace(e,"")}function s(t,e,i){var s,o,a;return null!=i&&t?(o=t.split(c),a=o[r(e,i)]||o[0],s=n(a)):s=t,s}function o(t){var e=i(h);return e[t]||e.en}function r(t,e){return u[o(t)](e)}function a(t,e){for(var i in e)"_"!==i&&e.hasOwnProperty(i)&&(t=t.replace(new RegExp("%\\{"+i+"\\}","g"),e[i]));return t}function l(e){t.console&&t.console.warn&&t.console.warn("WARNING: "+e)}function d(t){var e={};for(var i in t)e[i]=t[i];return e}e.VERSION="0.4.3",e.prototype.locale=function(t){return t&&(this.currentLocale=t),this.currentLocale},e.prototype.extend=function(t,e){var i;for(var n in t)t.hasOwnProperty(n)&&(i=t[n],e&&(n=e+"."+n),"object"==typeof i?this.extend(i,n):this.phrases[n]=i)},e.prototype.clear=function(){this.phrases={}},e.prototype.replace=function(t){this.clear(),this.extend(t)},e.prototype.t=function(t,e){var i,n;return e=null==e?{}:e,"number"==typeof e&&(e={smart_count:e}),"string"==typeof this.phrases[t]?i=this.phrases[t]:"string"==typeof e._?i=e._:this.allowMissing?i=t:(this.warn('Missing translation for key: "'+t+'"'),n=t),"string"==typeof i&&(e=d(e),n=s(i,this.currentLocale,e.smart_count),n=a(n,e)),n},e.prototype.has=function(t){return t in this.phrases};var c="||||",u={chinese:function(t){return 0},german:function(t){return 1!==t?1:0},french:function(t){return t>1?1:0},russian:function(t){return t%10===1&&t%100!==11?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2},czech:function(t){return 1===t?0:t>=2&&t<=4?1:2},polish:function(t){return 1===t?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2},icelandic:function(t){return t%10!==1||t%100===11?1:0}},h={chinese:["fa","id","ja","ko","lo","ms","th","tr","zh"],german:["da","de","en","es","fi","el","he","hu","it","nl","no","pt","sv"],french:["fr","tl","pt-br"],russian:["hr","ru"],czech:["cs"],polish:["pl"],icelandic:["is"]};return e})},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="vls-gf-fixed-wrapper">\r\n\t<div class="vls-gf-primary-toolbar">\r\n\t\t<div class="vls-gf-nav">\r\n\t\t\t<h3>'+(null==(__t=t.navigation)?"":__t)+'</h3>\r\n\t\t</div>\r\n\t\t<div class="vls-gf-main">\r\n\t\t\t<h3></h3>\r\n\t\t\t<ul class="vls-gf-actions vls-gf-images">\r\n\t\t\t</ul>\r\n\t\t\t<ul class="vls-gf-actions vls-gf-library">\r\n\t\t\t</ul>\r\n\t\t\t<ul class="vls-gf-actions vls-gf-album">\r\n\t\t\t\t<li>\r\n\t\t\t\t\t<button data-action="edit" class="vls-gf-icon vls-gf-icon-edit-w"\r\n\t\t\t\t\t\t\tdata-vls-gf-tooltip="'+(null==(__t=t.tt.editAlbum)?"":__t)+'" data-vls-gf-position="below"\r\n\t\t\t\t\t\t\tdata-vls-gf-offset="0"></button>\r\n\t\t\t\t</li>\r\n\t\t\t\t<li>\r\n\t\t\t\t\t<button data-action="delete" class="vls-gf-icon vls-gf-icon-delete-w"\r\n\t\t\t\t\t\t\tdata-vls-gf-tooltip="'+(null==(__t=t.tt.deleteAlbum)?"":__t)+'" data-vls-gf-position="below"\r\n\t\t\t\t\t\t\tdata-vls-gf-offset="0"></button>\r\n\t\t\t\t</li>\r\n\t\t\t</ul>\r\n\t\t\t<ul class="vls-gf-actions vls-gf-folder">\r\n\t\t\t\t<li>\r\n\t\t\t\t\t<button data-action="edit" class="vls-gf-icon vls-gf-icon-edit-w"\r\n\t\t\t\t\t\t\tdata-vls-gf-tooltip="'+(null==(__t=t.tt.editFolder)?"":__t)+'" data-vls-gf-position="below"\r\n\t\t\t\t\t\t\tdata-vls-gf-offset="0"></button>\r\n\t\t\t\t</li>\r\n\t\t\t\t<li>\r\n\t\t\t\t\t<button data-action="delete" class="vls-gf-icon vls-gf-icon-delete-w"\r\n\t\t\t\t\t\t\tdata-vls-gf-tooltip="'+(null==(__t=t.tt.deleteFolder)?"":__t)+'" data-vls-gf-position="below"\r\n\t\t\t\t\t\t\tdata-vls-gf-offset="0"></button>\r\n\t\t\t\t</li>\r\n\t\t\t</ul>\r\n\t\t\t<span class="vls-gf-more-menu">\r\n            <button class="vls-gf-icon vls-gf-icon-more-vert-w" data-vls-gf-tooltip="'+(null==(__t=t.tt.menu)?"":__t)+'"\r\n\t\t\t\t\tdata-vls-gf-position="below" data-vls-gf-offset="0"></button>\r\n            <ul>\r\n                <li data-action="submenu-sidebars"><span>'+(null==(__t=t.view)?"":__t)+'</span>\r\n                    <ul>\r\n                        <li data-action="toggle-navigation"><i class="vls-gf-check vls-gf-checked"></i><span>'+(null==(__t=t.toggleNavigation)?"":__t)+'</span></li>\r\n                        <li data-action="toggle-summary"><i class="vls-gf-check vls-gf-checked"></i><span>'+(null==(__t=t.toggleSummary)?"":__t)+'</span></li>\r\n                    </ul>\r\n                </li>\r\n                <li class="vls-gf-divider"></li>\r\n                <li><a href="#tools">'+(null==(__t=t.tools)?"":__t)+'</a></li>\r\n                <li><a href="#settings">'+(null==(__t=t.settings)?"":__t)+'</a></li>\r\n                <li><a href="http://codecanyon.net/item/gallery-factory/11219294/"\r\n                       target="_blank">'+(null==(__t=t.upgradeToPremium)?"":__t)+'</a></li>\r\n            </ul>\r\n        </span>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n\r\n<div class="vls-gf-content-wrapper">\r\n\t<div class="vls-gf-nav-panel"></div>\r\n\t<div class="vls-gf-main-panel"></div>\r\n\t<div class="vls-gf-side-panel"></div>\r\n</div>\r\n\r\n<div class="vls-gf-fab-wrapper">\r\n\t<button data-action="add-folder" class="vls-gf-fab-option" data-vls-gf-tooltip="'+(null==(__t=t.tt.addNewFolder)?"":__t)+'"\r\n\t\t\tdata-vls-gf-position="left" data-vls-gf-offset="14">\r\n\t\t<i class="vls-gf-icon vls-gf-icon-folder-w"></i></button>\r\n\t<button data-action="add-album" class="vls-gf-fab-option" data-vls-gf-tooltip="'+(null==(__t=t.tt.addNewAlbum)?"":__t)+'"\r\n\t\t\tdata-vls-gf-position="left" data-vls-gf-offset="14">\r\n\t\t<i class="vls-gf-icon vls-gf-icon-album-w"></i></button>\r\n\t<button class="vls-gf-fab" data-vls-gf-tooltip="" data-vls-gf-position="left" data-vls-gf-offset="14">\r\n\t\t<i class="vls-gf-icon vls-gf-icon-add-w"></i>\r\n\t\t<i class="vls-gf-icon vls-gf-icon-file-upload-w"></i>\r\n\t</button>\r\n</div>';return __p}},function(t,e,i){var n=i(2),s=i(26),o=i(27),r=i(28),a=i(29),l=i(31),d=s.extend({className:"vls-gf-navigation-view-wrapper",viewName:"tree",template:o,templateHelpers:function(){return{t:{allImages:this.l10n.t("allImages"),unsortedImages:this.l10n.t("unsortedImages"),library:this.l10n.t("library")}}},childView:a,childViewContainer:".vls-gf-navigation-tree",ui:{navigationTree:".vls-gf-navigation-tree",treeScrollWrapper:".vls-gf-scroll-wrapper",allImages:"div.vls-gf-navigation-fixed div.vls-gf-all",unsortedImages:"div.vls-gf-navigation-fixed div.vls-gf-unsorted",library:"div.vls-gf-navigation-fixed div.vls-gf-library"},events:{"click @ui.allImages":"onAllImagesClick","click @ui.unsortedImages":"onUnsortedImagesClick","click @ui.library":"onLibraryClick"},tutorialMode:vlsGFData.tutorialMode,initialize:function(t){this.state={initialLoad:!0},this.draggingState={isItemDragging:!1,currentOrderNo:0},this.listenTo(this.radio,"navigationPanel:requestRedrawTree",this.onRequestRedrawTree),this.listenTo(this.radio,"navigationPanel:itemDragStart",this.onItemDragStart),this.listenTo(this.radio,"navigationPanel:itemDrag",this.onItemDrag),this.listenTo(this.radio,"navigationPanel:itemDragStop",this.onItemDragStop),this.listenTo(this.radio,"folder:contentChanged",this.onFolderContentChanged),this.listenTo(this.radio,"navigation:itemActivated",this.onItemActivated),this.listenTo(this.radio,"navigation:requested",this.onNavigationRequested),this.childViewOptions={parentId:0,level:1,visibilityState:"visible"},this.collection=new r([],{parentId:0}),this.listenTo(this.collection,"sync",this.onCollectionSync)},onRender:function(){this.collection.fetch(),this.ui.allImages.droppable({accept:".vls-gf-dragged-image",hoverClass:"vls-gf-drop-ready",drop:this._onImageDrop.bind(this)}),this.ui.unsortedImages.droppable({accept:".vls-gf-dragged-image",hoverClass:"vls-gf-drop-ready",drop:this._onImageDrop.bind(this)})},onShow:function(){var t={$:n,scroller:".vls-gf-scroll-scroller",container:".vls-gf-navigation-tree",bar:".vls-gf-scroll-bar",barOnCls:"vls-gf-bar-on",scrollingCls:"vls-gf-scrolling",cssGuru:!0};l.call(this.ui.treeScrollWrapper,t),this.radio.trigger("global:needAdjustFixedElement",{}),this.onLibraryClick()},onCollectionSync:function(){if(this._updateTreePositions(),this.state.initialLoad){this.$el.find(".vls-gf-navigation-tree>div").addClass("vls-gf-init");var t=0;this.children.each(function(e){var i=e.$el,n=10*t;setTimeout(function(){i.removeClass("vls-gf-init")},n),t++}),this.state.initialLoad=!1}},onRequestRedrawTree:function(t){this._updateTreePositions()},onItemDragStart:function(t){this.draggingState.isItemDragging=!0,this.draggingState.indentHelper=n('<div id="vls-gf-drag-indent-helper"></div>'),this.ui.navigationTree.append(this.draggingState.indentHelper),this.ui.navigationTree.addClass("vls-gf-dragging")},onItemDrag:function(t){var e=this;e.draggingState.currentOrderNo=t.currentOrderNo,e.draggingState.currentIndent=t.currentIndent,e.draggingState.maybeFolderOpenIntent=t.maybeFolderOpenIntent,e.draggingState.isFirstDragMove=t.isFirstDragMove,e.draggingState.directionY=t.directionY,e.draggingState.maybeFolderOpenIntent&&"up"==e.draggingState.directionY&&e.draggingState.upperNeighbour&&"folder"===e.draggingState.upperNeighbour.type&&"collapsed"===e.draggingState.upperNeighbour.collapseState?(e.draggingState.currentOrderNo++,e.draggingState.upperNeighbour.setOpenTimeout("prev")):e.draggingState.maybeFolderOpenIntent&&"down"==e.draggingState.directionY&&e.draggingState.lowerNeighbour&&"folder"===e.draggingState.lowerNeighbour.type&&"collapsed"===e.draggingState.lowerNeighbour.collapseState?e.draggingState.lowerNeighbour.setOpenTimeout("next"):e._updateTreePositions()},onItemDragStop:function(t){this.draggingState.isItemDragging=!1,this.draggingState.indentHelper.remove(),this.draggingState.indentHelper=null;var e=t.draggedItem,i=t.oldParent,n=this.draggingState.currentParent,s=(this.draggingState.oldUpperSibling,this.draggingState.upperSibling),o=(this.draggingState.dropLevel,!1),r=0;if(i.cid!==n.cid)i.collection.remove(e.model),s&&(r=n.collection.indexOf(s.model)+1),n.collection.add(e.model,{at:r}),o=!0;else{r=0,s&&(r=i.collection.indexOf(s.model)+1);var a=i.collection.indexOf(e.model);r!==a&&(r>a&&r--,i.collection.remove(e.model),i.collection.add(e.model,{at:r}),o=!0)}var l=0;"item"===n.viewName&&(l=n.model.get("id")),o&&e.model.save({parent_id:l,order_no:r},{parse:!1,patch:!0}),this._updateTreePositions(),this.ui.navigationTree.removeClass("vls-gf-dragging")},onAllImagesClick:function(){return this.ui.allImages.addClass("vls-gf-active"),this.radio.trigger("navigation:itemActivated",{type:"all_images",id:0,name:this.l10n.t("allImages")}),!1},onUnsortedImagesClick:function(){return this.ui.unsortedImages.addClass("vls-gf-active"),this.radio.trigger("navigation:itemActivated",{type:"unsorted_images",id:0,name:this.l10n.t("unsortedImages")}),!1},onLibraryClick:function(){return this.ui.library.addClass("vls-gf-active"),this.radio.trigger("navigation:itemActivated",{type:"library",id:0,name:this.l10n.t("library")}),!1},onItemActivated:function(t){"all_images"!==t.type&&this.ui.allImages.removeClass("vls-gf-active"),"unsorted_images"!==t.type&&this.ui.unsortedImages.removeClass("vls-gf-active"),"library"!==t.type&&this.ui.library.removeClass("vls-gf-active")},onFolderContentChanged:function(t){0===t.id&&this.collection.fetch()},onNavigationRequested:function(t){"library"!==t.type&&0!==t.id||this.onLibraryClick()},onChildviewActivatedDownstream:function(t,e){this.radio.trigger("navigation:itemActivated",{type:e.type,id:e.id,name:e.name,parentId:e.parentId,breadcrumbs:e.breadcrumbs})},_onImageDrop:function(t,e){var i=this.radio,s=e.helper.data("sourceAlbum"),o=e.helper.data("draggedImages");0!=s&&n.post(ajaxurl,{action:"vls_gf_api_image_collection_move",_nonce:vlsGFData.nonce,collection:JSON.stringify(o),from_folder:s,to_folder:0},function(){i.trigger("manager:content:bulkSelectModeDeactivated",{}),i.trigger("album:contentChanged",{id:s}),i.trigger("album:contentChanged",{id:0})})},_updateTreePositions:function(){var t=this;t._isUpdatingPositions===!0&&(t._needUpdatingPositions=!0),t._isUpdatingPositions=!0;var e={orderNo:-1,isItemDragging:t.draggingState.isItemDragging,draggingOrderNo:t.draggingState.currentOrderNo,maybeFolderOpenIntent:t.draggingState.maybeFolderOpenIntent,upperNeighbour:null,lowerNeighbour:null,parents:[]};t.collection.each(function(i){var n=t.children.findByModel(i);n&&(e=n.updatePositions(e))}),t.draggingState.isItemDragging&&(t.draggingState.currentOrderNo>=e.orderNo+1&&(t.draggingState.currentOrderNo=e.orderNo+1,e.orderNo=e.orderNo+1),t.draggingState.upperNeighbour=e.upperNeighbour,t.draggingState.lowerNeighbour=e.lowerNeighbour,t.draggingState.parents=e.parents,t._updateDraggingHelper(),t.draggingState.upperSibling=t.draggingState.parents[t.draggingState.dropLevel],t.draggingState.isFirstDragMove&&(t.draggingState.oldUpperSibling=t.draggingState.parents[t.draggingState.dropLevel])),t._isUpdatingPositions=!1;var i=32*(e.orderNo+1)+6;t.ui.navigationTree.css({height:i}),t._needUpdatingPositions===!0&&t._updateTreePositions()},_updateDraggingHelper:function(){var t=this,e=t.draggingState.upperNeighbour,i=t.draggingState.lowerNeighbour,n=e?e.type:"",s=e?e.level:1,o=i?i.level:1,r=t.draggingState.currentIndent+1;r<o&&(r=o);var a=s;"folder"===n&&(a=a<7?a+1:7),r>a&&(r=a);var l,d=t.draggingState.currentOrderNo,c=-1;r>1?(l=t.draggingState.parents[r-1],c=l.orderNo):l=t;var u=32*c+32,h=32*d+17,g=16*r+8;t.draggingState.currentParent=l,t.draggingState.dropLevel=r,t.draggingState.indentHelper.css({display:"block",top:u,left:g,height:h-u})}});t.exports=d},function(t,e,i){"use strict";var n=i(8),s=i(13),o=i(22),r=n.CompositeView.extend({l10n:o,radio:s});t.exports=r},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="vls-gf-navigation-fixed">\r\n\t<div class="vls-gf-all">\r\n\t\t<div>\r\n\t\t\t<span class="vls-gf-icon"></span>\r\n\t\t\t<span class="vls-gf-label">'+(null==(__t=t.allImages)?"":__t)+'</span>\r\n\t\t</div>\r\n\t</div>\r\n\t<div class="vls-gf-unsorted">\r\n\t\t<div>\r\n\t\t\t<span class="vls-gf-icon"></span>\r\n\t\t\t<span class="vls-gf-label">'+(null==(__t=t.unsortedImages)?"":__t)+'</span>\r\n\t\t</div>\r\n\t</div>\r\n\t<div class="vls-gf-library">\r\n\t\t<div>\r\n\t\t\t<span class="vls-gf-icon"></span>\r\n\t\t\t<span class="vls-gf-label">'+(null==(__t=t.library)?"":__t)+'</span>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n<div class="vls-gf-scroll-wrapper">\r\n\t<div class="vls-gf-scroll-scroller">\r\n\t\t<div class="vls-gf-navigation-tree">\r\n\t\t</div>\r\n\t\t<div class="vls-gf-scroll-bar"></div>\r\n\t</div>\r\n</div>\r\n\r\n\r\n';return __p}},function(t,e,i){"use strict";var n=i(5),s=i(3),o=i(16),r=s.Collection.extend({model:o,url:"node_collection",parentId:0,initialize:function(t,e){this.parentId=e.parentId},fetch:function(t){t=t?t:{},t=n.extend(t,{data:{parent_type:"folder",parent_id:this.parentId,view:"nav_item"}}),s.Collection.prototype.fetch.call(this,t)}});t.exports=r},function(t,e,i){var n=i(2),s=i(26),o=i(13),r=i(30),a=i(28),l={height:32,middle:15,topPart:10,bottomPart:20,indent:16},d=s.extend({tagName:"div",className:function(){var t;return t="folder"===this.model.get("type")?"vls-gf-folder vls-gf-no-tran":"vls-gf-album vls-gf-no-tran"},viewName:"item",template:r,ui:{body:"> div",icon:"> div >.vls-gf-icon",label:"> div > .vls-gf-label"},events:{"click @ui.body":"onBodyClick","touchstart @ui.body":"onBodyClick","click @ui.icon":"toggleCollapsed","touchstart @ui.icon":"toggleCollapsed"},initialize:function(t){this.parentId=t.parentId,this.level=t.level,this.visibilityState=t.visibilityState,this.isActive=!1,this.type="",this.orderNo=0,this.collapseState="collapsed",this.draggingState={isDragging:!1,startY:0,currentY:0,directionY:"",currentArea:{top:0,bottom:0,left:0,right:0}},this.listenTo(this.radio,"navigation:requested",this.onNavigationRequested),this.listenTo(this.radio,"navigation:itemActivated",this.onItemActivated),this.listenTo(this.radio,"folder:changed",this.onFolderChanged),this.listenTo(this.radio,"album:changed",this.onAlbumChanged),this.listenTo(this.radio,"folder:contentChanged",this.onFolderContentChanged)},onBeforeRender:function(){this.$childViewContainer=n("#vls-gf-app .vls-gf-navigation-tree")},onRender:function(){var t=this,e=this.model.get("id");this.childViewOptions={parentId:parseInt(e),level:this.level+1,visibilityState:"opened"===this.collapseState?"visible":"hidden"},this.type=this.model.get("type"),this.collection=new a([],{parentId:e}),this.listenTo(this.collection,"sync",this.onCollectionSync),"visible"===this.visibilityState&&this.collection.fetch(),this.$el.draggable({distance:2,delay:200,addClasses:!1,position:"absolute",scroll:!1,cursor:!1,helper:function(){return n('<div id="vls-gf-nav-item-drag-helper"></div>').append(t.$el.html())},appendTo:"body",start:this._onDragStart.bind(this),drag:this._onDrag.bind(this),stop:this._onDragStop.bind(this)}),"album"==this.type&&this.$el.droppable({accept:".vls-gf-dragged-image",hoverClass:"vls-gf-drop-ready",drop:this._onImageDrop.bind(this)}),this.$el.addClass("vls-gf-level-"+this.level),"hidden"===this.visibilityState&&this.$el.addClass("vls-gf-hidden")},onShow:function(){var t=this.$el;setTimeout(function(){t.removeClass("vls-gf-no-tran")}),this.radio.trigger("global:needAdjustFixedElement",{})},updatePositions:function(t){var e=this;if(e.draggingState.isDragging||t.orderNo++,clearTimeout(e.hoverTimeout),t.isItemDragging&&t.draggingOrderNo===t.orderNo&&t.orderNo++,e.orderNo=t.orderNo,this._setPosition(0,l.height*t.orderNo),t.isItemDragging&&(t=e._updateDraggingContext(t)),"visible"===e.visibilityState||"revealing"===e.visibilityState){var i=t.orderNo;e.collection.each(function(i){var n=e.children.findByModel(i);n&&(t=n.updatePositions(t))}),"collapsed"!==e.collapseState&&"collapsing"!==e.collapseState||(t.orderNo=i)}return t},onCollectionSync:function(){this.radio.trigger("navigationPanel:requestRedrawTree")},toggleCollapsed:function(t,e,i){var n=this;if("folder"===n.type)return"collapsed"!==n.collapseState||e?"opened"===n.collapseState&&(n.collapseState="collapsing",n.$el.removeClass("vls-gf-opened"),n.children.each(function(t){t.setVisibilityState("hiding")}),setTimeout(function(){n.collapseState="collapsed",n.childViewOptions.visibilityState="opened"===n.collapseState?"visible":"hidden",n.children.each(function(t){t.setVisibilityState("hidden")})},600)):(n.collapseState="opening",n.$el.addClass("vls-gf-opened"),n.children.each(function(t){t.setVisibilityState("revealing")}),setTimeout(function(){n.collapseState="opened",n.childViewOptions.visibilityState="opened"===n.collapseState?"visible":"hidden",n.children.each(function(t){t.setVisibilityState("visible")})},600)),i||n.radio.trigger("navigationPanel:requestRedrawTree"),!1},onBodyClick:function(t){this.radio.trigger("navigation:requested",{id:this.model.get("id"),type:this.model.get("type")})},onNavigationRequested:function(t){this.model.get("id")==t.id&&(this.isActive=!0,this.$el.addClass("vls-gf-active"),this.triggerMethod("activatedDownstream",{type:this.model.get("type"),id:this.model.get("id"),name:this.model.get("name"),parentId:this.parentId,breadcrumbs:[]}))},onChildviewActivatedDownstream:function(t,e){"folder"==this.type&&"collapsed"===this.collapseState&&this.toggleCollapsed(),e.breadcrumbs.unshift({id:this.model.get("id"),name:this.model.get("name")}),this.triggerMethod("activatedDownstream",{type:e.type,id:e.id,name:e.name,parentId:e.parentId,breadcrumbs:e.breadcrumbs})},onItemActivated:function(t){this.isActive&&this.model.get("id")!=t.id&&this.$el.removeClass("vls-gf-active")},setOpenTimeout:function(){var t=this;t.hoverTimeout=setTimeout(function(){t.toggleCollapsed()},600)},setVisibilityState:function(t){var e=this,i=e.$el;e.visibilityState===t||"hidden"===e.visibilityState&&"hiding"===t||(e.visibilityState=t,"hidden"===t?(i.removeClass("vls-gf-hiding").addClass("vls-gf-hidden"),e.children.each(function(t){t.setVisibilityState("hidden")})):"hiding"===t?(i.addClass("vls-gf-hiding"),e.toggleCollapsed({},!0,!0),e.children.each(function(t){t.setVisibilityState("hiding")})):"visible"===t?(i.removeClass("vls-gf-revealing vls-gf-hidden"),"visible"===this.visibilityState&&e.collection.fetch()):"revealing"===t&&i.addClass("vls-gf-revealing"))},onFolderChanged:function(t){var e=t.model;if(this.model.get("id")==e.get("id")){var i=e.get("name");this.model.set("name",i),this.ui.label.html(i)}},onAlbumChanged:function(t){var e=t.model;if(this.model.get("id")==e.get("id")){var i=e.get("name");this.model.set("name",i),this.ui.label.html(i)}},onFolderContentChanged:function(t){this.model.get("id")==t.id&&this.collection.fetch()},_onDragStart:function(t,e){this.draggingState.navigationTreeElement=n("#vls-gf-app .vls-gf-navigation-tree"),this.draggingState.isDragging=!0,this.draggingState.isFirstDragMove=!0,this.draggingState.currentArea={top:0,bottom:0,left:0,right:0},this.draggingState.dragStartIndent=(this.level-1)*l.indent,this.draggingState.previousY=Math.floor(e.offset.top+l.height/2),e.helper.addClass("vls-gf-"+this.type+" vls-gf-level-"+this.level),this.toggleCollapsed({},!0),this.$el.addClass("vls-gf-dragged"),this.radio.trigger("navigationPanel:itemDragStart",{})},_onDrag:function(t,e){var i=this,n=i.draggingState.previousY,s=!1,r="none",a=i.draggingState.isFirstDragMove,d=Math.floor(e.offset.top+l.height/2),c=e.offset.left+i.draggingState.dragStartIndent;if(i.draggingState.previousY=d,!(d>=i.draggingState.currentArea.top&&d<=i.draggingState.currentArea.bottom&&c>=i.draggingState.currentArea.left&&c<=i.draggingState.currentArea.right)){var u=this.draggingState.navigationTreeElement.offset().top,h=Math.floor((d-u)/l.height);h<0&&(h=0);var g=u+l.height*h,p=d-g;(d<i.draggingState.currentArea.top||d>i.draggingState.currentArea.bottom)&&(a?(i.draggingState.currentArea.top=g,i.draggingState.currentArea.bottom=g+l.height-1,i.draggingState.isFirstDragMove=!1):d>n?(r="down",p<=l.bottomPart?(i.draggingState.currentArea.top=g,i.draggingState.currentArea.bottom=g+l.bottomPart,s=!0):(i.draggingState.currentArea.top=g,i.draggingState.currentArea.bottom=g+l.height-1)):d<n&&(r="up",p<=l.bottomPart?(i.draggingState.currentArea.top=g,i.draggingState.currentArea.bottom=g+l.height-1):(i.draggingState.currentArea.top=g+l.topPart+1,i.draggingState.currentArea.bottom=g+l.height-1,s=!0)));var f=this.draggingState.navigationTreeElement.offset().left,v=Math.floor((c-f)/l.indent);v<0?v=0:v>7&&(v=7),0===v?this.draggingState.currentArea.left=-9999:this.draggingState.currentArea.left=f+v*l.indent,7===v?this.draggingState.currentArea.right=9999:this.draggingState.currentArea.right=f+(v+1)*l.indent-1,o.trigger("navigationPanel:itemDrag",{currentOrderNo:h,currentIndent:v,directionY:r,maybeFolderOpenIntent:s,isFirstDragMove:a})}},_onDragStop:function(t,e){this.draggingState.isDragging=!1,this.$el.removeClass("vls-gf-dragged");var i=this._parent;this.radio.trigger("navigationPanel:itemDragStop",{draggedItem:this,oldParent:i}),this.draggingState={}},_onImageDrop:function(t,e){var i=this.radio,s=this.model.get("id"),o=e.helper.data("sourceAlbum"),r=e.helper.data("draggedImages");o!=s&&n.post(ajaxurl,{action:"vls_gf_api_image_collection_move",_nonce:vlsGFData.nonce,collection:JSON.stringify(r),from_folder:o,to_folder:s},function(){i.trigger("manager:content:bulkSelectModeDeactivated",{}),i.trigger("album:contentChanged",{id:o}),i.trigger("album:contentChanged",{id:s})})},_setPosition:function(t,e){this.$el.css({transform:"translate3d("+t+"px, "+e+"px, 0)"})},_updateDraggingContext:function(t){if("visible"!==this.visibilityState&&"revealing"!==this.visibilityState||this.draggingState.isDragging)return t;var e=t.draggingOrderNo;if(this.orderNo<t.draggingOrderNo){t.parents[this.level]=this;var i;for(i=this.level+1;i<=7;i++)t.parents[i]=null}return e-this.orderNo===1?t.upperNeighbour=this:this.orderNo-e===1&&(t.lowerNeighbour=this),t}});t.exports=d},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div data-id="'+(null==(__t=id)?"":__t)+'"><span class="vls-gf-icon"></span><span class="vls-gf-label">'+(null==(__t=name)?"":__t)+"</span></div>";return __p}},function(t,e,i){!function(e,i){"use strict";function n(t){var s,o,r=!!t,a={$:e.jQuery,direction:"v",barOnCls:"_scrollbar",resizeDebounce:0,event:function(e,i,n,s){t.$(e)[s||"on"](i,n)},cssGuru:!1,impact:"scroller"};t=t||{};for(var l in a)t[l]===i&&(t[l]=a[l]);if(!t.$)throw new Error("baron: no $ found.");s=this instanceof t.$,s?t.root=o=this:o=t.$(t.root||t.scroller);var d=new n.fn.constructor(o,t,r);return d.autoUpdate&&d.autoUpdate(),d}function s(t,n){var s=0;for(t.length!==i&&t!==e||(t=[t]);t[s];)n.call(this,t[s],s),s++}function o(){return(new Date).getTime()}function r(t,i,n){t._eventHandlers=t._eventHandlers||[{element:t.scroller,handler:function(e){t.scroll(e)},type:"scroll"},{element:t.root,handler:function(){t.update()},type:"transitionend animationend"},{element:t.scroller,handler:function(){t.update()},type:"keyup"},{element:t.bar,handler:function(e){e.preventDefault(),t.selection(),t.drag.now=1,t.draggingCls&&t.root.addClass(t.draggingCls)},type:"touchstart mousedown"},{element:document,handler:function(){t.selection(1),t.drag.now=0,t.draggingCls&&t.root.removeClass(t.draggingCls)},type:"mouseup blur touchend"},{element:document,handler:function(e){2!=e.button&&t._pos0(e);
},type:"touchstart mousedown"},{element:document,handler:function(e){t.drag.now&&t.drag(e)},type:"mousemove touchmove"},{element:e,handler:function(){t.update()},type:"resize"},{element:t.root,handler:function(){t.update()},type:"sizeChange"},{element:t.clipper,handler:function(){t.clipperOnScroll()},type:"scroll"}],s(t._eventHandlers,function(t){t.element&&i(t.element,t.type,t.handler,n)})}function a(t,e,i,n){var s="data-baron-"+e+"-id";if("on"==i)t.setAttribute(s,n);else{if("off"!=i)return t.getAttribute(s);t.removeAttribute(s)}}function l(t){var e=new y.prototype.constructor(t);return r(e,t.event,"on"),a(e.root,t.direction,"on",p.length),p.push(e),e.update(),e.scrollEdge=0,t.rtl&&(e.scrollEdge=e.clipper[e.origin.scrollEdge]),e}function d(t){var e={};t=t||{};for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}function c(t){if(this.events&&this.events[t])for(var e=0;e<this.events[t].length;e++){var i=Array.prototype.slice.call(arguments,1);this.events[t][e].apply(this,i)}}if(e){var u=e.$,h=n,g=["left","top","right","bottom","width","height"],p=[],f={v:{x:"Y",pos:g[1],oppos:g[3],crossPos:g[0],crossOpPos:g[2],size:g[5],crossSize:g[4],crossMinSize:"min-"+g[4],crossMaxSize:"max-"+g[4],client:"clientHeight",crossClient:"clientWidth",scrollEdge:"scrollLeft",offset:"offsetHeight",crossOffset:"offsetWidth",offsetPos:"offsetTop",scroll:"scrollTop",scrollSize:"scrollHeight"},h:{x:"X",pos:g[0],oppos:g[2],crossPos:g[1],crossOpPos:g[3],size:g[4],crossSize:g[5],crossMinSize:"min-"+g[5],crossMaxSize:"max-"+g[5],client:"clientWidth",crossClient:"clientHeight",scrollEdge:"scrollTop",offset:"offsetWidth",crossOffset:"offsetHeight",offsetPos:"offsetLeft",scroll:"scrollLeft",scrollSize:"scrollWidth"}},v=17,m=15,_=/[\s\S]*Macintosh[\s\S]*\) Gecko[\s\S]*/,b=_.test(e.navigator.userAgent);n._instances=p,n.fn={constructor:function(t,e,n){var o=d(e);o.event=function(t,i,n,o){s(t,function(t){e.event(t,i,n,o)})},this.length=0,s.call(this,t,function(t,s){var r=a(t,o.direction),c=+r;if(c==c&&r!=i&&p[c])n&&console.log("Error! Baron for this node already initialized",e.root),this[s]=p[c];else{var u=d(o);if(o.root&&o.scroller){if(u.scroller=o.$(o.scroller,t),!u.scroller.length)return void console.log("Scroller not found!",t,o.scroller)}else u.scroller=t;u.root=t,u.$root=o.$(t),this[s]=l(u)}this.length=s+1}),this.params=o},dispose:function(){var t=this.params;s(this,function(e){e.dispose(t)}),this.params=null},update:function(){for(var t=0;this[t];)this[t].update.apply(this[t],arguments),t++},baron:function(t){return t.root=[],t.scroller=this.params.scroller,s.call(this,this,function(e){t.root.push(e.root)}),t.direction="v"==this.params.direction?"h":"v",t._chain=!0,n(t)}};var y={};y.prototype={_debounce:function(t,e){var i,n,s=this,r=function(){if(s._disposed)return clearTimeout(i),void(i=s=null);var a=o()-n;a<e&&a>=0?i=setTimeout(r,e-a):(i=null,t())};return function(){n=o(),i||(i=setTimeout(r,e))}},constructor:function(t){function n(t,e){return h(t,e)[0]}function s(t){var e=this.barMinSize||20;t>0&&t<e&&(t=e),this.bar&&h(this.bar).css(this.origin.size,parseInt(t,10)+"px")}function r(t){if(this.bar){var e=h(this.bar).css(this.origin.pos),i=+t+"px";i&&i!=e&&h(this.bar).css(this.origin.pos,i)}}function a(){return _[this.origin.client]-this.barTopLimit-this.bar[this.origin.offset]}function l(t){return t*a.call(this)+this.barTopLimit}function d(t){return(t-this.barTopLimit)/a.call(this)}function u(){return!1}var h,g,p,_,y,w,x,M,C;if(M=x=o(),h=this.$=t.$,this.event=t.event,this.events={},this.root=t.root,this.$root=t.$root,this.scroller=n(t.scroller),this.bar=n(t.bar,this.root),_=this.track=n(t.track,this.root),!this.track&&this.bar&&(_=this.bar.parentNode),this.clipper=this.scroller.parentNode,this.direction=t.direction,this.origin=f[this.direction],this.barOnCls=t.barOnCls||"_baron",this.scrollingCls=t.scrollingCls,this.draggingCls=t.draggingCls,this.impact=t.impact,this.barTopLimit=0,this.resizeDebounce=t.resizeDebounce,this.cursor=function(t){return t["client"+this.origin.x]||(((t.originalEvent||t).touches||{})[0]||{})["page"+this.origin.x]},this.pos=function(t){var e="page"+this.origin.x+"Offset",n=this.scroller[e]?e:this.origin.scroll;return t!==i&&(this.scroller[n]=t),this.scroller[n]},this.rpos=function(t){var e,i=this.scroller[this.origin.scrollSize]-this.scroller[this.origin.client];return e=t?this.pos(t*i):this.pos(),e/(i||1)},this.barOn=function(t){this.barOnCls&&(t||this.scroller[this.origin.client]>=this.scroller[this.origin.scrollSize]?this.$root.hasClass(this.barOnCls)&&this.$root.removeClass(this.barOnCls):this.$root.hasClass(this.barOnCls)||this.$root.addClass(this.barOnCls))},this._pos0=function(t){p=this.cursor(t)-g},this.drag=function(t){var e=d.call(this,this.cursor(t)-p),i=this.scroller[this.origin.scrollSize]-this.scroller[this.origin.client];this.scroller[this.origin.scroll]=e*i},this.selection=function(t){this.event(document,"selectpos selectstart",u,t?"off":"on")},this.resize=function(){function t(){var t,i,n=e.scroller[e.origin.crossOffset],s=e.scroller[e.origin.crossClient],r=0;if(b?r=m:s>0&&0===n&&(n=s+v),n)if(e.barOn(),s=e.scroller[e.origin.crossClient],"scroller"==e.impact){var a=n-s+r;t=h(e.scroller).css(e.origin.crossSize),i=e.clipper[e.origin.crossClient]+a+"px",t!=i&&e._setCrossSizes(e.scroller,i)}else t=h(e.clipper).css(e.origin.crossSize),i=s+"px",t!=i&&e._setCrossSizes(e.clipper,i);Array.prototype.unshift.call(arguments,"resize"),c.apply(e,arguments),M=o()}var e=this,n=e.resizeDebounce===i?300:e.resizeDebounce,s=0;o()-M<n&&(clearTimeout(y),s=n),s?y=setTimeout(t,s):t()},this.updatePositions=function(){var t,e=this;e.bar&&(t=(_[e.origin.client]-e.barTopLimit)*e.scroller[e.origin.client]/e.scroller[e.origin.scrollSize],parseInt(C,10)!=parseInt(t,10)&&(s.call(e,t),C=t),g=l.call(e,e.rpos()),r.call(e,g)),Array.prototype.unshift.call(arguments,"scroll"),c.apply(e,arguments),x=o()},this.scroll=function(){var t=this;t.updatePositions(),t.scrollingCls&&(w||t.$root.addClass(t.scrollingCls),clearTimeout(w),w=setTimeout(function(){t.$root.removeClass(t.scrollingCls),w=i},300))},this.clipperOnScroll=function(){"h"!=this.direction&&(this.clipper[this.origin.scrollEdge]=this.scrollEdge)},this._setCrossSizes=function(t,e){var i={};i[this.origin.crossSize]=e,i[this.origin.crossMinSize]=e,i[this.origin.crossMaxSize]=e,this.$(t).css(i)},this._dumbCss=function(e){if(!t.cssGuru){var i=e?"hidden":null,n=e?"none":null;this.$(this.clipper).css({overflow:i,msOverflowStyle:n});var s=e?"scroll":null,o="v"==this.direction?"y":"x",r={};r["overflow-"+o]=s,r["box-sizing"]="border-box",r.margin="0",r.border="0",this.$(this.scroller).css(r)}},this._dumbCss(!0),b){var S="paddingRight",I={},T=e.getComputedStyle(this.scroller)[[S]];this.scroller[this.origin.crossOffset]-this.scroller[this.origin.crossClient];"h"==t.direction?S="paddingBottom":t.rtl&&(S="paddingLeft");var D=parseInt(T,10);D!=D&&(D=0),I[S]=m+D+"px",h(this.scroller).css(I)}return this},update:function(t){return c.call(this,"upd",t),this.resize(1),this.updatePositions(),this},dispose:function(t){r(this,this.event,"off"),a(this.root,t.direction,"off"),"v"==t.direction?this._setCrossSizes(this.scroller,""):this._setCrossSizes(this.clipper,""),this._dumbCss(!1),this.barOn(!0),c.call(this,"dispose"),this._disposed=!0},on:function(t,e,i){for(var n=t.split(" "),s=0;s<n.length;s++)"init"==n[s]?e.call(this,i):(this.events[n[s]]=this.events[n[s]]||[],this.events[n[s]].push(function(t){e.call(this,t||i)}))}},n.fn.constructor.prototype=n.fn,y.prototype.constructor.prototype=y.prototype,n.noConflict=function(){return e.baron=h,n},n.version="2.0.1",u&&u.fn&&(u.fn.baron=n),e.baron=n,t.exports=n.noConflict()}}(window),function(t){var e=t.MutationObserver||t.WebKitMutationObserver||t.MozMutationObserver||null,i=function(){function t(){o.root[o.origin.offset]?n():i()}function i(){s||(s=setInterval(function(){o.root[o.origin.offset]&&(n(),o.update())},300))}function n(){clearInterval(s),s=null}var s,o=this;if(!this._au){var r=o._debounce(function(){o.update()},300);this._observer=new e(function(){t(),o.update(),r()}),this.on("init",function(){o._observer.observe(o.root,{childList:!0,subtree:!0,characterData:!0}),t()}),this.on("dispose",function(){o._observer.disconnect(),n(),delete o._observer}),this._au=!0}};baron.fn.autoUpdate=function(t){if(!e)return this;for(var n=0;this[n];)i.call(this[n],t),n++;return this}}(window),function(t,e){var i=function(t){var e,i,n,s,o,r=this;s=t.screen||.9,t.forward&&(e=this.$(t.forward,this.clipper),o={element:e,handler:function(){var e=r.pos()+(t.delta||30);r.pos(e)},type:"click"},this._eventHandlers.push(o),this.event(o.element,o.type,o.handler,"on")),t.backward&&(i=this.$(t.backward,this.clipper),o={element:i,handler:function(){var e=r.pos()-(t.delta||30);r.pos(e)},type:"click"},this._eventHandlers.push(o),this.event(o.element,o.type,o.handler,"on")),t.track&&(n=t.track===!0?this.track:this.$(t.track,this.clipper)[0],n&&(o={element:n,handler:function(t){if(t.target==n){var e=t["offset"+r.origin.x],i=r.bar[r.origin.offsetPos],o=0;e<i?o=-1:e>i+r.bar[r.origin.offset]&&(o=1);var a=r.pos()+o*s*r.scroller[r.origin.client];r.pos(a)}},type:"mousedown"},this._eventHandlers.push(o),this.event(o.element,o.type,o.handler,"on")))};baron.fn.controls=function(t){for(var e=0;this[e];)i.call(this[e],t),e++;return this}}(window)},function(t,e,i){var n=i(2),s=i(21),o=i(33),r=i(34),a=i(35),l=i(37),d=s.extend({className:"vls-gf-view-folder-overview",template:o,regions:{listPanel:".vls-gf-list"},ui:{},events:{},state:new r,initialize:function(t){this.folderId=t.folderId,this.listenTo(this.radio,"folder:contentChanged",this.onFolderContentChanged),this.collection=new a([],{parentId:this.folderId}),this.listenTo(this.collection,"sync",this.onCollectionSync),this.collection.fetch()},onShow:function(){this.radio.trigger("global:needAdjustFixedElement",{})},onCollectionSync:function(){this._renderList()},onFolderContentChanged:function(t){this.folderId===t.id&&this.collection.fetch()},_renderList:function(){if(this.$el.find(".vls-gf-empty-message").remove(),0===this.collection.length){this.listPanel.empty();var t=n("<div>").addClass("vls-gf-empty-message");0===this.folderId?t.html(this.l10n.t("rootFolderEmpty")):t.html(this.l10n.t("folderEmpty")),this.$el.append(t)}else this.listPanel.show(new l({collection:this.collection}))}});t.exports=d},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="vls-gf-list">\r\n</div>\r\n\r\n<div class="vls-gf-clear">\r\n</div>';return __p}},function(t,e,i){"use strict";var n=i(3),s=n.Model.extend({defaults:{listMode:"grid",sortBy:"none",sortOrder:"asc"}});t.exports=s},function(t,e,i){"use strict";var n=i(5),s=i(3),o=i(36),r=s.Collection.extend({model:o,url:"node_collection",parentId:0,initialize:function(t,e){this.type=e.type||"folder",this.parentId=e.parentId,this.sortAttribute="id",this.sortOrder="asc"},fetch:function(t){t=t?t:{},t=n.extend(t,{data:{parent_type:this.type,parent_id:this.parentId,view:"list_item"}}),s.Collection.prototype.fetch.call(this,t)},comparator:function(t){var e=this.sortAttribute;return t.get(e)},sortByAttribute:function(t,e){this.comparator=function(e){return e.get(t)},"desc"===e?(this.sort({silent:!0}),this.models=this.models.reverse(),this.trigger("sort",this)):this.sort()},selected:function(){return this.filter(function(t){return t.get("selected")})}});t.exports=r},function(t,e,i){"use strict";var n=i(17),s=n.extend({url:"node",toJSON:function(){var t=n.prototype.toJSON.call(this);return t.file_size_kb=t.file_size?Math.round(t.file_size/1024):0,t}});t.exports=s},function(t,e,i){var n=i(26),s=i(38),o=i(39),r=n.extend({tagName:"table",className:"vls-gf-table",template:s,templateHelpers:function(){return{t:{name:this.l10n.t("name"),caption:this.l10n.t("caption"),description:this.l10n.t("description"),folderCount:this.l10n.t("folderCount"),albumCount:this.l10n.t("albumCount")}}},childView:o,childViewContainer:">tbody",initialize:function(t){}});t.exports=r},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="<thead>\r\n<tr>\r\n\t<th></th>\r\n\t<th>"+(null==(__t=t.name)?"":__t)+"</th>\r\n\t<th>"+(null==(__t=t.caption)?"":__t)+"</th>\r\n\t<th>"+(null==(__t=t.description)?"":__t)+"</th>\r\n</tr>\r\n</thead>\r\n<tbody></tbody>";return __p}},function(t,e,i){var n=i(40),s=i(41),o=i(42),r=n.extend({tagName:"tr",template:o,behaviors:{editableTableCell:{behaviorClass:s}},events:{click:"onBodyClick",dblclick:"onBodyDoubleClick"},initialize:function(t){this.isActive=!1,this.listenTo(this.radio,"manager:content:itemActivated",this.onItemActivated),this.listenTo(this.radio,"manager:content:bulkSelectModeActivated",this.onBulkSelectModeActivated),this.listenTo(this.radio,"manager:content:bulkSelectModeDeactivated",this.onBulkSelectModeDeactivated)},onBodyClick:function(t){return this.isSelectMode?this.toggleSelection(t):(this.isActive=!0,this.$el.addClass("vls-gf-active"),this.radio.trigger("manager:content:itemActivated",{type:this.model.get("type"),id:this.model.get("id")})),!1},onBodyDoubleClick:function(t){t.preventDefault(),this.radio.trigger("navigation:requested",{type:this.model.get("type"),id:this.model.get("id"),name:this.model.get("name")})},onItemActivated:function(t){this.isActive&&this.model.get("id")!==t.id&&(this.isActive=!1,this.$el.removeClass("vls-gf-active"))},onBulkSelectModeActivated:function(t){this.isSelectMode=!0,this.$el.addClass("vls-gf-selectable")},onBulkSelectModeDeactivated:function(t){this.isSelectMode=!1,this.$el.removeClass("vls-gf-selectable")}});t.exports=r},function(t,e,i){"use strict";var n=i(8),s=i(13),o=i(22),r=n.ItemView.extend({l10n:o,radio:s});t.exports=r},function(t,e,i){var n=i(2),s=i(8),o=s.Behavior.extend({ui:{fields:"td>.vls-gf-editable"},events:{"click @ui.fields":"onEditableClick","dblclick @ui.fields":"onEditableDoubleClick"},onEditableClick:function(t){var e=this.view;if(e.inlineEditMode)return!1;if(!e.isSelectMode){e.inlineEditMode=!0;var i=n("#vls-gf-app"),s=e.$el,o=n(t.target),r=o.data("attr"),a=n('<input type="text"/>').val(e.model.get(r));s.addClass("vls-gf-edited"),o.addClass("vls-gf-edited");var l=n('<div id="vls-gf-blur-mask"></div>');l.on("click touchstart",function(t){a.blur(),t.preventDefault(),t.stopPropagation()}),a.on("click dblclick",function(t){t.stopPropagation()}),a.on("change blur",function(){var t=n(this).val(),i=e.model,a=i.get(r);t!=a&&(i.save(r,t,{parse:!1,patch:!0}),"folder"==i.get("type")?e.radio.trigger("folder:changed",{model:i}):"album"==i.get("type")?e.radio.trigger("album:changed",{model:i}):i.get("id")&&e.radio.trigger("image:changed",{model:i,source:"inlineEdit"})),s.removeClass("vls-gf-edited"),o.text(t).removeClass("vls-gf-edited"),e.inlineEditMode=!1,l.remove()}),i.append(l),o.html(a),a.focus(),t.stopPropagation(),t.preventDefault()}},onEditableDoubleClick:function(t){t.stopPropagation()}});t.exports=o},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<td><i class="vls-gf-icon vls-gf-icon-'+(null==(__t=type)?"":__t)+'-b"></i></td>\r\n<td>\r\n\t<div class="vls-gf-editable" data-attr="name">'+(null==(__t=name)?"":__t)+'</div>\r\n</td>\r\n<td>\r\n\t<div class="vls-gf-editable" data-attr="caption">'+(null==(__t=caption)?"":__t)+'</div>\r\n</td>\r\n<td>\r\n\t<div class="vls-gf-editable" data-attr="description">'+(null==(__t=description)?"":__t)+"</div>\r\n</td>";return __p}},function(t,e,i){var n=i(5),s=i(2),o=i(21),r=i(44),a=i(45),l=i(46),d=i(35),c=i(48),u=i(52),h=o.extend({className:"vls-gf-view-album-overview",template:r,templateHelpers:function(){return{t:{tt:{toggleListMode:this.l10n.t("tooltips.toggleListMode"),activateBulkSelectMode:this.l10n.t("tooltips.activateBulkSelectMode"),cancelSelection:this.l10n.t("tooltips.cancelSelection"),selectAll:this.l10n.t("tooltips.selectAll"),selectInvert:this.l10n.t("tooltips.selectInvert"),selectNone:this.l10n.t("tooltips.selectNone"),deleteSelected:this.l10n.t("tooltips.deleteSelected")}}}},regions:{listPanel:".vls-gf-image-list"},ui:{bulkSelectToolbar:"#vls-gf-album-overview-toolbar-select",btnActivateBulkSelectMode:"#vls-gf-album-overview-toolbar-default button.vls-gf-icon-select-b",btnCancelBulkSelectMode:"#vls-gf-album-overview-toolbar-select button.vls-gf-icon-close-w",btnListModeTable:'#vls-gf-album-overview-toolbar-default button[data-action="list-mode-table"]',btnListModeThumbs:'#vls-gf-album-overview-toolbar-default button[data-action="list-mode-thumbs"]',btnSelectAll:'#vls-gf-album-overview-toolbar-select button[data-action="select-all"]',btnSelectInvert:'#vls-gf-album-overview-toolbar-select button[data-action="select-invert"]',btnSelectNone:'#vls-gf-album-overview-toolbar-select button[data-action="select-none"]',btnDeleteSelected:'#vls-gf-album-overview-toolbar-select button[data-action="delete-selected"]',txtSelectedImages:"#vls-gf-album-overview-toolbar-select > h4"},events:{"click @ui.btnActivateBulkSelectMode":"onBtnActivateBulkSelectMode","click @ui.btnCancelBulkSelectMode":"onBtnCancelBulkSelectMode","click @ui.btnListModeTable":"onBtnToggleListMode","click @ui.btnListModeThumbs":"onBtnToggleListMode","click @ui.btnSelectAll":"onBtnSelectAll","click @ui.btnSelectInvert":"onBtnSelectInvert","click @ui.btnSelectNone":"onBtnSelectNone","click @ui.btnDeleteSelected":"onBtnDeleteSelected"},childEvents:{"selection:toggle":"onSelectionToggle"},collectionEvents:{},state:new a,initialize:function(t){this.type=t.type,this.albumId=t.albumId||0,this.bulkSelectMode=!1,this.listenTo(this.radio,"manager:content:bulkSelectModeActivated",this.onBulkSelectModeActivated),this.listenTo(this.radio,"manager:content:bulkSelectModeDeactivated",this.onBulkSelectModeDeactivated),this.listenTo(this.radio,"album:contentChanged",this.onAlbumContentChanged),this.listenTo(this.radio,"image:changed",this.onImageChanged),this.radio.reply("album:getNeighbourImage",this.getNeighbourImage.bind(this)),"all_images"===this.type||"unsorted_images"===this.type?this.collection=new l([],{type:this.type}):this.collection=new d([],{type:this.type,parentId:this.albumId}),this.listenTo(this.collection,"sync",this.onCollectionSync),this.collection.fetch()},onRender:function(){"table"===this.state.get("listMode")?this.ui.btnListModeTable.hide():this.ui.btnListModeThumbs.hide()},onShow:function(){this.radio.trigger("global:needAdjustFixedElement",{})},onCollectionSync:function(){this._renderList()},onBtnActivateBulkSelectMode:function(){this.radio.trigger("manager:content:bulkSelectModeActivated",{})},onBtnCancelBulkSelectMode:function(){this.radio.trigger("manager:content:bulkSelectModeDeactivated",{})},onBulkSelectModeActivated:function(){this.bulkSelectMode=!0,this.ui.txtSelectedImages.html(this.l10n.t("nImagesSelected",0)),this.ui.bulkSelectToolbar.css({display:"block"})},onBulkSelectModeDeactivated:function(){this.onBtnSelectNone(),this.bulkSelectMode=!1,this.ui.bulkSelectToolbar.css({display:"none"})},onSelectionToggle:function(t,e){this.bulkSelectMode||this.radio.trigger("manager:content:bulkSelectModeActivated",{});var i=this.lastSelectedModel,n=t.model;if(e.shiftKey&&i&&n!==i){var s=!1,o=null;this.collection.each(function(t){s||t!==n&&t!==i||(o=t,s=!0),s&&t.set("selected",e.selected),!s||o===t||t!==n&&t!==i||(s=!1)})}this.lastSelectedModel=n,this._updateSelectedCountInfo()},onBtnToggleListMode:function(){var t,e=this.state.get("listMode");"grid"===e?(this.state.set("listMode","table"),this.ui.btnListModeTable.hide(),t=this.ui.btnListModeThumbs,t.addClass("vls-gf-no-tooltip").show(),setTimeout(function(){t.removeClass("vls-gf-no-tooltip")},100)):(this.state.set("listMode","grid"),this.ui.btnListModeThumbs.hide(),t=this.ui.btnListModeTable,t.addClass("vls-gf-no-tooltip").show(),setTimeout(function(){t.removeClass("vls-gf-no-tooltip")},100)),this._renderList()},onBtnSelectAll:function(){this.collection.each(function(t){t.set("selected",!0)}),this._updateSelectedCountInfo()},onBtnSelectInvert:function(){this.collection.each(function(t){t.set("selected",!t.get("selected"))}),this._updateSelectedCountInfo()},onBtnSelectNone:function(){this.collection.each(function(t){t.set("selected",!1)}),this._updateSelectedCountInfo()},onBtnDeleteSelected:function(){var t=this.radio,e=this.collection.selected(),i=this.albumId,o=[];n.each(e,function(t){o.push(t.get("id"))});var r;r="all_images"===this.type||"unsorted_images"===this.type?{action:"vls_gf_api_image_collection",_method:"DELETE",_nonce:vlsGFData.nonce,collection:JSON.stringify(o)}:{action:"vls_gf_api_node_collection",_method:"DELETE",_nonce:vlsGFData.nonce,collection:JSON.stringify(o)},s.post(ajaxurl,r,function(){t.trigger("manager:content:bulkSelectModeDeactivated",{}),t.trigger("album:contentChanged",{id:i})})},onAlbumContentChanged:function(t){this.albumId===t.id&&this.collection.fetch()},getNeighbourImage:function(t){var e,i,n=this.collection;if(i=n.findWhere({image_id:t.id}),e=n.indexOf(i),e<0)return null;"next"==t.direction?e>=n.length-1?e=0:e+=1:e<=0?e=n.length-1:e-=1;var s=n.at(e);return{id:s.get("image_id"),name:s.get("name")}},onImageChanged:function(t){if("inlineEdit"!=t.source){var e=t.model.get("id"),i=this.collection.get(e);if(i){var n=i.get("thumbnail_url"),s=Date.now();n=n.replace(/\?\d+$/,"?"+s),i.set({name:t.model.get("name"),caption:t.model.get("caption"),description:t.model.get("description"),thumbnail_url:n}),this._renderList()}}},_renderList:function(){if(0===this.collection.length){this.listPanel.empty(),this.$el.find(".vls-gf-empty-message").remove();var t=s("<div>").addClass("vls-gf-empty-message");"album"===this.type?t.html(this.l10n.t("albumImageListEmpty")):"all_images"===this.type?t.html(this.l10n.t("allImagesEmpty")):"unsorted_images"===this.type&&t.html(this.l10n.t("unsortedImagesEmpty")),this.$el.append(t)}else"table"===this.state.get("listMode")?(this.$el.find(".vls-gf-empty-message").remove(),this.listPanel.show(new u({collection:this.collection}))):(this.$el.find(".vls-gf-empty-message").remove(),this.listPanel.show(new c({collection:this.collection})));this.$el.find(".vls-gf-image-list>ul>li, table>tbody>tr").draggable({delay:100,helper:this._getItemDragHelper.bind(this),cursorAt:{top:20,left:20},appendTo:"body",addClasses:!1,start:this._onItemDragStart.bind(this),stop:this._onItemDragStop.bind(this)})},_getItemDragHelper:function(t){var e=this.collection.selected(),i=[],o=this.albumId;if(0==e.length){var r=s(t.target).closest("li,tr").data("vlsGfImageId");i.push(parseInt(r))}else n.each(e,function(t){i.push(parseInt(t.get("image_id")))});var a=s('<div id="vls-gf-image-drag-helper">'+i.length+"</div>");return a.data("draggedImages",i),a.data("sourceAlbum",o),a},_onItemDragStart:function(t,e){s(t.target).addClass("vls-gf-dragged-image"),s("#vls-gf-layer-primary .vls-gf-nav-panel").addClass("vls-gf-drop-ready")},_onItemDragStop:function(t,e){s(t.target).removeClass("vls-gf-dragged-image"),s("#vls-gf-layer-primary .vls-gf-nav-panel").removeClass("vls-gf-drop-ready")},_updateSelectedCountInfo:function(){var t=this.collection.selected().length;this.ui.txtSelectedImages.html(this.l10n.t("nImagesSelected",t))}});t.exports=h},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div id="vls-gf-album-overview-toolbar-default" class="vls-gf-secondary-toolbar">\r\n\t<ul class="vls-gf-visible">\r\n\t\t<li>\r\n\t\t\t<button data-action="bulk-select" class="vls-gf-icon vls-gf-icon-select-b"\r\n\t\t\t\t\tdata-vls-gf-tooltip="'+(null==(__t=t.tt.activateBulkSelectMode)?"":__t)+'" data-vls-gf-position="below"\r\n\t\t\t\t\tdata-vls-gf-offset="14"></button>\r\n\t\t</li>\r\n\t\t<li>\r\n\t\t\t<button data-action="list-mode-table" class="vls-gf-icon vls-gf-icon-list-b"\r\n\t\t\t\t\tdata-vls-gf-tooltip="'+(null==(__t=t.tt.toggleListMode)?"":__t)+'" data-vls-gf-position="below"\r\n\t\t\t\t\tdata-vls-gf-offset="14"></button>\r\n\t\t\t<button data-action="list-mode-thumbs" class="vls-gf-icon vls-gf-icon-view-comfy-b"\r\n\t\t\t\t\tdata-vls-gf-tooltip="'+(null==(__t=t.tt.toggleListMode)?"":__t)+'" data-vls-gf-position="below"\r\n\t\t\t\t\tdata-vls-gf-offset="14"></button>\r\n\t\t</li>\r\n\t</ul>\r\n</div>\r\n\r\n<div id="vls-gf-album-overview-toolbar-select" class="vls-gf-secondary-toolbar">\r\n         <span>\r\n            <button class="vls-gf-icon vls-gf-icon-close-w" data-vls-gf-tooltip="'+(null==(__t=t.tt.cancelSelection)?"":__t)+'"\r\n\t\t\t\t\tdata-vls-gf-position="below" data-vls-gf-offset="14"></button>\r\n        </span>\r\n\t<h4></h4>\r\n\t<ul class="vls-gf-visible">\r\n\t\t<li>\r\n\t\t\t<button data-action="select-all" class="vls-gf-icon vls-gf-icon-select-all-w"\r\n\t\t\t\t\tdata-vls-gf-tooltip="'+(null==(__t=t.tt.selectAll)?"":__t)+'" data-vls-gf-position="below"\r\n\t\t\t\t\tdata-vls-gf-offset="14"></button>\r\n\t\t</li>\r\n\t\t<li>\r\n\t\t\t<button data-action="select-invert" class="vls-gf-icon vls-gf-icon-select-invert-w"\r\n\t\t\t\t\tdata-vls-gf-tooltip="'+(null==(__t=t.tt.selectInvert)?"":__t)+'" data-vls-gf-position="below"\r\n\t\t\t\t\tdata-vls-gf-offset="14"></button>\r\n\t\t</li>\r\n\t\t<li>\r\n\t\t\t<button data-action="select-none" class="vls-gf-icon vls-gf-icon-select-none-w"\r\n\t\t\t\t\tdata-vls-gf-tooltip="'+(null==(__t=t.tt.selectNone)?"":__t)+'" data-vls-gf-position="below"\r\n\t\t\t\t\tdata-vls-gf-offset="14"></button>\r\n\t\t</li>\r\n\t\t<li class="vls-gf-spaced">\r\n\t\t\t<button data-action="delete-selected" class="vls-gf-icon vls-gf-icon-delete-w"\r\n\t\t\t\t\tdata-vls-gf-tooltip="'+(null==(__t=t.tt.deleteSelected)?"":__t)+'" data-vls-gf-position="below"\r\n\t\t\t\t\tdata-vls-gf-offset="14"></button>\r\n\t\t</li>\r\n\t</ul>\r\n</div>\r\n\r\n<div class="vls-gf-image-list">\r\n</div>\r\n\r\n<div class="vls-gf-clear">\r\n</div>\r\n';return __p}},function(t,e,i){"use strict";var n=i(3),s=n.Model.extend({defaults:{listMode:"grid",sortBy:"none",sortOrder:"asc"}});t.exports=s},function(t,e,i){var n=i(5),s=i(3),o=i(47),r=s.Collection.extend({model:o,url:"image_collection",initialize:function(t,e){this.type=e.type||"all_images",this.sortAttribute="id",this.sortOrder="asc"},fetch:function(t){t=t?t:{},t=n.extend(t,{data:{collection_type:this.type,view:"list_item"}}),s.Collection.prototype.fetch.call(this,t)},comparator:function(t){var e=this.sortAttribute;return t.get(e)},sortByAttribute:function(t,e){this.comparator=function(e){return e.get(t)},"desc"===e?(this.sort({silent:!0}),this.models=this.models.reverse(),this.trigger("sort",this)):this.sort()},selected:function(){return this.filter(function(t){return t.get("selected")})}});t.exports=r},function(t,e,i){"use strict";var n=i(17),s=n.extend({url:"image",parse:function(t){return t.type="image_entity",t.order_no=0,t.image_id=t.id,t},toJSON:function(){var t=n.prototype.toJSON.call(this);return t.file_size_kb=t.file_size?Math.round(t.file_size/1024):0,t}});t.exports=s},function(t,e,i){var n=i(49),s=i(50),o=n.extend({tagName:"ul",childView:s});t.exports=o},function(t,e,i){"use strict";var n=i(8),s=i(13),o=i(22),r=n.CollectionView.extend({l10n:o,radio:s});t.exports=r},function(t,e,i){var n=i(40),s=(i(13),i(51)),o=n.extend({tagName:"li",template:s,events:{mousedown:"onBodyMousedown",click:"onBodyClick",touchstart:"onBodyClick",dblclick:"onBodyDoubleClick"},modelEvents:{"change:selected":"onChangeSelected"},initialize:function(t){this.isActive=!1,this.isSelectMode=!1,this.listenTo(this.radio,"manager:content:itemActivated",this.onItemActivated),this.listenTo(this.radio,"manager:content:bulkSelectModeActivated",this.onBulkSelectModeActivated),this.listenTo(this.radio,"manager:content:bulkSelectModeDeactivated",this.onBulkSelectModeDeactivated)},onRender:function(){var t=this.model.get("image_id");this.$el.data("vlsGfImageId",t)},onBodyMousedown:function(t){this.isSelectMode&&t.shiftKey&&t.preventDefault()},onBodyClick:function(t){return this.isSelectMode?this.toggleSelection(t):(this.isActive=!0,this.$el.addClass("vls-gf-active"),this.radio.trigger("manager:content:itemActivated",{type:"image",id:this.model.get("id"),imageId:this.model.get("image_id")})),!1},onBodyDoubleClick:function(t){t.preventDefault();var e={view:"image",id:this.model.get("image_id"),name:this.model.get("name")};"image"===this.model.get("type")&&(e.nodeId=this.model.get("id")),this.radio.trigger("global:requestRoute",e)},toggleSelection:function(t){var e=!this.model.get("selected");this.model.set("selected",e),this.triggerMethod("selection:toggle",{shiftKey:t.shiftKey,selected:e})},onItemActivated:function(t){this.isActive&&this.model.get("imageId")!==t.id&&(this.isActive=!1,this.$el.removeClass("vls-gf-active"))},onBulkSelectModeActivated:function(t){this.isSelectMode=!0,this.$el.addClass("vls-gf-selectable")},onBulkSelectModeDeactivated:function(t){this.isSelectMode=!1,this.$el.removeClass("vls-gf-selectable")},onChangeSelected:function(){var t=this.model.get("selected");t?this.$el.addClass("vls-gf-selected"):this.$el.removeClass("vls-gf-selected")}});t.exports=o},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<img src="'+(null==(__t=icon_url)?"":__t)+'">\r\n<i></i>';return __p}},function(t,e,i){var n=i(26),s=i(53),o=i(54),r=n.extend({tagName:"table",className:"vls-gf-table",reorderOnSort:!0,template:s,templateHelpers:function(){return{t:{name:this.l10n.t("name"),caption:this.l10n.t("caption"),description:this.l10n.t("description"),creationDate:this.l10n.t("creationDate"),fileName:this.l10n.t("fileName"),fileSize:this.l10n.t("fileSize")}}},childView:o,childViewContainer:">tbody",ui:{headers:"thead tr th"},events:{"click @ui.headers":"sortBy"},sortBy:function(t){var e=this.$(t.target).data("name");if(e){var i="desc"===this.sortOrder?"desc":"asc";i=this.sortAttribute&&this.sortAttribute===e&&"asc"===i?"desc":"asc",this.sortAttribute=e,this.sortOrder=i,this.$el.find("thead tr th").removeClass("vls-gf-sorted-asc vls-gf-sorted-desc"),this.$el.find('thead tr th[data-name="'+e+'"]').addClass("vls-gf-sorted-"+i),this.collection.sortByAttribute(e,i)}}});t.exports=r},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<thead>\r\n<tr>\r\n\t<th></th>\r\n\t<th></th>\r\n\t<th data-name="name"><i></i>'+(null==(__t=t.name)?"":__t)+'</th>\r\n\t<th data-name="caption"><i></i>'+(null==(__t=t.caption)?"":__t)+'</th>\r\n\t<th data-name="description"><i></i>'+(null==(__t=t.description)?"":__t)+'</th>\r\n\t<th data-name="filename"><i></i>'+(null==(__t=t.fileName)?"":__t)+'</th>\r\n\t<th data-name="created"><i></i>'+(null==(__t=t.creationDate)?"":__t)+'</th>\r\n\t<th data-name="file_size"><i></i>'+(null==(__t=t.fileSize)?"":__t)+"</th>\r\n</tr>\r\n</thead>\r\n<tbody></tbody>";return __p}},function(t,e,i){var n=i(40),s=i(41),o=i(55),r=n.extend({tagName:"tr",template:o,behaviors:{editableTableCell:{behaviorClass:s}},ui:{selectCheckbox:".vls-gf-checkbox",name:"td:nth-child(3)>div"},events:{mousedown:"onBodyMousedown",click:"onBodyClick",touchstart:"onBodyClick",dblclick:"onBodyDoubleClick","mousedown @ui.selectCheckbox":"onSelectCheckboxMousedown","click @ui.selectCheckbox":"onSelectCheckboxClick","click @ui.name":"onNameClick"},modelEvents:{"change:selected":"onChangeSelected"},initialize:function(t){this.isActive=!1,this.isSelectMode=!1,this.inlineEditMode=!1,this.listenTo(this.radio,"manager:content:itemActivated",this.onItemActivated),this.listenTo(this.radio,"manager:content:bulkSelectModeActivated",this.onBulkSelectModeActivated),this.listenTo(this.radio,"manager:content:bulkSelectModeDeactivated",this.onBulkSelectModeDeactivated)},onRender:function(){var t=this.model.get("image_id");this.$el.data("vlsGfImageId",t);
},onBodyMousedown:function(t){this.isSelectMode&&t.shiftKey&&t.preventDefault()},onBodyClick:function(t){this.isSelectMode?this.toggleSelection(t):(this.isActive=!0,this.$el.addClass("vls-gf-active"),this.radio.trigger("manager:content:itemActivated",{type:this.model.get("type"),id:this.model.get("id"),imageId:this.model.get("image_id")}))},onBodyDoubleClick:function(t){t.preventDefault();var e={view:"image",id:this.model.get("image_id"),name:this.model.get("name")};"image"===this.model.get("type")&&(e.node_id=this.model.get("id")),this.radio.trigger("global:requestRoute",e)},onSelectCheckboxMousedown:function(t){t.preventDefault()},onSelectCheckboxClick:function(t){return t.preventDefault(),this.toggleSelection(t),!1},toggleSelection:function(t){var e=!this.model.get("selected");this.model.set("selected",e),this.triggerMethod("selection:toggle",{shiftKey:t.shiftKey,selected:e})},onItemActivated:function(t){this.isActive&&this.model.get("id")!==t.id&&(this.isActive=!1,this.$el.removeClass("vls-gf-active"))},onBulkSelectModeActivated:function(t){this.isSelectMode=!0,this.$el.addClass("vls-gf-selectable")},onBulkSelectModeDeactivated:function(t){this.isSelectMode=!1,this.$el.removeClass("vls-gf-selectable")},onChangeSelected:function(){var t=this.model.get("selected");t?(this.$el.addClass("vls-gf-selected"),this.ui.selectCheckbox.addClass("vls-gf-checked")):(this.$el.removeClass("vls-gf-selected"),this.ui.selectCheckbox.removeClass("vls-gf-checked"))}});t.exports=r},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<td>\r\n\t<div class="vls-gf-checkbox"></div>\r\n</td>\r\n<td><img src="'+(null==(__t=icon_url)?"":__t)+'"></td>\r\n<td>\r\n\t<div class="vls-gf-editable" data-attr="name">'+(null==(__t=name)?"":__t)+'</div>\r\n</td>\r\n<td>\r\n\t<div class="vls-gf-editable" data-attr="caption">'+(null==(__t=caption)?"":__t)+'</div>\r\n</td>\r\n<td>\r\n\t<div class="vls-gf-editable" data-attr="description">'+(null==(__t=description)?"":__t)+"</div>\r\n</td>\r\n<td>"+(null==(__t=filename)?"":__t)+"</td>\r\n<td>"+(null==(__t=created)?"":__t)+"</td>\r\n<td>"+(null==(__t=file_size_kb)?"":__t)+" kB</td>";return __p}},function(t,e,i){"use strict";var n=i(17),s=n.extend({url:"folder",api_view:"summary"});t.exports=s},function(t,e,i){var n=i(40),s=i(58),o=n.extend({className:"vls-gf-view-folder-summary",template:'<div><div class="vls-gf-progress-lin-ind"></div></div>',templateHelpers:function(){return{t:{name:this.l10n.t("name"),caption:this.l10n.t("caption"),description:this.l10n.t("description")}}},ui:{},modelEvents:{sync:"renderLoaded"},initialize:function(t){this.listenTo(this.radio,"folder:changed",this.onFolderChanged),this.model.fetch()},renderLoaded:function(){this.template=s,this.render(),this.radio.trigger("global:needAdjustFixedElement",{})},onFolderChanged:function(t){var e=t.model;this.model.get("id")==e.get("id")&&(this.model.set("name",e.get("name")),e.get("caption")&&this.model.set("caption",e.get("caption")),e.get("description")&&this.model.set("description",e.get("description")),e.get("cover_url")&&this.model.set("cover_url",e.get("cover_url")),this.render())}});t.exports=o},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="vls-gf-scroll-scroller">\r\n\t<div class="vls-gf-content">\r\n\t\t\r\n\t\t<img src="'+(null==(__t=cover_url)?"":__t)+'">\r\n\t\t\r\n\t\t<div class="vls-gf-form">\r\n\t\t\t<h4>'+(null==(__t=name)?"":__t)+'</h4>\r\n\t\t\t<div class="vls-gf-field-ro">\r\n\t\t\t\t<span>'+(null==(__t=t.caption)?"":__t)+"</span>\r\n\t\t\t\t<span>"+(null==(__t=caption)?"":__t)+'</span>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t<div class="vls-gf-field-ro vls-gf-ml">\r\n\t\t\t\t<span>'+(null==(__t=t.description)?"":__t)+"</span>\r\n\t\t\t\t<span>"+(null==(__t=description)?"":__t)+'</span>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\r\n\t</div>\r\n\t<div class="vls-gf-scroll-bar"></div>\r\n</div>';return __p}},function(t,e,i){"use strict";var n=i(17),s=n.extend({url:"folder",api_view:"summary"});t.exports=s},function(t,e,i){var n=i(40),s=i(61),o=n.extend({className:"vls-gf-view-album-summary",template:'<div><div class="vls-gf-progress-lin-ind"></div></div>',templateHelpers:function(){return{t:{name:this.l10n.t("name"),caption:this.l10n.t("caption"),description:this.l10n.t("description")}}},ui:{},modelEvents:{sync:"renderLoaded"},initialize:function(t){this.listenTo(this.radio,"album:changed",this.onAlbumChanged),this.model.fetch()},renderLoaded:function(){this.template=s,this.render(),this.radio.trigger("global:needAdjustFixedElement",{})},onAlbumChanged:function(t){var e=t.model;this.model.get("id")==e.get("id")&&(this.model.set("name",e.get("name")),e.get("caption")&&this.model.set("caption",e.get("caption")),e.get("description")&&this.model.set("description",e.get("description")),e.get("cover_url")&&this.model.set("cover_url",e.get("cover_url")),this.render())}});t.exports=o},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="vls-gf-scroll-scroller">\r\n\t<div class="vls-gf-content">\r\n\t\t\r\n\t\t<img src="'+(null==(__t=cover_url)?"":__t)+'">\r\n\t\t\r\n\t\t<div class="vls-gf-form">\r\n\t\t\t<h4>'+(null==(__t=name)?"":__t)+'</h4>\r\n\t\t\t\r\n\t\t\t<div class="vls-gf-field-ro">\r\n\t\t\t\t<span>'+(null==(__t=t.caption)?"":__t)+"</span>\r\n\t\t\t\t<span>"+(null==(__t=caption)?"":__t)+'</span>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t<div class="vls-gf-field-ro vls-gf-ml">\r\n\t\t\t\t<span>'+(null==(__t=t.description)?"":__t)+"</span>\r\n\t\t\t\t<span>"+(null==(__t=description)?"":__t)+'</span>\r\n\t\t\t</div>\r\n\t\t\r\n\t\t</div>\r\n\t\r\n\t</div>\r\n\t<div class="vls-gf-scroll-bar"></div>\r\n</div>\r\n';return __p}},function(t,e,i){"use strict";var n=i(17),s=n.extend({url:"image",api_view:"summary",toJSON:function(){var t=n.prototype.toJSON.call(this);if(t.file_size_kb=Math.round(t.file_size/1024),t.image_meta&&t.image_meta.shutter_speed){var e=parseFloat(t.image_meta.shutter_speed);e<1?t.image_meta.shutter_speed_display="1/"+Math.round(1/e):t.image_meta.shutter_speed_display=e}return t}});t.exports=s},function(t,e,i){var n=i(2),s=i(40),o=i(64),r=i(31),a=s.extend({className:"vls-gf-view-image-summary",template:'<div><div class="vls-gf-progress-lin-ind"></div></div>',templateHelpers:function(){return{t:{file:this.l10n.t("file"),exif:this.l10n.t("exif"),name:this.l10n.t("name"),caption:this.l10n.t("caption"),description:this.l10n.t("description"),altText:this.l10n.t("altText"),fileName:this.l10n.t("fileName"),fileSize:this.l10n.t("fileSize"),dimensions:this.l10n.t("dimensions"),uploadDate:this.l10n.t("uploadDate"),camera:this.l10n.t("camera"),lens:this.l10n.t("lens"),focalLength:this.l10n.t("focalLength"),shutterSpeed:this.l10n.t("shutterSpeed"),aperture:this.l10n.t("aperture"),iso:this.l10n.t("iso"),creationDate:this.l10n.t("creationDate")}}},ui:{cover:"> img",btnEdit:"button.vls-gf-icon-edit-h"},events:{"click @ui.btnEdit":"onBtnEditClick"},modelEvents:{sync:"renderLoaded"},initialize:function(t){this.listenTo(this.radio,"image:changed",this.onImageChanged),this.model.fetch()},renderLoaded:function(){this.template=o,this.render(),this.$el.data("baronVId")&&r.call(this.$el).dispose();var t={$:n,scroller:".vls-gf-scroll-scroller",container:".vls-gf-content",bar:".vls-gf-scroll-bar",barOnCls:"vls-gf-bar-on",scrollingCls:"vls-gf-scrolling",cssGuru:!0};r.call(this.$el,t),this.radio.trigger("global:needAdjustFixedElement",{})},onBtnEditClick:function(t){t.preventDefault(),this.radio.trigger("global:requestRoute",{view:"image",id:this.model.get("id"),name:this.model.get("name"),nodeId:this.model.get("node_id")})},onImageChanged:function(t){var e=t.model,i=t.model.get("imageId");i||(i=t.model.get("id")),this.model.get("id")==i&&(e.get("name")&&this.model.set("name",e.get("name")),e.get("caption")&&this.model.set("caption",e.get("caption")),e.get("description")&&this.model.set("description",e.get("description")),this.render())}});t.exports=a},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="vls-gf-scroll-scroller">\r\n\t<div class="vls-gf-content">\r\n\t\t\r\n\t\t<img src="'+(null==(__t=cover_url)?"":__t)+'">\r\n\t\t<button class="vls-gf-btn-icon vls-gf-icon vls-gf-icon-edit-h" data-vls-gf-tooltip="Edit image"\r\n\t\t\t\tdata-vls-gf-position="left"></button>\r\n\t\t<div class="vls-gf-form">\r\n\t\t\t<h4>'+(null==(__t=name)?"":__t)+'</h4>\r\n\t\t\t\r\n\t\t\t<div class="vls-gf-field-ro">\r\n\t\t\t\t<span>'+(null==(__t=t.caption)?"":__t)+"</span>\r\n\t\t\t\t<span>"+(null==(__t=caption)?"":__t)+'</span>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t<div class="vls-gf-field-ro vls-gf-ml">\r\n\t\t\t\t<span>'+(null==(__t=t.description)?"":__t)+"</span>\r\n\t\t\t\t<span>"+(null==(__t=description)?"":__t)+'</span>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t<div class="vls-gf-field-ro">\r\n\t\t\t\t<span>'+(null==(__t=t.altText)?"":__t)+"</span>\r\n\t\t\t\t<span>"+(null==(__t=alt_text)?"":__t)+"</span>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t<h5>"+(null==(__t=t.file)?"":__t)+'</h5>\r\n\t\t\t\r\n\t\t\t<div class="vls-gf-field-ro">\r\n\t\t\t\t<span>'+(null==(__t=t.fileName)?"":__t)+"</span>\r\n\t\t\t\t<span>"+(null==(__t=filename)?"":__t)+'</span>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t<div class="vls-gf-field-ro">\r\n\t\t\t\t<span>'+(null==(__t=t.fileSize)?"":__t)+"</span>\r\n\t\t\t\t<span>"+(null==(__t=file_size_kb)?"":__t)+' kB</span>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t<div class="vls-gf-field-ro">\r\n\t\t\t\t<span>'+(null==(__t=t.dimensions)?"":__t)+"</span>\r\n\t\t\t\t<span>"+(null==(__t=width)?"":__t)+"&times;"+(null==(__t=height)?"":__t)+'</span>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t<div class="vls-gf-field-ro">\r\n\t\t\t\t<span>'+(null==(__t=t.uploadDate)?"":__t)+"</span>\r\n\t\t\t\t<span>"+(null==(__t=created)?"":__t)+"</span>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t<h5>"+(null==(__t=t.exif)?"":__t)+'</h5>\r\n\t\t\t\r\n\t\t\t<div class="vls-gf-field-ro">\r\n\t\t\t\t<span>'+(null==(__t=t.camera)?"":__t)+"</span>\r\n\t\t\t\t<span>"+(null==(__t=image_meta.camera)?"":__t)+'</span>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t<div class="vls-gf-field-ro">\r\n\t\t\t\t<span>'+(null==(__t=t.lens)?"":__t)+"</span>\r\n\t\t\t\t<span>"+(null==(__t=image_meta.lens)?"":__t)+'</span>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t<div class="vls-gf-field-ro">\r\n\t\t\t\t<span>'+(null==(__t=t.focalLength)?"":__t)+"</span>\r\n\t\t\t\t<span>"+(null==(__t=image_meta.focal_length)?"":__t)+'</span>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t<div class="vls-gf-field-ro">\r\n\t\t\t\t<span>'+(null==(__t=t.shutterSpeed)?"":__t)+"</span>\r\n\t\t\t\t<span>"+(null==(__t=image_meta.shutter_speed_display)?"":__t)+'</span>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t<div class="vls-gf-field-ro">\r\n\t\t\t\t<span>'+(null==(__t=t.aperture)?"":__t)+"</span>\r\n\t\t\t\t<span>"+(null==(__t=image_meta.aperture)?"":__t)+'</span>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t<div class="vls-gf-field-ro">\r\n\t\t\t\t<span>'+(null==(__t=t.iso)?"":__t)+"</span>\r\n\t\t\t\t<span>"+(null==(__t=image_meta.iso)?"":__t)+'</span>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t<div class="vls-gf-field-ro">\r\n\t\t\t\t<span>'+(null==(__t=t.creationDate)?"":__t)+"</span>\r\n\t\t\t\t<span>"+(null==(__t=image_meta.creation_date)?"":__t)+'</span>\r\n\t\t\t</div>\r\n\t\t\r\n\t\t</div>\r\n\t\r\n\t</div>\r\n\t<div class="vls-gf-scroll-bar"></div>\r\n</div>';return __p}},function(t,e,i){"use strict";var n=i(3),s=i(17),o=i(66),r=s.extend({url:"folder",api_view:"editor",parse:function(t){return t.items=new o(t.items),t.view_meta=new n.Model(t.view_meta),t.layout_meta=new n.Model(t.layout_meta),t.style_meta=new n.Model(t.style_meta),t},toJSON:function(t){var e=s.prototype.toJSON.call(this,t);return e.items=e.items?e.items.toJSON(t):{},e.view_meta=e.view_meta?e.view_meta.toJSON():{},e.layout_meta=e.layout_meta?e.layout_meta.toJSON():{},e.style_meta=e.style_meta?e.style_meta.toJSON():{},t&&"sync"===t.mode&&delete e.cover_url,e}});t.exports=r},function(t,e,i){"use strict";var n=i(3),s=i(67),o=n.Collection.extend({model:s,comparator:"layout_order_no",initialize:function(t,e){},toCompactedJSON:function(t){return this.map(function(e){return e.toCompactedJSON(t)})}});t.exports=o},function(t,e,i){"use strict";var n=i(5),s=i(3),o=s.Model.extend({setMeta:function(t,e){var i=this.get(t)||{};i=n.extend(i,e),this.set(t,i)},toJSON:function(t){var e=n.clone(this.attributes);return t&&"sync"===t.mode&&(e=n.pick(e,["id","layout_order_no","crop_meta","layout_meta"])),e}});t.exports=o},function(t,e,i){var n=i(21),s=i(69),o=i(70),r=i(72),a=i(88),l=n.extend({className:"vls-gf-view-folder-editor",template:s,templateHelpers:function(){return{t:{tabGeneral:this.l10n.t("tabGeneral"),tabLayout:this.l10n.t("tabLayout"),tabStyle:this.l10n.t("tabStyle"),tabSettings:this.l10n.t("tabSettings"),tt:{saveChanges:this.l10n.t("tooltips.saveChanges")}}}},regions:{content:".vls-gf-content-wrapper"},ui:{header:".vls-gf-fixed-wrapper .vls-gf-primary-toolbar h3",btnBack:".vls-gf-fixed-wrapper .vls-gf-primary-toolbar button.vls-gf-icon-back-w",btnSave:".vls-gf-fixed-wrapper button.vls-gf-fab",btnTabGeneral:'.vls-gf-fixed-wrapper .vls-gf-tab-bar li[data-tab="general"]',btnTabLayout:'.vls-gf-fixed-wrapper .vls-gf-tab-bar li[data-tab="layout"]',btnTabSettings:'.vls-gf-fixed-wrapper .vls-gf-tab-bar li[data-tab="settings"]'},events:{"click @ui.btnBack":"onBtnBack","click @ui.btnSave":"onBtnSave","click @ui.btnTabGeneral":"onBtnTabGeneral","click @ui.btnTabLayout":"onBtnTabLayout","click @ui.btnTabSettings":"onBtnTabSettings"},modelEvents:{sync:"onModelSync","change:name":"onNameChange"},initialize:function(t){this.currentTab="general",this.model.fetch()},onModelSync:function(t,e,i){i.parse&&(this.render(),this._renderTabs())},onBtnBack:function(){this.radio.trigger("global:requestRoute",{view:"manager"})},onBtnSave:function(){this.savingInProgress||(this.savingInProgress=!0,this.ui.btnSave.addClass("vls-gf-in-progress"),this.model.save(null,{parse:!1,patch:!0,success:this.onSaveSuccess.bind(this)}))},onSaveSuccess:function(){this.savingInProgress=!1,this.isDestroyed||this.ui.btnSave.removeClass("vls-gf-in-progress"),this.radio.trigger("dialog:notification:requested",{message:this.l10n.t("albumSaved")}),this.radio.trigger("album:changed",{model:this.model})},onBtnTabGeneral:function(){this.currentTab="general",this._renderTabs()},onBtnTabLayout:function(){this.currentTab="layout",this._renderTabs()},onBtnTabSettings:function(){this.currentTab="settings",this._renderTabs()},onNameChange:function(){this.ui.header.html(this.model.get("name"))},_renderTabs:function(){"general"===this.currentTab?(this.ui.btnTabGeneral.addClass("vls-gf-active"),this.content.show(new o({model:this.model}))):this.ui.btnTabGeneral.removeClass("vls-gf-active"),"layout"===this.currentTab?(this.ui.btnTabLayout.addClass("vls-gf-active"),this.content.show(new r({model:this.model}))):this.ui.btnTabLayout.removeClass("vls-gf-active"),"settings"===this.currentTab?(this.ui.btnTabSettings.addClass("vls-gf-active"),this.content.show(new a({model:this.model}))):this.ui.btnTabSettings.removeClass("vls-gf-active"),this.radio.trigger("global:needAdjustFixedElement",{})}});t.exports=l},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="vls-gf-fixed-wrapper">\r\n\t<div class="vls-gf-primary-toolbar">\r\n        <span>\r\n            <button class="vls-gf-icon vls-gf-icon-back-w"></button>\r\n        </span>\r\n\t\t<h3>'+(null==(__t=name)?"":__t)+'</h3>\r\n\t</div>\r\n\t<div class="vls-gf-tab-bar">\r\n\t\t<ul>\r\n\t\t\t<li data-tab="general"><span>'+(null==(__t=t.tabGeneral)?"":__t)+'</span></li>\r\n\t\t\t<li data-tab="layout"><span>'+(null==(__t=t.tabLayout)?"":__t)+'</span></li>\r\n\t\t\t<li data-tab="settings"><span>'+(null==(__t=t.tabSettings)?"":__t)+'</span></li>\r\n\t\t</ul>\r\n\t</div>\r\n\t<button class="vls-gf-fab vls-gf-icon vls-gf-icon-done-w" data-vls-gf-tooltip="'+(null==(__t=t.tt.saveChanges)?"":__t)+'"\r\n\t\t\tdata-vls-gf-position="below" data-vls-gf-offset="14"></button>\r\n</div>\r\n\r\n<div class="vls-gf-content-wrapper"></div>';return __p}},function(t,e,i){var n=i(40),s=i(71),o=n.extend({className:"vls-gf-view-tab-general",template:s,templateHelpers:function(){return{t:{name:this.l10n.t("name"),slug:this.l10n.t("slug"),caption:this.l10n.t("caption"),description:this.l10n.t("description"),shortcode:this.l10n.t("shortcode"),setCoverImage:this.l10n.t("setCoverImage")}}},ui:{fldName:"#vls-gf-fld-name",fldSlug:"#vls-gf-fld-slug",fldCaption:"#vls-gf-fld-caption",fldDescription:"#vls-gf-fld-description",coverElement:".vls-gf-cover-image",coverImage:".vls-gf-cover-image img"},events:{"change @ui.fldName":"onFldNameChange","change @ui.fldSlug":"onFldSlugChange","change @ui.fldCaption":"onFldCaptionChange","change @ui.fldDescription":"onFldDescriptionChange","click @ui.coverElement":"openSelectionModal"},initialize:function(t){this.listenTo(this.radio,"dialog:selectImage:confirmed",this.onImageSelected)},onFldNameChange:function(){this.model.set("name",this.ui.fldName.val())},onFldSlugChange:function(){this.model.set("slug",this.ui.fldSlug.val())},onFldCaptionChange:function(){this.model.set("caption",this.ui.fldCaption.val())},onFldDescriptionChange:function(){this.model.set("description",this.ui.fldDescription.val())},openSelectionModal:function(){this.radio.trigger("dialog:selectImage:requested",{id:this.model.get("id")})},onImageSelected:function(t){this.model.set({image_id:t.id,cover_url:t.value}),this.ui.coverImage.attr("src",t.value)},serializeData:function(){var t=this.model.toJSON();return t.cover_url||(t.cover_url="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjMyMHB4IiBoZWlnaHQ9IjMyMHB4IiB2aWV3Qm94PSIwIDAgMzIwIDMyMCIgPg0KPHJlY3QgZmlsbD0iI0UyRTJFMiIgd2lkdGg9IjMyMCIgaGVpZ2h0PSIzMjAiLz4NCjxwYXRoIGZpbGw9IiNGM0YzRjMiIGQ9Ik0yNTAsMjMwVjkwYzAtMTEtOS0yMC0yMC0yMEg5MGMtMTEsMC0yMCw5LTIwLDIwdjE0MGMwLDExLDksMjAsMjAsMjBoMTQwQzI0MSwyNTAsMjUwLDI0MSwyNTAsMjMweg0KCSBNMTI1LDE3NWwyNSwzMC4xbDM1LTQ1LjFsNDUsNjBIOTBMMTI1LDE3NXoiLz4NCjwvc3ZnPg=="),t}});t.exports=o},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="vls-gf-main-panel">\r\n\t\r\n\t<div class="vls-gf-right-col">\r\n\t\t\r\n\t\t<div class="vls-gf-cover-image">\r\n\t\t\t<img src="'+(null==(__t=cover_url)?"":__t)+'">\r\n\t\t\t<div>\r\n\t\t\t\t<div>'+(null==(__t=t.setCoverImage)?"":__t)+'</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\r\n\t</div>\r\n\t\r\n\t<div class="vls-gf-left-col">\r\n\t\t<div class="vls-gf-form">\r\n\t\t\t\r\n\t\t\t<div class="vls-gf-row">\r\n\t\t\t\t<div class="vls-gf-col-2">\r\n\t\t\t\t\t<div class="vls-gf-field">\r\n\t\t\t\t\t\t<label for="vls-gf-fld-name">'+(null==(__t=t.name)?"":__t)+'</label>\r\n\t\t\t\t\t\t<input id="vls-gf-fld-name" type="text" value="'+(null==(__t=name)?"":__t)+'"/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class="vls-gf-col-2">\r\n\t\t\t\t\t<div class="vls-gf-field">\r\n\t\t\t\t\t\t<label for="vls-gf-fld-slug">'+(null==(__t=t.slug)?"":__t)+'</label>\r\n\t\t\t\t\t\t<input id="vls-gf-fld-slug" type="text" value="'+(null==(__t=slug)?"":__t)+'"/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t<div class="vls-gf-field">\r\n\t\t\t\t<label for="vls-gf-fld-caption">'+(null==(__t=t.caption)?"":__t)+'</label>\r\n\t\t\t\t<input id="vls-gf-fld-caption" type="text" value="'+(null==(__t=caption)?"":__t)+'"/>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t<div class="vls-gf-field">\r\n\t\t\t\t<label for="vls-gf-fld-description">'+(null==(__t=t.description)?"":__t)+'</label>\r\n\t\t\t\t<textarea id="vls-gf-fld-description">'+(null==(__t=description)?"":__t)+'</textarea>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t<div class="vls-gf-field-ro">\r\n\t\t\t\t<span>'+(null==(__t=t.shortcode)?"":__t)+"</span>\r\n\t\t\t\t<span>[vls_gf_album id=&quot;"+(null==(__t=id)?"":__t)+"&quot;]</span>\r\n\t\t\t</div>\r\n\t\t\r\n\t\t</div>\r\n\t</div>\r\n</div>";return __p}},function(t,e,i){var n=i(8),s=i(13),o=i(73),r=i(74),a=i(85),l=n.LayoutView.extend({className:"vls-gf-view-tab-layout",template:o,regions:{mainPanel:".vls-gf-main-panel",sidePanel:".vls-gf-side-panel"},radio:s,initialize:function(t){},onRender:function(t){},onBeforeShow:function(){this.mainPanel.show(new r({collection:this.model.get("items"),layoutMeta:this.model.get("layout_meta")})),this.sidePanel.show(new a({model:this.model.get("layout_meta")}))}});t.exports=l},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="vls-gf-main-panel">\r\n</div>\r\n<div class="vls-gf-side-panel">\r\n</div>\r\n';return __p}},function(t,e,i){"use strict";var n=i(26),s=i(75),o=i(76),r=i(78),a=i(79),l=i(81),d=i(83),c=n.extend({className:"vls-gf-view-tab-layout-main-panel",sort:!1,template:s,childView:o,childViewContainer:">ul",ui:{btnZoomIn:".vls-gf-secondary-toolbar .vls-gf-icon-zoom-in-b",btnZoomOut:".vls-gf-secondary-toolbar .vls-gf-icon-zoom-out-b",imageList:">ul"},events:{"click @ui.btnZoomIn":"onBtnZoomIn","click @ui.btnZoomOut":"onBtnZoomOut"},state:new r,initialize:function(t){this.layoutMeta=t.layoutMeta,this.childViewOptions={layoutMeta:t.layoutMeta},this.listenTo(this.layoutMeta,"change:layout_type",this.onLayoutTypeChange),this.listenTo(this.radio,"global:windowResize",this.onWindowResize)},onDestroy:function(){this.layoutEditor.destroy(),this.collection.each(function(t){t.set("placement",null,{silent:!0})})},onAttach:function(){this._initLayoutModule();var t=0;this.children.each(function(e){var i=e.$el,n=40*t;setTimeout(function(){i.removeClass("vls-gf-init")},n),t++})},onWindowResize:function(){this._setZoom()},onLayoutTypeChange:function(t){this._initLayoutModule()},onBtnZoomIn:function(){var t=this.state.get("zoom");switch(t){case.75:t=1;break;case.5:t=.75;break;case.25:t=.5;break;case.125:t=.25;break;case.0625:t=.125;break;default:t=1}this._setZoom(t)},onBtnZoomOut:function(){var t=this.state.get("zoom");switch(t){case 1:t=.75;break;case.75:t=.5;break;case.5:t=.25;break;case.25:t=.125;break;case.125:t=.0625;break;default:t=.0625}this._setZoom(t)},_initLayoutModule:function(){this.layoutEditor&&this.layoutEditor.destroy();var t=this.layoutMeta.get("layout_type");if("grid"===t)this.layoutEditor=new a({$el:this.ui.imageList,layoutSettings:this.layoutMeta,items:this.collection});else if("metro"===t)this.layoutEditor=new l({$el:this.ui.imageList,layoutSettings:this.layoutMeta,items:this.collection});else{if("masonry-v"!==t)return void console.log("Unknown layout type");this.layoutEditor=new d({$el:this.ui.imageList,layoutSettings:this.layoutMeta,items:this.collection})}this._setZoom()},_setZoom:function(t){var e=this.state;switch(t||(t=e.get("zoom")),e.set({zoom:t}),this.layoutEditor.setZoom(t),this.layoutEditor.updateLayout(),this.ui.imageList.removeClass("vls-gf-zoom-1 vls-gf-zoom-2 vls-gf-zoom-3 vls-gf-zoom-4 vls-gf-zoom-5 vls-gf-zoom-6"),t){case 1:this.ui.imageList.addClass("vls-gf-zoom-1");break;case.75:this.ui.imageList.addClass("vls-gf-zoom-2");break;case.5:this.ui.imageList.addClass("vls-gf-zoom-3");break;case.25:this.ui.imageList.addClass("vls-gf-zoom-4");break;case.125:this.ui.imageList.addClass("vls-gf-zoom-5");break;case.0625:this.ui.imageList.addClass("vls-gf-zoom-6")}1===t?this.ui.btnZoomIn.addClass("vls-gf-disabled"):this.ui.btnZoomIn.removeClass("vls-gf-disabled"),.0625===t?this.ui.btnZoomOut.addClass("vls-gf-disabled"):this.ui.btnZoomOut.removeClass("vls-gf-disabled")}});t.exports=c},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="vls-gf-secondary-toolbar">\r\n\t<ul class="vls-gf-visible">\r\n\t\t<li>\r\n\t\t\t<button class="vls-gf-icon vls-gf-icon-zoom-in-b"></button>\r\n\t\t</li>\r\n\t\t<li>\r\n\t\t\t<button class="vls-gf-icon vls-gf-icon-zoom-out-b"></button>\r\n\t\t</li>\r\n\t\t<li style="display:none;">\r\n\t\t\t<button id="vls-gf-btn-toggle-pin-layout" class="vls-gf-icon vls-gf-icon-pin-b"></button>\r\n\t\t</li>\r\n\t</ul>\r\n</div>\r\n<ul></ul>\r\n\r\n';return __p}},function(t,e,i){var n=i(8),s=i(13),o=i(77),r=n.ItemView.extend({template:o,ui:{},events:{click:"onElementClick"},modelEvents:{"change:placement":"onPlacementChange","change:crop_meta":"onCropChange","change:layout_order_no":"onLayoutOrderNoChange"},radio:s,initialize:function(t){this.layoutMeta=t.layoutMeta},onRender:function(){this.$el=this.$el.children(),this.$el.unwrap(),this.setElement(this.$el);for(var t=1;t<=8;t++)this.$el.append('<span class="vls-gf-resize-helper"></span>')},onPlacementChange:function(){var t=this.model.get("placement");this.$el.css({width:t.width+"px",height:t.height+"px",top:t.top+"px",left:t.left+"px"})},onCropChange:function(){var t=this,e=this.model.get("crop_meta"),i=this.model.get("image_width"),n=this.model.get("image_height");if(e.top||e.left||e.width||e.height){var s=e.top||0,o=e.left||0,r=e.width||i-o,a=e.height||n-s,l=new Image,d=this.model.get("url");if(!d)return;l.onload=function(){t.updateThumbnailCrop(this,s,o,r,a)},l.src=d,this.model.set("thumbnail_width",r),this.model.set("thumbnail_height",a)}else this.$el.css({"background-image":"url("+this.model.get("thumbnail_url")+")"}),this.model.set("thumbnail_width",i),this.model.set("thumbnail_height",n);this.model.trigger("change:thumbnail_size")},onLayoutOrderNoChange:function(){this.$(".vls-gf-order-no").html(this.model.get("layout_order_no"))},onElementClick:function(t){this.$el.hasClass("vls-gf-no-click")||this.radio.trigger("dialog:cropper:requested",{item:this.model})},updateThumbnailCrop:function(t,e,i,n,s){var o=document.createElement("canvas"),r=o.getContext("2d");o.width=n,o.height=s,r.drawImage(t,i,e,n,s,0,0,n,s);var a=o.toDataURL("image/jpeg",.9);this.$el.css({"background-image":"url("+a+")"})}});t.exports=r},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<li class="vls-gf-init" data-id="'+(null==(__t=id)?"":__t)+'" style="background-image:url('+(null==(__t=thumbnail_url)?"":__t)+')"></li>\r\n';return __p}},function(t,e,i){"use strict";var n=i(3),s=n.Model.extend({defaults:{zoom:1,pinLayout:!1}});t.exports=s},function(t,e,i){var n=i(5),s=i(2),o=i(8),r=i(80),a=o.Object.extend({initialize:function(t){this.$el=t.$el,this.pageDividers=[],this.layoutSettingsModel=t.layoutSettings,this.layoutSettings=this.layoutSettingsModel.toJSON(),this.items=t.items,this.calculator=new r(this.getDraggedItemPosition.bind(this)),this.listenTo(this.layoutSettingsModel,"change",this.onLayoutSettingsChange),this.$el.find(">li").draggable({scroll:!0,cursor:"move",addClasses:!1,start:this.dragStart.bind(this),drag:n.throttle(this.dragUpdate.bind(this),100),stop:this.dragStop.bind(this)})},onDestroy:function(){var t=this.$el.find(">li");t.draggable("destroy")},onLayoutSettingsChange:function(){this.layoutSettings=this.layoutSettingsModel.toJSON(),this._zoomSpacings(),this.updateLayout()},setZoom:function(t){var e=this.$el.width();this.zoom=t,this.layoutWidth=Math.floor(e*t),this.layoutOffset=Math.floor((e-this.layoutWidth)/2),this._zoomSpacings()},updateLayout:function(){var t=this.layoutSettings;t.container_width=this.layoutWidth;var e=this._getItemList();this.layoutPages=this.calculator.exec(e,t),this._placeItems()},dragStart:function(t,e){var i=parseInt(s(t.currentTarget).data("id")),n=this.items.get(i),o=n.get("placement");n.set("placement",null,{silent:!0});var r=this.layoutSettings;r.container_width=this.layoutWidth;var a=this.calculator.getColumns(r),l=a[0].width,d=Math.floor(a[0].width/r.aspect_ratio);this.dragState={id:i,itemWidth:o.width,itemHeight:o.height,imageWidth:n.get("width"),imageHeight:n.get("height"),columnWidth:l,rowHeight:d,columns:a,position:{}};var c=this._calculateNewMovePosition(e);this.dragState.position.page=c.page,this.dragState.position.col=c.col,this.dragState.position.row=c.row,this.imageDropHelper=s('<div class="vls-gf-drop-helper"></div>'),this.$el.append(this.imageDropHelper),this._placeDropHelper()},dragUpdate:function(t,e){var i=this.dragState;if(i){var n=this._calculateNewMovePosition(e);i.position.page===n.page&&i.position.col===n.col&&i.position.row===n.row||(i.position.page=n.page,i.position.col=n.col,i.position.row=n.row,this._placeDropHelper(),this.updateLayout())}},dragStop:function(t){this.layoutPages&&this._updateItemsOrder(this.layoutPages),this.imageDropHelper.remove(),delete this.dragState,delete this.imageDropHelper,this.updateLayout(),delete this.layoutItems;var e=s(t.target);e.addClass("vls-gf-no-click"),setTimeout(function(){e.removeClass("vls-gf-no-click")},100)},getDraggedItemPosition:function(){var t=this.dragState;return!!t&&{page:t.position.page,col:t.position.col,row:t.position.row}},_zoomSpacings:function(){this.layoutSettings.horizontal_spacing=Math.ceil(this.layoutSettingsModel.get("horizontal_spacing")*this.zoom),this.layoutSettings.vertical_spacing=Math.ceil(this.layoutSettingsModel.get("vertical_spacing")*this.zoom)},_getItemList:function(){var t=this.dragState?this.dragState.id:0,e=[];return this.items.each(function(i){e.push({id:i.id,width:i.get("thumbnail_width"),height:i.get("thumbnail_height"),params:i.get("layout_meta"),isDragged:t===i.id,placement:{}})}),e},_calculateNewMovePosition:function(t){for(var e=t.position.top,i=t.position.left,n=this.layoutSettings,s=n.horizontal_spacing,o=n.vertical_spacing,r=n.column_count,a=n.page_size,l=this.dragState,d=l.rowHeight,c=l.columnWidth,u=l.columns,h=1,g=0,p=0,f=0,v=i+Math.floor(.5*c),m=0;m<u.length;m++)v>=u[m].left-Math.floor(s/2)+this.layoutOffset&&(p=m);p<0?p=0:p>r&&(p=r);var _=e+Math.floor(.5*d);for(m=0;m<this.layoutPages.length;m++){var b=this.layoutPages[m];if(!(b.vertOffset<_))break;h=b.no,g=b.vertOffset}return f=Math.floor((_-g+Math.floor(o/2))/(d+o)),f<0&&(f=0),a>0&&f>a-1&&(f=a-1),{page:h,col:p,row:f}},_placeDropHelper:function(){var t=this.layoutSettings,e=t.vertical_spacing,i=this.dragState,n=i.columns,s=i.rowHeight,o=this.layoutPages[i.position.page-1].vertOffset,r=n[i.position.col].width,a=s,l=o+(s+e)*i.position.row,d=n[i.position.col].left+this.layoutOffset;this.imageDropHelper.css({width:r,height:a,top:l,left:d})},_placeItems:function(){var t,e=this.items,i=this.layoutOffset,s=0;n.each(this.layoutPages[0].items,function(n){var o=e.get(n.id);n.placement.left+=i,o.set("placement",n.placement),t=n.placement.top+n.placement.height,s<t&&(s=t)}),this.$el.css("height",s+this.layoutSettings.vertical_spacing+600)},_updateItemsOrder:function(t){var e,i=this.items,s=0;n.each(t,function(t){e=t.items,e.sort(function(t,e){return t.placement.row<e.placement.row?-1:t.placement.row>e.placement.row?1:t.placement.col<e.placement.col?-1:t.placement.col>e.placement.col?1:0}),n.each(e,function(t){var e=i.get(t.id);e.set("layout_order_no",s+1),s++})}),this.items.sort()}});t.exports=a},function(t,e){var i=function(t){this.getDraggedItemPosition=t};i.prototype={exec:function(t,e){var i,n,s,o,r,a,l,d=e.aspect_ratio,c=e.vertical_spacing,u=0,h=this.getColumns(e),g=h.length,p=Math.floor(h[0].width/d),f=0,v=0,m=function(){f++,f>=g&&(f=0,v++)};if(this.getDraggedItemPosition)for(l=this.getDraggedItemPosition(),i=0;i<t.length;i++)n=t[i],n.isDragged&&(n.placement.col=l.col,n.placement.row=(l.page-1)*u+l.row);for(i=0;i<t.length;i++)n=t[i],n.isDragged||(l&&l.col===f&&(l.page-1)*u+l.row===v?(i--,m()):(s=h[f].width,o=p,a=(p+c)*v,r=h[f].left,n.placement={
width:s,height:o,top:a,left:r,col:f,row:v},m()));return[{no:1,vertOffset:0,items:t}]},getColumns:function(t){var e,i=t.horizontal_spacing,n=t.container_width,s="xs"===t.screen_size?1:t.column_count,o=[],r=n-i*(s-1),a=Math.floor(r/s),l=r-a*s,d=0;for(e=0;e<s;e++){var c=0;l>0&&(c=1,l--),o[e]={width:a+c,left:d},d+=a+i+c}return o}},t.exports=i},function(t,e,i){var n=i(5),s=i(2),o=i(8),r=i(82),a=o.Object.extend({initialize:function(t){this.$el=t.$el,this.layoutSettingsModel=t.layoutSettings,this.layoutSettings=this.layoutSettingsModel.toJSON(),this.items=t.items,this.calculator=new r(this.getDraggedItemCells.bind(this)),this.listenTo(this.layoutSettingsModel,"change",this.onLayoutSettingsChange),this.$el.find(">li").draggable({scroll:!0,cursor:"move",addClasses:!1,start:this.dragStart.bind(this),drag:n.throttle(this.dragUpdate.bind(this),100),stop:this.dragStop.bind(this)}),this.$el.find(">li").resizable({handles:"all",autoHide:!1,minHeight:43,minWidth:43,start:this.dragStart.bind(this),resize:n.throttle(this.dragUpdate.bind(this),100),stop:this.dragStop.bind(this)})},onDestroy:function(){var t=this.$el.find(">li");t.draggable("destroy"),t.resizable("destroy"),this.$el.find(".vls-gf-page-divider").remove()},onLayoutSettingsChange:function(){this.layoutSettings=this.layoutSettingsModel.toJSON(),this._zoomSpacings(),this.updateLayout()},setZoom:function(t){var e=this.$el.width();this.zoom=t,this.layoutWidth=Math.floor(e*t),this.layoutOffset=Math.floor((e-this.layoutWidth)/2),this._zoomSpacings()},updateLayout:function(){var t=this.layoutSettings;t.container_width=this.layoutWidth;var e=this._getItemList();this.layoutPages=this.calculator.exec(e,t),this._placeItems()},dragStart:function(t,e){var i=e.size?"resize":"move",n=parseInt(s(t.currentTarget).data("id")),o=this.items.get(n),r=o.get("placement"),a=o.get("layout_meta");o.set("placement",null,{silent:!0});var l=this.layoutSettings;l.container_width=this.layoutWidth;var d=this.calculator.getColumns(l),c=d[0].width,u=Math.floor(d[0].width/l.aspect_ratio),h=l.column_count,g=a.h_span||1;g=g<h?g:h;var p=a.v_span||1;this.dragState={action:i,id:n,itemWidth:r.width,itemHeight:r.height,imageWidth:o.get("width"),imageHeight:o.get("height"),columnWidth:c,rowHeight:u,columns:d,origHSpan:g,origVSpan:p,position:{hSpan:g,vSpan:p}};var f;f="move"===i?this._calculateNewMovePosition(e):this._calculateNewMovePosition(e),this.dragState.position.page=f.page,this.dragState.position.col=f.col,this.dragState.position.row=f.row,this.imageDropHelper=s('<div class="vls-gf-drop-helper"></div>'),this.$el.append(this.imageDropHelper),this._placeDropHelper()},dragUpdate:function(t,e){var i=this.dragState;if(i){var n,s=i.action;this.layoutSettings.page_size;n="move"===s?this._calculateNewMovePosition(e):this._calculateNewResizePosition(e),i.position.page===n.page&&i.position.col===n.col&&i.position.row===n.row&&i.position.hSpan===n.hSpan&&i.position.vSpan===n.vSpan||(i.position.page=n.page,i.position.col=n.col,i.position.row=n.row,i.position.hSpan=n.hSpan,i.position.vSpan=n.vSpan,this._placeDropHelper(),this.updateLayout())}},dragStop:function(t){var e=this.dragState,i=this.items.get(e.id),n={h_span:e.position.hSpan,v_span:e.position.vSpan};i.set("layout_meta",n),this.layoutPages&&this._updateItemsOrder(this.layoutPages),this.imageDropHelper.remove(),delete this.dragState,delete this.imageDropHelper,this.updateLayout();var o=s(t.target);o.addClass("vls-gf-no-click"),setTimeout(function(){o.removeClass("vls-gf-no-click")},100)},getDraggedItemCells:function(){var t=this.dragState;return!!t&&{page:t.position.page,col:t.position.col,row:t.position.row,hSpan:t.position.hSpan,vSpan:t.position.vSpan}},_zoomSpacings:function(){this.layoutSettings.horizontal_spacing=Math.ceil(this.layoutSettingsModel.get("horizontal_spacing")*this.zoom),this.layoutSettings.vertical_spacing=Math.ceil(this.layoutSettingsModel.get("vertical_spacing")*this.zoom)},_getItemList:function(){var t,e=this.dragState?this.dragState.id:0,i=[];return this.items.each(function(n){t=n.get("layout_meta"),i.push({id:n.id,width:n.get("thumbnail_width"),height:n.get("thumbnail_height"),params:{h_span:t?parseInt(t.h_span):1,v_span:t?parseInt(t.v_span):1},isDragged:e===n.id,placement:{}})}),i},_calculateNewMovePosition:function(t){var e,i=t.position.top,n=t.position.left,s=this.layoutSettings,o=s.horizontal_spacing,r=s.vertical_spacing,a=s.column_count,l=s.page_size,d=this.dragState,c=d.rowHeight,u=d.columnWidth,h=d.columns,g=d.position.hSpan,p=d.origVSpan,f=1,v=0,m=0,_=0;g=g<a?g:a;var b=n+Math.floor(.5*u);for(m=0,e=0;e<h.length;e++)b>=h[e].left-Math.floor(o/2)+this.layoutOffset&&(m=e);m<0?m=0:m+g>a&&(m=a-g);var y=i+Math.floor(.5*c);for(e=0;e<this.layoutPages.length;e++){var w=this.layoutPages[e];if(!(w.vertOffset<y))break;f=w.no,v=w.vertOffset}return _=Math.floor((y-v+Math.floor(r/2))/(c+r)),_<0&&(_=0),l>0&&(_>l-1&&(_=l-1),_+p>l&&(p=l-_)),{page:f,hSpan:g,vSpan:p,col:m,row:_}},_calculateNewResizePosition:function(t){var e,i,n,s,o=this.layoutSettings,r=o.horizontal_spacing,a=o.vertical_spacing,l=o.column_count,d=o.page_size,c=this.dragState,u=c.columnWidth,h=c.rowHeight,g=Math.floor(.2*u-.5*r);e=Math.floor((t.size.width-g)/(u+r))+1,e=e<1?1:e,t.originalPosition.left===t.position.left?(n=c.position.col,n+e>l&&(e=l-n)):(c.position.col+c.position.hSpan-e<0&&(e=c.position.col+c.position.hSpan),n=c.position.col+c.position.hSpan-e);var p=Math.floor(.2*h-.5*a);return i=Math.floor((t.size.height-p)/(h+a))+1,i=i<1?1:i,t.originalPosition.top===t.position.top?(s=c.position.row,d>0&&s+i>d&&(i=d-s)):(c.position.row+c.position.vSpan-i<0&&(i=c.position.row+c.position.vSpan),s=c.position.row+c.position.vSpan-i,s=s<0?0:s),{page:c.position.page,hSpan:e,vSpan:i,col:n,row:s}},_placeDropHelper:function(){for(var t=this.layoutSettings,e=t.horizontal_spacing,i=t.vertical_spacing,n=this.dragState,s=n.columns,o=n.rowHeight,r=this.layoutPages[n.position.page-1].vertOffset,a=0,l=n.position.col;l<n.position.col+n.position.hSpan;l++)a+=s[l].width;a+=e*(n.position.hSpan-1);var d=o*n.position.vSpan+i*(n.position.vSpan-1),c=r+(o+i)*n.position.row,u=s[n.position.col].left+this.layoutOffset;this.imageDropHelper.css({width:a,height:d,top:c,left:u})},_placeItems:function(){var t,e=this.layoutPages[0],i=this.items,s=this.layoutOffset,o=0;n.each(e.items,function(e){var n=i.get(e.id);e.placement.left+=s,n.set("placement",e.placement),t=e.placement.top+e.placement.height,o<t&&(o=t)}),this.$el.css("height",o+this.layoutSettings.vertical_spacing+600)},_updateItemsOrder:function(t){var e,i=this.items,s=0;n.each(t,function(t){e=t.items,e.sort(function(t,e){return t.placement.row<e.placement.row?-1:t.placement.row>e.placement.row?1:t.placement.col<e.placement.col?-1:t.placement.col>e.placement.col?1:0}),n.each(e,function(t){var e=i.get(t.id);e.set("layout_order_no",s+1),s++})}),this.items.sort()}});t.exports=a},function(t,e){function i(t,e,i){var n,s=t.length;for(n=0;n<s;n++){var o=t[n];if(o.col===e&&o.row===i)return!0}return!1}function n(t,e,i,n,s){var o,r;for(o=0;o<e;o++)for(r=0;r<i;r++)t.push({col:n+o,row:s+r})}var s=function(t){this.getDraggedItemCells=t};s.prototype={exec:function(t,e){var s,o,r,a,l,d,c,u,h,g=e.aspect_ratio,p=e.horizontal_spacing,f=e.vertical_spacing,v=this.getColumns(e),m=v.length,_=Math.floor(v[0].width/g),b=[],y={col:0,row:0},w={col:0,row:0};if(this.getDraggedItemCells&&(h=this.getDraggedItemCells()))for(n(b,h.hSpan,h.vSpan,h.col,h.row),s=0;s<t.length;s++)x=t[s],x.isDragged&&(x.placement.hSpan=h.hSpan,x.placement.vSpan=h.vSpan,x.placement.col=h.col,x.placement.row=h.row);for(s=0;s<t.length;s++){var x=t[s];if(!x.isDragged){var M=x.params,C=M.h_span?parseInt(M.h_span):1,S=M.v_span?parseInt(M.v_span):1;for("xs"===e.screen_size&&(C=1,S=1),C=C>m?m:C,a=!1,w={col:y.col,row:y.row};!a;){if(a=!0,w.col+C>m&&(a=!1),a)for(o=0;o<C;o++)for(r=0;r<S;r++)(w.col+o>=m||i(b,w.col+o,w.row+r))&&(a=!1);a||(w.col++,w.col>=m&&(w.col=0,w.row++))}for(n(b,C,S,w.col,w.row),l=0,o=w.col;o<w.col+C;o++)l+=v[o].width;for(l+=p*(C-1),d=_*S+f*(S-1),u=(_+f)*w.row,c=v[w.col].left,x.placement={width:l,height:d,top:u,left:c,col:w.col,row:w.row},a=!1;!a;)i(b,y.col,y.row)?(y.col++,y.col>=m&&(y.col=0,y.row++)):a=!0}}return[{no:1,vertOffset:0,items:t}]},getColumns:function(t){var e,i=t.horizontal_spacing,n=t.container_width,s="xs"===t.screen_size?1:t.column_count,o=[],r=n-i*(s-1),a=Math.floor(r/s),l=r-a*s,d=0;for(e=0;e<s;e++){var c=0;l>0&&(c=1,l--),o[e]={width:a+c,left:d},d+=a+i+c}return o}},t.exports=s},function(t,e,i){var n=i(5),s=i(2),o=i(8),r=i(84),a=56,l=o.Object.extend({initialize:function(t){this.$el=t.$el,this.layoutSettingsModel=t.layoutSettings,this.layoutSettings=this.layoutSettingsModel.toJSON(),this.items=t.items,this.calculator=new r(this.calculatorCallback.bind(this)),this.listenTo(this.layoutSettingsModel,"change",this.onLayoutSettingsChange),this.listenTo(this.items,"change:thumbnail_size",this.updateLayout),this.$el.find(">li").draggable({scroll:!0,cursor:"move",addClasses:!1,start:this.dragStart.bind(this),drag:n.throttle(this.dragUpdate.bind(this),100),stop:this.dragStop.bind(this)})},onDestroy:function(){this.$el.find(">li").draggable("destroy")},onLayoutSettingsChange:function(){this.layoutSettings=this.layoutSettingsModel.toJSON(),this._zoomSpacings(),this.updateLayout()},setZoom:function(t){var e=this.$el.width();this.zoom=t,this.layoutWidth=Math.floor(e*t),this.layoutOffset=Math.floor((e-this.layoutWidth)/2),this._zoomSpacings()},updateLayout:function(){var t=n.clone(this.layoutSettings);t.container_width=this.layoutWidth,this.dragState&&(t.interactive_drag_mode=!0);var e=this._getItemList();this.layoutPages=this.calculator.exec(e,t),this._placeItems()},dragStart:function(t,e){var i=parseInt(s(t.currentTarget).data("id")),n=this.items.get(i),o=n.get("placement");n.set("placement",null,{silent:!0}),this.dragState={id:i,itemWidth:o.width,itemHeight:o.height,imageWidth:n.get("thumbnail_width"),imageHeight:n.get("thumbnail_height"),dropHelperPlaced:!1},this.imageDropHelper=s('<div class="vls-gf-drop-helper"></div>'),this.$el.append(this.imageDropHelper)},dragUpdate:function(t,e){this.dragState&&(this.dragState.position={top:e.position.top+Math.floor(this.dragState.itemHeight/2),left:e.position.left+Math.floor(this.dragState.itemWidth/2)},this.dragState.dropHelperPlaced=!1,this.updateLayout())},dragStop:function(t){this._updateItemsOrder(),this.imageDropHelper.remove(),delete this.dragState,delete this.imageDropHelper,this.updateLayout();var e=s(t.target);e.addClass("vls-gf-no-click"),setTimeout(function(){e.removeClass("vls-gf-no-click")},100)},calculatorCallback:function(t,e,i,n,s,o,r,l){if(!this.dragState||this.dragState.dropHelperPlaced)return!1;var d=this.layoutOffset,c=this.layoutSettings.horizontal_spacing,u=this.layoutSettings.vertical_spacing;n+=l+(r-1)*a;var h=e+c,g=i+u,p=n-Math.floor(u/2),f=s-Math.floor(c/2)+d,v=this.dragState.position;if(v.top>=p&&v.top<=p+g&&v.left>=f&&v.left<=f+h){var m=Math.floor(this.dragState.imageHeight/this.dragState.imageWidth*e);return this._placeDropHelper(e+o,m,n,s+d),this.dragState.newIndex=t,{height:m}}return!1},_zoomSpacings:function(){this.layoutSettings.horizontal_spacing=Math.ceil(this.layoutSettingsModel.get("horizontal_spacing")*this.zoom),this.layoutSettings.vertical_spacing=Math.ceil(this.layoutSettingsModel.get("vertical_spacing")*this.zoom)},_getItemList:function(){var t=this.dragState?this.dragState.id:0,e=[];return this.items.each(function(i){t!==i.id&&e.push({id:i.id,thumbnail_width:i.get("thumbnail_width"),thumbnail_height:i.get("thumbnail_height")})}),e},_placeDropHelper:function(t,e,i,n){this.imageDropHelper.css({width:t,height:e,top:i,left:n}),this.dragState.dropHelperPlaced=!0},_placeItems:function(){var t,e=this.layoutPages[0],i=this.items,s=this.layoutOffset,o=0;n.each(e.items,function(e){if(e.placement.left+=s,!e.isDragged){var n=i.get(e.id);n.set("placement",e.placement)}t=e.placement.top+e.placement.height,o<t&&(o=t)}),this.$el.css("height",o+this.layoutSettings.vertical_spacing+600)},_updateItemsOrder:function(){var t=this.dragState.newIndex,e=this.dragState.id,i=0;this.items.each(function(n){e===n.id?n.set("layout_order_no",t+1):(i===t&&i++,n.set("layout_order_no",i+1),i++)}),this.items.sort()}});t.exports=l},function(t,e){function i(t){var e,i=t.horizontal_spacing,n=t.container_width,s="xs"===t.screen_size?1:t.column_count,o=[],r=n-i*(s-1),a=Math.floor(r/s),l=r-a*s,d=0;for(e=0;e<s;e++){var c=0;l>0&&(c=1,l--),o[e]={no:e,width:a,extraPixel:c,height:0,netHeight:0,left:d,items:[],pageItemsCount:0},d+=a+i+c}return o}function n(t){var e,i=t.length,n=t[0].height,s=t[0];for(e=1;e<i;e++){var o=t[e].height;o<n&&(n=o,s=t[e])}return s}function s(t){var e,i,n=t.length,s=t[0].height;for(e=0;e<n;e++){var o=t[e].height;o>0&&o<s&&(s=o)}for(e=0;e<n;e++){var r=t[e].items,a=t[e].height,l=a-s;if(0!==l){var d=0,c=t[e].netHeight,u=r.length;for(i=0;i<u;i++){var h=r[i],g=Math.ceil(h.placement.height*l/c);l-=g,c-=h.placement.height,h.placement.height-=g,h.placement.top-=d,d+=g}}}}var o=function(t){this.editorCallback=t};o.prototype.exec=function(t,e){var o=e.vertical_spacing,r=e.align_bottom;e.interactive_drag_mode&&(r=!1);var a,l,d,c,u,h,g,p=1,f=0,v=i(e);g=t.length;var m=-1;for(h=0;h<g;h++){m++;var _=t[h];a=n(v),l=a.width,d=Math.floor(_.thumbnail_height/_.thumbnail_width*l);var b=a.extraPixel;u=a.height,c=a.left;var y;this.editorCallback&&(y=this.editorCallback(m,l,d,u,c,b,p,f)),y?(d=y.height,_={isDragged:!0,placement:{pageNo:p,width:l+b,height:d,top:u,left:c,col:a.no}},t.push(_),h--):_.placement={pageNo:p,width:l+b,height:d,top:u,left:c,col:a.no},a.items.push(_),a.pageItemsCount++,a.height+=d+o,a.netHeight+=d}return r&&s(v),[{no:1,vertOffset:0,items:t}]},t.exports=o},function(t,e,i){var n=i(40),s=i(86),o=i(87),r=n.extend({className:"vls-gf-view-layout-settings",template:o,templateHelpers:function(){return{t:{layoutType:this.l10n.t("layoutType"),columnCount:this.l10n.t("columnCount"),columnCountXs:this.l10n.t("columnCountXs"),aspectRatio:this.l10n.t("aspectRatio"),horizontalSpacing:this.l10n.t("horizontalSpacing"),verticalSpacing:this.l10n.t("verticalSpacing"),alignBottom:this.l10n.t("alignBottom")},enums:this.enums}},ui:{fldLayoutType:"#vls-gf-fld-layout-type",fldColumnCount:"#vls-gf-fld-column-count",fldAspectRatio:"#vls-gf-fld-aspect-ratio",fldHorizontalSpacing:"#vls-gf-fld-horizontal-spacing",fldVerticalSpacing:"#vls-gf-fld-vertical-spacing",fldAlignBottom:"#vls-gf-fld-align-bottom"},events:{"change @ui.fldLayoutType":"onFldLayoutTypeChange","change @ui.fldColumnCount":"onFldColumnCountChange","change @ui.fldAspectRatio":"onFldAspectRatioChange","change @ui.fldHorizontalSpacing":"onFldHorizontalSpacingChange","change @ui.fldVerticalSpacing":"onFldVerticalSpacingChange","change @ui.fldAlignBottom":"onFldAlignBottomChange"},enums:s,onRender:function(){this._updateParamsVisibility(this.model.get("layout_type"))},onFldLayoutTypeChange:function(){var t=this.ui.fldLayoutType.val();this.model.set("layout_type",t),this._updateParamsVisibility(t)},onFldColumnCountChange:function(){this.model.set("column_count",parseInt(this.ui.fldColumnCount.val()))},onFldAspectRatioChange:function(){var t=this.ui.fldAspectRatio.val();t=t.replace(",","."),t=t.replace(":","/"),t=t.replace("-","/");var e=t.split("/"),i=parseFloat(e[0]);e.length>1&&(i=Math.round(i/parseFloat(e[1])*1e3)/1e3),i?i<.25?i=.25:i>4&&(i=4):i=1,this.ui.fldAspectRatio.val(i),this.model.set("aspect_ratio",i)},onFldHorizontalSpacingChange:function(){var t=parseInt(this.ui.fldHorizontalSpacing.val());!t||t<0?t=0:t>100&&(t=100),this.ui.fldHorizontalSpacing.val(t),this.model.set("horizontal_spacing",t)},onFldVerticalSpacingChange:function(){var t=parseInt(this.ui.fldVerticalSpacing.val());!t||t<0?t=0:t>100&&(t=100),this.ui.fldVerticalSpacing.val(t),this.model.set("vertical_spacing",t)},onFldAlignBottomChange:function(){var t=this.ui.fldAlignBottom.prop("checked")===!0;this.model.set("align_bottom",t)},_updateParamsVisibility:function(t){"grid"===t?(this.ui.fldAspectRatio.closest(".vls-gf-field").show(),this.ui.fldAlignBottom.closest(".vls-gf-field-check").hide()):"metro"===t?(this.ui.fldAspectRatio.closest(".vls-gf-field").show(),this.ui.fldAlignBottom.closest(".vls-gf-field-check").hide()):"masonry-v"===t&&(this.ui.fldAspectRatio.closest(".vls-gf-field").hide(),this.ui.fldAlignBottom.closest(".vls-gf-field-check").show())}});t.exports=r},function(t,e){t.exports=window.vlsGFData.enumerations},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<div class="vls-gf-form">\n\t\n\t<div class="vls-gf-field vls-gf-field-select">\n\t\t<label for="vls-gf-fld-layout-type">'+(null==(__t=t.layoutType)?"":__t)+'</label>\n\t\t<select id="vls-gf-fld-layout-type">\n\t\t\t';for(var opt in enums.layoutType)__p+='\n\t\t\t<option value="'+(null==(__t=enums.layoutType[opt].value)?"":__t)+'"\n\t\t\t',layout_type==enums.layoutType[opt].value&&(__p+="selected"),__p+=">\n\t\t\t"+(null==(__t=enums.layoutType[opt].text)?"":__t)+"\n\t\t\t</option>\n\t\t\t";__p+='\n\t\t</select>\n\t</div>\n\t\n\t<div class="vls-gf-field vls-gf-field-select">\n\t\t<label for="vls-gf-fld-column-count">'+(null==(__t=t.columnCount)?"":__t)+'</label>\n\t\t<select id="vls-gf-fld-column-count">\n\t\t\t';for(var opt in enums.layoutColumnCount)__p+='\n\t\t\t<option\n\t\t\t\t\tvalue="'+(null==(__t=enums.layoutColumnCount[opt].value)?"":__t)+'"\n\t\t\t',column_count==enums.layoutColumnCount[opt].value&&(__p+="selected"),__p+=">"+(null==(__t=enums.layoutColumnCount[opt].text)?"":__t)+"\n\t\t\t</option>\n\t\t\t";__p+='\n\t\t</select>\n\t\n\t</div>\n\t\n\t<div class="vls-gf-field">\n\t\t<label for="vls-gf-fld-aspect-ratio">'+(null==(__t=t.aspectRatio)?"":__t)+'</label>\n\t\t<input id="vls-gf-fld-aspect-ratio" type="text" value="'+(null==(__t=aspect_ratio)?"":__t)+'"/>\n\t</div>\n\t\n\t<div class="vls-gf-field">\n\t\t<label for="vls-gf-fld-horizontal-spacing">'+(null==(__t=t.horizontalSpacing)?"":__t)+'</label>\n\t\t<input id="vls-gf-fld-horizontal-spacing" type="text" value="'+(null==(__t=horizontal_spacing)?"":__t)+'"/>\n\t</div>\n\t\n\t<div class="vls-gf-field">\n\t\t<label for="vls-gf-fld-vertical-spacing">'+(null==(__t=t.verticalSpacing)?"":__t)+'</label>\n\t\t<input id="vls-gf-fld-vertical-spacing" type="text" value="'+(null==(__t=vertical_spacing)?"":__t)+'"/>\n\t</div>\n\t\n\t<div class="vls-gf-field-check">\n\t\t<label for="vls-gf-fld-align-bottom">'+(null==(__t=t.alignBottom)?"":__t)+'</label>\n\t\t<input id="vls-gf-fld-align-bottom" type="checkbox" value="1" ',1==align_bottom&&(__p+='checked="checked"'),__p+=">\n\t</div>\n\n</div>"}return __p}},function(t,e,i){var n=i(40),s=i(89),o=i(86),r=n.extend({className:"vls-gf-view-tab-settings",template:s,templateHelpers:function(){return{t:{appendNewImagesTo:this.l10n.t("appendNewImagesTo"),displayImageInfoOnHover:this.l10n.t("displayImageInfoOnHover")},enums:this.enums}},ui:{fldAppendNewImagesTo:"#vls-gf-fld-append-new-images-to",fldDisplayImageInfoOnHover:"#vls-gf-fld-display-image-info-on-hover"},events:{"change @ui.fldAppendNewImagesTo":"onFldAppendNewImagesToChange","change @ui.fldDisplayImageInfoOnHover":"onFldDisplayImageInfoOnHoverChange"},enums:o,onFldAppendNewImagesToChange:function(){this.model.set("add_items_at",this.ui.fldAppendNewImagesTo.val())},onFldDisplayImageInfoOnHoverChange:function(){this.model.get("style_meta").set("display_image_info_on_hover",this.ui.fldDisplayImageInfoOnHover.val())}});t.exports=r},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){if(__p+='<div class="vls-gf-main-panel">\n\t\n\t<div class="vls-gf-form">\n\t\t\n\t\t',"album"==type){__p+='\n\t\t<div class="vls-gf-field vls-gf-field-select vls-gf-half-width">\n\t\t\t<label for="vls-gf-fld-append-new-images-to">'+(null==(__t=t.appendNewImagesTo)?"":__t)+'</label>\n\t\t\t<select id="vls-gf-fld-append-new-images-to">\n\t\t\t\t';for(var opt in enums.appendNewImagesTo)__p+='\n\t\t\t\t<option value="'+(null==(__t=enums.appendNewImagesTo[opt].value)?"":__t)+'"\n\t\t\t\t',add_items_at==enums.appendNewImagesTo[opt].value&&(__p+="selected"),__p+=">"+(null==(__t=enums.appendNewImagesTo[opt].text)?"":__t)+"\n\t\t\t\t</option>\n\t\t\t\t";__p+="\n\t\t\t</select>\n\t\t</div>\n\t\t"}__p+='\n\t\t\n\t\t<div class="vls-gf-field vls-gf-field-select vls-gf-half-width">\n\t\t\t<label for="vls-gf-fld-display-image-info-on-hover">'+(null==(__t=t.displayImageInfoOnHover)?"":__t)+'</label>\n\t\t\t<select id="vls-gf-fld-display-image-info-on-hover">\n\t\t\t\t';for(var opt in enums.displayImageInfoOnHover)__p+='\n\t\t\t\t<option\n\t\t\t\t\t\tvalue="'+(null==(__t=enums.displayImageInfoOnHover[opt].value)?"":__t)+'"\n\t\t\t\t',style_meta.display_image_info_on_hover==enums.displayImageInfoOnHover[opt].value&&(__p+="selected"),__p+=">"+(null==(__t=enums.displayImageInfoOnHover[opt].text)?"":__t)+"\n\t\t\t\t</option>\n\t\t\t\t";__p+="\n\t\t\t</select>\n\t\t</div>\n\t\n\t</div>\n</div>"}return __p}},function(t,e,i){"use strict";var n=i(17),s=n.extend({url:"image",api_view:"editor",toJSON:function(){var t=n.prototype.toJSON.call(this);if(t.file_size_kb=Math.round(t.file_size/1024),t.image_meta&&t.image_meta.shutter_speed){var e=parseFloat(t.image_meta.shutter_speed);e<1?t.image_meta.shutter_speed_display="1/"+Math.round(1/e):t.image_meta.shutter_speed_display=e}return t}});t.exports=s},function(t,e,i){var n=i(2),s=i(21),o=i(92),r=i(93),a=i(95),l=i(97),d=s.extend({className:"vls-gf-view-image-editor",template:o,templateHelpers:function(){return{t:{tabGeneral:this.l10n.t("tabGeneral"),tabPreview:this.l10n.t("tabPreview"),tabMetadata:this.l10n.t("tabMetadata"),tabSettings:this.l10n.t("tabSettings"),tt:{saveChanges:this.l10n.t("tooltips.saveChanges"),prevImage:this.l10n.t("tooltips.prevImage"),nextImage:this.l10n.t("tooltips.nextImage")}}}},regions:{content:".vls-gf-content-wrapper"},ui:{header:".vls-gf-fixed-wrapper .vls-gf-primary-toolbar h3",btnBack:".vls-gf-fixed-wrapper .vls-gf-primary-toolbar button.vls-gf-icon-back-w",btnSave:".vls-gf-fixed-wrapper button.vls-gf-fab",btnNextImage:'.vls-gf-fixed-wrapper .vls-gf-primary-toolbar button[data-action="next-image"]',btnPrevImage:'.vls-gf-fixed-wrapper .vls-gf-primary-toolbar button[data-action="prev-image"]',btnTabGeneral:'.vls-gf-fixed-wrapper .vls-gf-tab-bar li[data-tab="general"]',btnTabMetadata:'.vls-gf-fixed-wrapper .vls-gf-tab-bar li[data-tab="metadata"]',btnTabPreview:'.vls-gf-fixed-wrapper .vls-gf-tab-bar li[data-tab="preview"]'},events:{"click @ui.btnBack":"onBtnBack","click @ui.btnSave":"onBtnSave","click @ui.btnNextImage":"onBtnNextImage","click @ui.btnPrevImage":"onBtnPrevImage","click @ui.btnTabGeneral":"onBtnTabGeneral","click @ui.btnTabMetadata":"onBtnTabMetadata","click @ui.btnTabPreview":"onBtnTabPreview"},modelEvents:{sync:"renderLoaded","change:name":"onNameChange"},initialize:function(t){this.currentTab="general";var e={},i=this.model.get("node_id");i&&(e.data={node_id:i}),this.model.fetch(e)},onRender:function(){var t=this.model.get("node_id");t||this.ui.btnTabSettings.hide()},renderLoaded:function(t,e,i){n(".vls-gf-tooltip").remove(),this.render(),this._renderTabs()},onBtnBack:function(){this.radio.trigger("global:requestRoute",{view:"manager"})},onBtnSave:function(){this.savingInProgress||(this.savingInProgress=!0,this.ui.btnSave.addClass("vls-gf-in-progress"),this.model.save(null,{parse:!1,patch:!0,success:this.onSaveSuccess.bind(this)}))},onSaveSuccess:function(){this.savingInProgress=!1,this.isDestroyed||this.ui.btnSave.removeClass("vls-gf-in-progress"),this.radio.trigger("dialog:notification:requested",{message:this.l10n.t("imageSaved")}),this.radio.trigger("image:changed",{model:this.model})},onBtnNextImage:function(){var t=this.radio.request("album:getNeighbourImage",{direction:"next",id:this.model.get("id")});t&&(this.model.set({id:t.id,name:t.name}),this.model.fetch())},onBtnPrevImage:function(){var t=this.radio.request("album:getNeighbourImage",{direction:"prev",id:this.model.get("id")});t&&(this.model.set({id:t.id,name:t.name}),this.model.fetch())},onBtnTabGeneral:function(){this.currentTab="general",this._renderTabs()},onBtnTabPreview:function(){this.currentTab="preview",this._renderTabs()},onBtnTabMetadata:function(){this.currentTab="metadata",this._renderTabs()},onNameChange:function(){this.ui.header.html(this.model.get("name"))},_renderTabs:function(){"general"===this.currentTab?(this.ui.btnTabGeneral.addClass("vls-gf-active"),this.content.show(new r({model:this.model}))):this.ui.btnTabGeneral.removeClass("vls-gf-active"),"metadata"===this.currentTab?(this.ui.btnTabMetadata.addClass("vls-gf-active"),this.content.show(new a({model:this.model}))):this.ui.btnTabMetadata.removeClass("vls-gf-active"),"preview"===this.currentTab?(this.ui.btnTabPreview.addClass("vls-gf-active"),this.content.show(new l({model:this.model}))):this.ui.btnTabPreview.removeClass("vls-gf-active"),this.radio.trigger("global:needAdjustFixedElement",{})}});t.exports=d},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="vls-gf-fixed-wrapper">\n\t<div class="vls-gf-primary-toolbar">\n        <span>\n            <button class="vls-gf-icon vls-gf-icon-back-w"></button>\n        </span>\n\t\t<h3>'+(null==(__t=name)?"":__t)+'</h3>\n\t\t<ul class="vls-gf-actions">\n\t\t\t<li>\n\t\t\t\t<button data-action="prev-image" class="vls-gf-icon vls-gf-icon-navigate-before-w"\n\t\t\t\t\t\tdata-vls-gf-tooltip="'+(null==(__t=t.tt.prevImage)?"":__t)+'" data-vls-gf-position="below"\n\t\t\t\t\t\tdata-vls-gf-offset="0"></button>\n\t\t\t</li>\n\t\t\t<li>\n\t\t\t\t<button data-action="next-image" class="vls-gf-icon vls-gf-icon-navigate-next-w"\n\t\t\t\t\t\tdata-vls-gf-tooltip="'+(null==(__t=t.tt.nextImage)?"":__t)+'" data-vls-gf-position="below"\n\t\t\t\t\t\tdata-vls-gf-offset="0"></button>\n\t\t\t</li>\n\t\t</ul>\n\t</div>\n\t<div class="vls-gf-tab-bar">\n\t\t<ul>\n\t\t\t<li data-tab="general"><span>'+(null==(__t=t.tabGeneral)?"":__t)+'</span></li>\n\t\t\t<li data-tab="metadata"><span>'+(null==(__t=t.tabMetadata)?"":__t)+'</span></li>\n\t\t\t<li data-tab="preview"><span>'+(null==(__t=t.tabPreview)?"":__t)+'</span></li>\n\t\t</ul>\n\t</div>\n\t<button class="vls-gf-fab vls-gf-icon vls-gf-icon-done-w" data-vls-gf-tooltip="'+(null==(__t=t.tt.saveChanges)?"":__t)+'"\n\t\t\tdata-vls-gf-position="below" data-vls-gf-offset="14"></button>\n</div>\n\n<div class="vls-gf-content-wrapper">\n\n</div>';return __p}},function(t,e,i){"use strict";var n=i(40),s=i(94),o=n.extend({className:"vls-gf-view-tab-general",template:s,templateHelpers:function(){return{t:{name:this.l10n.t("name"),caption:this.l10n.t("caption"),description:this.l10n.t("description"),altText:this.l10n.t("altText"),url:this.l10n.t("url")}}},ui:{fldName:"#vls-gf-fld-name",fldCaption:"#vls-gf-fld-caption",fldDescription:"#vls-gf-fld-description",fldAltText:"#vls-gf-fld-alt-text"},events:{"change @ui.fldName":"onFldNameChange","change @ui.fldCaption":"onFldCaptionChange","change @ui.fldDescription":"onFldDescriptionChange","change @ui.fldAltText":"onFldAltTextChange"},onFldNameChange:function(){this.model.set("name",this.ui.fldName.val())},onFldCaptionChange:function(){this.model.set("caption",this.ui.fldCaption.val())},onFldDescriptionChange:function(){this.model.set("description",this.ui.fldDescription.val())},onFldAltTextChange:function(){this.model.set("alt_text",this.ui.fldAltText.val())}});t.exports=o},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="vls-gf-main-panel">\r\n\t\r\n\t<div class="vls-gf-right-col">\r\n\t\t\r\n\t\t<div class="vls-gf-cover-image">\r\n\t\t\t<img src="'+(null==(__t=cover_url)?"":__t)+'">\r\n\t\t\t<div>\r\n\t\t\t\t<div>'+(null==(__t=t.setCoverImage)?"":__t)+'</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\r\n\t</div>\r\n\t\r\n\t<div class="vls-gf-left-col">\r\n\t\t\r\n\t\t<div class="vls-gf-form">\r\n\t\t\t\r\n\t\t\t<div class="vls-gf-field">\r\n\t\t\t\t<label for="vls-gf-fld-name">'+(null==(__t=t.name)?"":__t)+'</label>\r\n\t\t\t\t<input id="vls-gf-fld-name" type="text" value="'+(null==(__t=name)?"":__t)+'"/>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t<div class="vls-gf-field">\r\n\t\t\t\t<label for="vls-gf-fld-caption">'+(null==(__t=t.caption)?"":__t)+'</label>\r\n\t\t\t\t<input id="vls-gf-fld-caption" type="text" value="'+(null==(__t=caption)?"":__t)+'"/>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t<div class="vls-gf-field">\r\n\t\t\t\t<label for="vls-gf-fld-description">'+(null==(__t=t.description)?"":__t)+'</label>\r\n\t\t\t\t<textarea id="vls-gf-fld-description">'+(null==(__t=description)?"":__t)+'</textarea>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t<div class="vls-gf-field">\r\n\t\t\t\t<label for="vls-gf-fld-alt-text">'+(null==(__t=t.altText)?"":__t)+'</label>\r\n\t\t\t\t<input id="vls-gf-fld-alt-text" type="text" value="'+(null==(__t=alt_text)?"":__t)+'"/>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t<div class="vls-gf-field-ro">\r\n\t\t\t\t<span>'+(null==(__t=t.url)?"":__t)+"</span>\r\n\t\t\t\t<span>"+(null==(__t=url)?"":__t)+"</span>\r\n\t\t\t</div>\r\n\t\t\r\n\t\t</div>\r\n\t\r\n\t</div>\r\n</div>";return __p}},function(t,e,i){"use strict";var n=i(40),s=i(96),o=n.extend({className:"vls-gf-view-tab-metadata",template:s,templateHelpers:function(){return{t:{file:this.l10n.t("file"),exif:this.l10n.t("exif"),fileName:this.l10n.t("fileName"),fileType:this.l10n.t("fileType"),fileSize:this.l10n.t("fileSize"),dimensions:this.l10n.t("dimensions"),uploadDate:this.l10n.t("uploadDate"),uploadedBy:this.l10n.t("uploadedBy"),camera:this.l10n.t("camera"),lens:this.l10n.t("lens"),focalLength:this.l10n.t("focalLength"),shutterSpeed:this.l10n.t("shutterSpeed"),aperture:this.l10n.t("aperture"),iso:this.l10n.t("iso"),creationDate:this.l10n.t("creationDate"),author:this.l10n.t("author"),copyright:this.l10n.t("copyright"),tags:this.l10n.t("tags")}}}});t.exports=o},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="vls-gf-main-panel">\r\n\t\r\n\t<div class="vls-gf-form">\r\n\t\t\r\n\t\t<h5>'+(null==(__t=t.file)?"":__t)+'</h5>\r\n\t\t\r\n\t\t<div class="vls-gf-field-ro">\r\n\t\t\t<span>'+(null==(__t=t.fileName)?"":__t)+"</span>\r\n\t\t\t<span>"+(null==(__t=filename)?"":__t)+'</span>\r\n\t\t</div>\r\n\t\t\r\n\t\t<div class="vls-gf-field-ro">\r\n\t\t\t<span>'+(null==(__t=t.fileSize)?"":__t)+"</span>\r\n\t\t\t<span>"+(null==(__t=file_size_kb)?"":__t)+' kB</span>\r\n\t\t</div>\r\n\t\t\r\n\t\t<div class="vls-gf-field-ro">\r\n\t\t\t<span>'+(null==(__t=t.dimensions)?"":__t)+"</span>\r\n\t\t\t<span>"+(null==(__t=width)?"":__t)+"&times;"+(null==(__t=height)?"":__t)+'</span>\r\n\t\t</div>\r\n\t\t\r\n\t\t<div class="vls-gf-field-ro">\r\n\t\t\t<span>'+(null==(__t=t.uploadDate)?"":__t)+"</span>\r\n\t\t\t<span>"+(null==(__t=created)?"":__t)+'</span>\r\n\t\t</div>\r\n\t\t\r\n\t\t<div class="vls-gf-field-ro">\r\n\t\t\t<span>'+(null==(__t=t.uploadedBy)?"":__t)+"</span>\r\n\t\t\t<span>"+(null==(__t=created_by)?"":__t)+"</span>\r\n\t\t</div>\r\n\t\t\r\n\t\t<h5>"+(null==(__t=t.exif)?"":__t)+'</h5>\r\n\t\t\r\n\t\t<div class="vls-gf-field-ro">\r\n\t\t\t<span>'+(null==(__t=t.camera)?"":__t)+"</span>\r\n\t\t\t<span>"+(null==(__t=image_meta.camera)?"":__t)+'</span>\r\n\t\t</div>\r\n\t\t\r\n\t\t<div class="vls-gf-field-ro">\r\n\t\t\t<span>'+(null==(__t=t.lens)?"":__t)+"</span>\r\n\t\t\t<span>"+(null==(__t=image_meta.lens)?"":__t)+'</span>\r\n\t\t</div>\r\n\t\t\r\n\t\t<div class="vls-gf-field-ro">\r\n\t\t\t<span>'+(null==(__t=t.focalLength)?"":__t)+"</span>\r\n\t\t\t<span>"+(null==(__t=image_meta.focalLength)?"":__t)+'</span>\r\n\t\t</div>\r\n\t\t\r\n\t\t<div class="vls-gf-field-ro">\r\n\t\t\t<span>'+(null==(__t=t.shutterSpeed)?"":__t)+"</span>\r\n\t\t\t<span>"+(null==(__t=image_meta.shutter_speed_display)?"":__t)+'</span>\r\n\t\t</div>\r\n\t\t\r\n\t\t<div class="vls-gf-field-ro">\r\n\t\t\t<span>'+(null==(__t=t.aperture)?"":__t)+"</span>\r\n\t\t\t<span>"+(null==(__t=image_meta.aperture)?"":__t)+'</span>\r\n\t\t</div>\r\n\t\t\r\n\t\t<div class="vls-gf-field-ro">\r\n\t\t\t<span>'+(null==(__t=t.iso)?"":__t)+"</span>\r\n\t\t\t<span>"+(null==(__t=image_meta.iso)?"":__t)+'</span>\r\n\t\t</div>\r\n\t\t\r\n\t\t<div class="vls-gf-field-ro">\r\n\t\t\t<span>'+(null==(__t=t.creationDate)?"":__t)+"</span>\r\n\t\t\t<span>"+(null==(__t=image_meta.creation_date)?"":__t)+'</span>\r\n\t\t</div>\r\n\t\t\r\n\t\t<div class="vls-gf-field-ro">\r\n\t\t\t<span>'+(null==(__t=t.author)?"":__t)+"</span>\r\n\t\t\t<span>"+(null==(__t=image_meta.author)?"":__t)+'</span>\r\n\t\t</div>\r\n\t\t\r\n\t\t<div class="vls-gf-field-ro">\r\n\t\t\t<span>'+(null==(__t=t.copyright)?"":__t)+"</span>\r\n\t\t\t<span>"+(null==(__t=image_meta.copyright)?"":__t)+'</span>\r\n\t\t</div>\r\n\t\t\r\n\t\t<div class="vls-gf-field-ro">\r\n\t\t\t<span>'+(null==(__t=t.tags)?"":__t)+"</span>\r\n\t\t\t<span>"+(null==(__t=image_meta.tags)?"":__t)+"</span>\r\n\t\t</div>\r\n\t\r\n\t</div>\r\n\r\n</div>";
return __p}},function(t,e,i){"use strict";var n=i(40),s=i(98),o=n.extend({className:"vls-gf-view-tab-thumbnail",template:s});t.exports=o},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="vls-gf-main-panel">\r\n\t<div class="vls-gf-image-wrapper">\r\n\t\t<img src="'+(null==(__t=url)?"":__t)+'"/>\r\n\t</div>\r\n</div>';return __p}},function(t,e,i){"use strict";var n=i(17),s=n.extend({url:"settings",defaults:{id:0}});t.exports=s},function(t,e,i){var n=i(2),s=i(21),o=i(101),r=i(102),a=s.extend({className:"vls-gf-view-settings",template:o,templateHelpers:function(){return{t:{settings:this.l10n.t("settings"),tabGeneral:this.l10n.t("tabGeneral"),tt:{saveChanges:this.l10n.t("tooltips.saveChanges")}}}},regions:{content:".vls-gf-content-wrapper"},ui:{btnTabGeneral:'.vls-gf-fixed-wrapper .vls-gf-tab-bar li[data-tab="general"]',btnBack:".vls-gf-fixed-wrapper .vls-gf-primary-toolbar button.vls-gf-icon-back-w",btnSave:".vls-gf-fixed-wrapper button.vls-gf-fab"},events:{"click @ui.btnTabGeneral":"onBtnTabGeneral","click @ui.btnBack":"onBtnBack","click @ui.btnSave":"onBtnSave"},modelEvents:{sync:"renderLoaded"},initialize:function(t){this.currentTab="general",this.model.fetch()},renderLoaded:function(t,e,i){n(".vls-gf-tooltip").remove(),this.render(),this._renderTabs()},onBtnBack:function(){this.radio.trigger("global:requestRoute",{view:"manager"})},onBtnSave:function(){this.savingInProgress||(this.savingInProgress=!0,this.ui.btnSave.addClass("vls-gf-in-progress"),this.model.save(null,{parse:!1,patch:!0,success:this.onSaveSuccess.bind(this)}))},onSaveSuccess:function(){this.savingInProgress=!1,this.ui.btnSave.removeClass("vls-gf-in-progress"),this.radio.trigger("dialog:notification:requested",{message:this.l10n.t("settingsSaved")})},onBtnTabGeneral:function(){this.currentTab="general",this._renderTabs()},_renderTabs:function(){"general"===this.currentTab?(this.ui.btnTabGeneral.addClass("vls-gf-active"),this.content.show(new r({model:this.model}))):this.ui.btnTabGeneral.removeClass("vls-gf-active"),this.radio.trigger("global:needAdjustFixedElement",{})}});t.exports=a},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="vls-gf-fixed-wrapper">\n\t<div class="vls-gf-primary-toolbar">\n        <span>\n            <button class="vls-gf-icon vls-gf-icon-back-w"></button>\n        </span>\n\t\t<h3>'+(null==(__t=t.settings)?"":__t)+'</h3>\n\t</div>\n\t<div class="vls-gf-tab-bar">\n\t\t<ul>\n\t\t\t<li data-tab="general"><span>'+(null==(__t=t.tabGeneral)?"":__t)+'</span></li>\n\t\t</ul>\n\t</div>\n\t<button class="vls-gf-fab vls-gf-icon vls-gf-icon-done-w" data-vls-gf-tooltip="'+(null==(__t=t.tt.saveChanges)?"":__t)+'"\n\t\t\tdata-vls-gf-position="below" data-vls-gf-offset="14"></button>\n</div>\n\n<div class="vls-gf-content-wrapper">\n\n</div>\n';return __p}},function(t,e,i){"use strict";var n=i(40),s=i(103),o=i(86),r=n.extend({className:"vls-gf-view-tab-general",template:s,templateHelpers:function(){return{t:{globalLightbox:this.l10n.t("globalLightbox"),globalDisplayImageInfoOnHover:this.l10n.t("globalDisplayImageInfoOnHover"),globalThumbnailDimensions:this.l10n.t("globalThumbnailDimensions"),tt:{globalLightbox:this.l10n.t("tooltips.globalLightbox"),globalDisplayImageInfoOnHover:this.l10n.t("tooltips.globalDisplayImageInfoOnHover"),globalThumbnailDimensions:this.l10n.t("tooltips.globalThumbnailDimensions")}},enums:o}},ui:{fldLightbox:"#vls-gf-fld-lightbox",fldDisplayImageInfoOnHover:"#vls-gf-fld-display-image-info-on-hover",fldThumbnailWidth:"#vls-gf-fld-thumbnail-width",fldThumbnailHeight:"#vls-gf-fld-thumbnail-height"},events:{"change @ui.fldLightbox":"onFldLightboxChange","change @ui.fldDisplayImageInfoOnHover":"onFldDisplayImageInfoOnHoverChange","change @ui.fldThumbnailWidth":"onFldThumbnailWidthChange","change @ui.fldThumbnailHeight":"onFldThumbnailHeightChange"},enums:o,onFldLightboxChange:function(){this.model.get("general").lightbox=this.ui.fldLightbox.val()},onFldDisplayImageInfoOnHoverChange:function(){this.model.get("general").display_image_info_on_hover=this.ui.fldDisplayImageInfoOnHover.val()},onFldThumbnailWidthChange:function(){this.model.get("general").thumbnail_width=this.ui.fldThumbnailWidth.val()},onFldThumbnailHeightChange:function(){this.model.get("general").thumbnail_height=this.ui.fldThumbnailHeight.val()}});t.exports=r},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<div class="vls-gf-main-panel">\n\t<div class="vls-gf-form">\n\t\t\n\t\t<div class="vls-gf-row">\n\t\t\t<div class="vls-gf-col-2">\n\t\t\t\t<div class="vls-gf-field vls-gf-field-select">\n\t\t\t\t\t<label for="vls-gf-fld-lightbox">'+(null==(__t=t.globalLightbox)?"":__t)+'</label>\n\t\t\t\t\t<select id="vls-gf-fld-lightbox">\n\t\t\t\t\t\t';for(var opt in enums.globalLightbox)__p+='\n\t\t\t\t\t\t<option\n\t\t\t\t\t\t\t\tvalue="'+(null==(__t=enums.globalLightbox[opt].value)?"":__t)+'"\n\t\t\t\t\t\t',general.lightbox==enums.globalLightbox[opt].value&&(__p+="selected"),__p+=">"+(null==(__t=enums.globalLightbox[opt].text)?"":__t)+"\n\t\t\t\t\t\t</option>\n\t\t\t\t\t\t";__p+='\n\t\t\t\t\t</select>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="vls-gf-col-2">\n\t\t\t\t<span>'+(null==(__t=t.tt.globalLightbox)?"":__t)+'</span>\n\t\t\t</div>\n\t\t</div>\n\t\t\n\t\t<div class="vls-gf-row">\n\t\t\t<div class="vls-gf-col-2">\n\t\t\t\t<div class="vls-gf-field vls-gf-field-select">\n\t\t\t\t\t<label for="vls-gf-fld-display-image-info-on-hover">'+(null==(__t=t.globalDisplayImageInfoOnHover)?"":__t)+'</label>\n\t\t\t\t\t<select id="vls-gf-fld-display-image-info-on-hover">\n\t\t\t\t\t\t';for(var opt in enums.globalDisplayImageInfoOnHover)__p+='\n\t\t\t\t\t\t<option\n\t\t\t\t\t\t\t\tvalue="'+(null==(__t=enums.globalDisplayImageInfoOnHover[opt].value)?"":__t)+'"\n\t\t\t\t\t\t',general.display_image_info_on_hover==enums.globalDisplayImageInfoOnHover[opt].value&&(__p+="selected"),__p+=">"+(null==(__t=enums.globalDisplayImageInfoOnHover[opt].text)?"":__t)+"\n\t\t\t\t\t\t</option>\n\t\t\t\t\t\t";__p+='\n\t\t\t\t\t</select>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="vls-gf-col-2">\n\t\t\t\t<span>'+(null==(__t=t.tt.globalDisplayImageInfoOnHover)?"":__t)+'</span>\n\t\t\t</div>\n\t\t</div>\n\t\t\n\t\t<div class="vls-gf-row">\n\t\t\t<div class="vls-gf-col-2">\n\t\t\t\t<div class="vls-gf-field vls-gf-dimensions">\n\t\t\t\t\t<label for="vls-gf-fld-thumbnail-width">'+(null==(__t=t.globalThumbnailDimensions)?"":__t)+'</label>\n\t\t\t\t\t<input id="vls-gf-fld-thumbnail-width" type="text" value="'+(null==(__t=general.thumbnail_width)?"":__t)+'"/>\n\t\t\t\t\t<span>&times;</span>\n\t\t\t\t\t<input id="vls-gf-fld-thumbnail-height" type="text" value="'+(null==(__t=general.thumbnail_height)?"":__t)+'"/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="vls-gf-col-2">\n\t\t\t\t<span>'+(null==(__t=t.tt.globalThumbnailDimensions)?"":__t)+"</span>\n\t\t\t</div>\n\t\t</div>\n\t\n\t</div>\n</div>"}return __p}},function(t,e,i){var n=(i(2),i(21)),s=i(105),o=i(106),r=i(107),a=i(109),l=i(111),d=n.extend({className:"vls-gf-view-tools",template:s,templateHelpers:function(){return{t:{tools:this.l10n.t("tools"),tabThumbnailRegeneration:this.l10n.t("tabThumbnailRegeneration"),tabImportFromWPMedia:this.l10n.t("tabImportFromWPMedia"),tabImportFromNextGenGallery:this.l10n.t("tabImportFromNextGenGallery")}}},regions:{content:".vls-gf-content-wrapper"},ui:{btnBack:".vls-gf-fixed-wrapper .vls-gf-primary-toolbar button.vls-gf-icon-back-w",btnTabRegenThumbnails:'.vls-gf-fixed-wrapper .vls-gf-tab-bar li[data-tab="regenerate-thumbnails"]',btnTabImportWPMedia:'.vls-gf-fixed-wrapper .vls-gf-tab-bar li[data-tab="import-wp-media"]',btnTabImportNextGen:'.vls-gf-fixed-wrapper .vls-gf-tab-bar li[data-tab="import-nextgen"]'},events:{"click @ui.btnBack":"onBtnBack","click @ui.btnTabRegenThumbnails":"onBtnTabRegenThumbnails","click @ui.btnTabImportWPMedia":"onBtnTabImportWPMedia","click @ui.btnTabImportNextGen":"onBtnTabImportNextGen"},modelEvents:{sync:"renderLoaded"},initialize:function(t){this.currentTab="regenerate-thumbnails",this.model=new o},onRender:function(){this._renderTabs()},onBtnBack:function(){this.radio.trigger("global:requestRoute",{view:"manager"})},onBtnTabRegenThumbnails:function(){this.currentTab="regenerate-thumbnails",this._renderTabs()},onBtnTabImportWPMedia:function(){this.currentTab="import-wp-media",this._renderTabs()},onBtnTabImportNextGen:function(){this.currentTab="import-nextgen",this._renderTabs()},_renderTabs:function(){"regenerate-thumbnails"===this.currentTab?(this.ui.btnTabRegenThumbnails.addClass("vls-gf-active"),this.content.show(new r({model:this.model}))):this.ui.btnTabRegenThumbnails.removeClass("vls-gf-active"),"import-wp-media"===this.currentTab?(this.ui.btnTabImportWPMedia.addClass("vls-gf-active"),this.content.show(new a({model:this.model}))):this.ui.btnTabImportWPMedia.removeClass("vls-gf-active"),"import-nextgen"===this.currentTab?(this.ui.btnTabImportNextGen.addClass("vls-gf-active"),this.content.show(new l({model:this.model}))):this.ui.btnTabImportNextGen.removeClass("vls-gf-active"),this.radio.trigger("global:needAdjustFixedElement",{})}});t.exports=d},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="vls-gf-fixed-wrapper">\r\n\t<div class="vls-gf-primary-toolbar">\r\n        <span>\r\n            <button class="vls-gf-icon vls-gf-icon-back-w"></button>\r\n        </span>\r\n\t\t<h3>'+(null==(__t=t.tools)?"":__t)+'</h3>\r\n\t</div>\r\n\t<div class="vls-gf-tab-bar">\r\n\t\t<ul>\r\n\t\t\t<li data-tab="regenerate-thumbnails"><span>'+(null==(__t=t.tabThumbnailRegeneration)?"":__t)+'</span></li>\r\n\t\t\t<li data-tab="import-wp-media"><span>'+(null==(__t=t.tabImportFromWPMedia)?"":__t)+'</span></li>\r\n\t\t\t<li data-tab="import-nextgen"><span>'+(null==(__t=t.tabImportFromNextGenGallery)?"":__t)+'</span></li>\r\n\t\t</ul>\r\n\t</div>\r\n</div>\r\n\r\n<div class="vls-gf-content-wrapper">\r\n\r\n</div>\r\n';return __p}},function(t,e,i){"use strict";var n=i(3),s=n.Model.extend({defaults:{}});t.exports=s},function(t,e,i){"use strict";var n=i(2),s=i(40),o=i(108),r=s.extend({className:"vls-gf-view-tab-regenerate-thumbnails",template:o,templateHelpers:function(){return{t:{regenerateThumbnailsDescription:this.l10n.t("regenerateThumbnailsDescription"),regenerateThumbnails:this.l10n.t("regenerateThumbnails")}}},ui:{btnImport:"button.vls-gf-button-raised",progressCard:".vls-gf-progress-card",progressMessage:".vls-gf-progress-card>span",progressIndicator:".vls-gf-progress-lin-det",progressValue:".vls-gf-progress-lin-det>span"},events:{"click @ui.btnImport":"onBtnRun"},initialize:function(){this.totalBatches=0},onRender:function(){this.model.get("actionInProgress")&&this.ui.btnImport.hide()},onBtnRun:function(){this.model.set("actionInProgress",!0),this.ui.progressMessage.html(this.l10n.t("regenerateThumbnailsProgressMessage")),this.ui.btnImport.hide(),this.ui.progressCard.show(),this.importBatch(1)},importBatch:function(t){var e=this;n.post(ajaxurl,{action:"vls_gf_regenerate_thumbnails_batch",_nonce:vlsGFData.nonce,batch_no:t},this.onImportResponse.bind(this),"json").fail(function(){e.onImportResponse({success:!1,message:"Unknown error occurred"})})},onImportResponse:function(t){t.success&&"progress"==t.result?(t.total_batches&&(this.totalBatches=t.total_batches),this.ui.progressValue.css({width:t.batch_no/this.totalBatches*100+"%"}),this.importBatch(t.batch_no+1)):t.success&&"complete"==t.result?(this.ui.progressIndicator.addClass("vls-gf-done"),this.ui.progressMessage.html(this.l10n.t("completed")),this.totalBatches=0):(this.ui.progressIndicator.addClass("vls-gf-failed"),this.ui.progressMessage.html(t.message))}});t.exports=r},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="vls-gf-main-panel">\r\n\t\r\n\t<p>'+(null==(__t=t.regenerateThumbnailsDescription)?"":__t)+'</p>\r\n\t\r\n\t<button class="vls-gf-button-raised">'+(null==(__t=t.regenerateThumbnails)?"":__t)+'</button>\r\n\t\r\n\t<div class="vls-gf-progress-card">\r\n\t\t<span></span>\r\n\t\t<div class="vls-gf-progress-lin-det"><span></span></div>\r\n\t</div>\r\n\r\n</div>';return __p}},function(t,e,i){"use strict";var n=i(2),s=i(40),o=i(110),r=s.extend({className:"vls-gf-view-tab-import-wp-media",template:o,templateHelpers:function(){return{t:{importWPMediaDescription1:this.l10n.t("importWPMediaDescription1"),importWPMediaDescription2:this.l10n.t("importWPMediaDescription2"),importWPMedia:this.l10n.t("importWPMedia")}}},ui:{btnImport:"button.vls-gf-button-raised",progressCard:".vls-gf-progress-card",progressMessage:".vls-gf-progress-card>span",progressIndicator:".vls-gf-progress-lin-det",progressValue:".vls-gf-progress-lin-det>span"},events:{"click @ui.btnImport":"onBtnImport"},initialize:function(){this.totalBatches=0},onRender:function(){this.model.get("actionInProgress")&&this.ui.btnImport.hide()},onBtnImport:function(){this.model.set("actionInProgress",!0),this.ui.progressMessage.html(this.l10n.t("importWPMediaProgressMessage")),this.ui.btnImport.hide(),this.ui.progressCard.show(),this.importBatch(1)},importBatch:function(t){n.post(ajaxurl,{action:"vls_gf_import_wp_media_batch",_nonce:window.vlsGFData.nonce,batch_no:t},this.onImportResponse.bind(this),"json")},onImportResponse:function(t){t.success&&"progress"==t.result?(t.total_batches&&(this.totalBatches=t.total_batches),this.ui.progressValue.css({width:t.batch_no/this.totalBatches*100+"%"}),this.importBatch(t.batch_no+1)):t.success&&"complete"==t.result?(this.ui.progressIndicator.addClass("vls-gf-done"),this.ui.progressMessage.html(this.l10n.t("completed")),this.radio.trigger("folder:contentChanged",{id:0}),this.totalBatches=0):(this.ui.progressIndicator.addClass("vls-gf-failed"),this.ui.progressMessage.html(t.message))}});t.exports=r},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="vls-gf-main-panel">\r\n\t\r\n\t<p>'+(null==(__t=t.importWPMediaDescription1)?"":__t)+"</p>\r\n\t<p>"+(null==(__t=t.importWPMediaDescription2)?"":__t)+'</p>\r\n\t\r\n\t<button class="vls-gf-button-raised">'+(null==(__t=t.importWPMedia)?"":__t)+'</button>\r\n\t\r\n\t<div class="vls-gf-progress-card">\r\n\t\t<span></span>\r\n\t\t<div class="vls-gf-progress-lin-det"><span></span></div>\r\n\t</div>\r\n\r\n\r\n</div>';return __p}},function(t,e,i){"use strict";var n=i(2),s=i(40),o=i(112),r=s.extend({className:"vls-gf-view-tab-import-nextgen",template:o,templateHelpers:function(){return{t:{createNextGenFolder:this.l10n.t("createNextGenFolder"),importNextGenDescription1:this.l10n.t("importNextGenDescription1"),importNextGenDescription2:this.l10n.t("importNextGenDescription2"),importNextGen:this.l10n.t("importNextGen")}}},ui:{fldCreateFolder:"#vls-gf-fld-create-folder",btnImport:"button.vls-gf-button-raised",progressCard:".vls-gf-progress-card",progressMessage:".vls-gf-progress-card>span",progressIndicator:".vls-gf-progress-card > .vls-gf-progress-lin-ind"},events:{"click @ui.btnImport":"onBtnImport"},onRender:function(){this.model.get("actionInProgress")&&this.ui.btnImport.hide()},onBtnImport:function(){this.model.set("actionInProgress",!0),this.ui.progressMessage.html(this.l10n.t("importNextGenProgressMessage")),this.ui.btnImport.hide(),this.ui.progressCard.show(),n.post(ajaxurl,{action:"vls_gf_import_nextgen",_nonce:window.vlsGFData.nonce,create_folder:this.ui.fldCreateFolder[0].checked},this.onImportResponse.bind(this),"json")},onImportResponse:function(t){t.success?(this.ui.progressIndicator.addClass("vls-gf-done"),this.ui.progressMessage.html(this.l10n.t("completed")),this.radio.trigger("folder:contentChanged",{id:0})):(this.ui.progressIndicator.addClass("vls-gf-failed"),this.ui.progressMessage.html(t.message))}});t.exports=r},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="vls-gf-main-panel">\r\n\t\r\n\t<p>'+(null==(__t=t.importNextGenDescription1)?"":__t)+"</p>\r\n\t<p>"+(null==(__t=t.importNextGenDescription2)?"":__t)+'</p>\r\n\t\r\n\t<div class="vls-gf-field-check">\r\n\t\t<input id="vls-gf-fld-create-folder" type="checkbox" value="true">\r\n\t\t<label for="vls-gf-fld-create-folder">'+(null==(__t=t.createNextGenFolder)?"":__t)+'</label>\r\n\t</div>\r\n\t\r\n\t<button class="vls-gf-button-raised">'+(null==(__t=t.importNextGen)?"":__t)+'</button>\r\n\t\r\n\t<div class="vls-gf-progress-card">\r\n\t\t<span></span>\r\n\t\t<div class="vls-gf-progress-lin-ind"></div>\r\n\t</div>\r\n\r\n</div>';return __p}},function(t,e,i){var n=i(2),s=i(21),o=i(114),r=i(115),a=i(116),l=i(117),d=i(118),c=s.extend({el:"#vls-gf-layer-uploader",template:a,regions:{dialogContainer:"#vls-gf-uploader-dialog-container"},ui:{dropzone:"#vls-gf-uploader-dropzone",browseButton:"#vls-gf-uploader-btn-browse"},events:{"drop @ui.dropzone":"onDropzoneDrop"},modelEvents:{},childEvents:{"dialog:stop":"onDialogStop","dialog:close":"onDialogClose"},plupload:null,dialogModel:null,initialize:function(t){this.state={uploadEnabled:!1,dropzoneActive:!1,uploadingToAlbumId:!1,currentItem:{}},this.dragTimer=null,this.fadeTimer=null,this.pluploadMultipartParams={action:"vls_gf_api_image_upload",_nonce:o.plupload.nonce,album_id:0},this.pluploadSettings={container:"vls-gf-uploader-dropzone",drop_element:"vls-gf-uploader-dropzone",browse_button:"vls-gf-uploader-btn-browse",file_data_name:"async-upload",dragdrop:!0,autostart:!0,filters:{max_file_size:o.plupload.maxFileSize},multipart_params:this.pluploadMultipartParams,url:o.plupload.url,flash_swf_url:o.plupload.flashSwfUrl,silverlight_xap_url:o.plupload.silverlightXapUrl},this.render(),this.initPlupload(),this.listenTo(this.radio,"navigation:itemActivated",this.onManagerItemNavigated),this.listenTo(this.radio,"manager:uploadBrowseRequested",this.onBrowseRequested)},onRender:function(){},onShow:function(){},initPlupload:function(){this.plupload=new r.Uploader(this.pluploadSettings),this.plupload.bind("Error",this.onUploadError,this),this.plupload.init(),this.plupload.bind("StateChanged",this.onUploadStateChanged,this),this.plupload.bind("FilesAdded",this.onUploadFilesAdded,this),this.plupload.bind("UploadFile",this.onUploadUploadFile,this),this.plupload.bind("FileUploaded",this.onUploadFileUploaded,this),this.plupload.bind("UploadProgress",this.onUploadUploadProgress,this)},showDialog:function(){this.dialogModel?this.dialogModel.set({target:this.state.currentItem.name,totalCount:this.plupload.files.length,state:"uploading"}):(this.dialogModel=new l({target:this.state.currentItem.name,totalCount:this.plupload.files.length,state:"uploading"}),this.dialogContainer.show(new d({model:this.dialogModel})))},onDragEnter:function(t){if(this.dragTimer&&clearTimeout(this.dragTimer),this.fadeTimer&&clearTimeout(this.fadeTimer),!this.state.dropzoneActive){this.state.dropzoneActive=!0;var e=this.ui.dropzone;e.show(),setTimeout(function(){e.addClass("vls-gf-visible")},0)}},onDragLeave:function(t){var e=this;this.dragTimer&&clearTimeout(this.dragTimer),this.dragTimer=setTimeout(function(){e.state.dropzoneActive=!1;var t=e.ui.dropzone;t.removeClass("vls-gf-visible"),e.fadeTimer=setTimeout(function(){e.state.dropzoneActive===!1&&t.hide()},600)},10),this.state.uploadingToAlbumId!==!1&&this.state.uploadingToAlbumId!==this.state.currentItem.id&&(t.preventDefault(),t.stopImmediatePropagation(),t.stopPropagation())},onUploadError:function(t,e){this.showDialog(),this.dialogModel.set({state:"error",error_message:e.response||e.message}),this.plupload.stop(),this.plupload.splice()},onUploadStateChanged:function(){var t=this.plupload;t.state===r.STARTED?(this.state.uploadingToAlbumId=this.state.currentItem.id,this.showDialog()):("cancelled"!==this.dialogModel.get("state")&&"error"!==this.dialogModel.get("state")&&(this.plupload.splice(),this.dialogModel.set({progress:100,state:"done"})),this.radio.trigger("album:contentChanged",{id:this.state.uploadingToAlbumId}),this.state.uploadingToAlbumId=!1)},onUploadFilesAdded:function(t,e){var i=this;setTimeout(function(){i.plupload.start()},10)},onUploadUploadFile:function(t,e){},onUploadFileUploaded:function(t,e){},onUploadUploadProgress:function(){var t=this.plupload;this.dialogModel.set({progress:t.total.percent,totalCount:t.files.length,uploadedCount:t.total.uploaded})},onDialogStop:function(){this.dialogModel.set({state:"cancelled"}),this.plupload.stop(),this.plupload.splice()},onDialogClose:function(){delete this.dialogModel,this.plupload.refresh()},onManagerItemNavigated:function(t){this.state.currentItem={type:t.type,id:t.id,name:t.name},"all_images"!==t.type&&"unsorted_images"!==t.type||(this.state.currentItem.name=this.l10n.t("imageLibrary")),this.pluploadMultipartParams.album_id=this.state.currentItem.id,this.plupload.setOption("multipart_params",this.pluploadMultipartParams),"all_images"===t.type||"unsorted_images"===t.type||"album"===t.type?(this.state.uploadEnabled=!0,n(document).on("dragover.vls-gf",this.onDragEnter.bind(this)),this.ui.dropzone.on("dragover.vls-gf",this.onDragEnter.bind(this)),n(document).on("dragleave.vls-gf, drop.vls-gf",this.onDragLeave.bind(this)),this.ui.dropzone.on("dragleave.vls-gf, drop.vls-gf",this.onDragLeave.bind(this))):(this.state.uploadEnabled=!1,n(document).off("dragover.vls-gf"),this.ui.dropzone.off("dragover.vls-gf"),n(document).off("dragleave.vls-gf, drop.vls-gf"),this.ui.dropzone.off("dragleave.vls-gf, drop.vls-gf"))},onBrowseRequested:function(){this.ui.browseButton[0].click()},onDestroy:function(){n(document).off("dragover.vls-gf, dragleave.vls-gf, drop.vls-gf")}});t.exports=c},function(t,e,i){var n=i(5),s=n.omit(window.vlsGFData,["localization","enumerations"]);t.exports=s},function(t,e){t.exports=window.plupload},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div id="vls-gf-uploader-dropzone">\r\n\t<div class="vls-gf-uploader-dropzone-content">\r\n\t\t<h3>Drop files to upload</h3>\r\n\t</div>\r\n</div>\r\n<div id="vls-gf-uploader-dialog-container"></div>\r\n<a id="vls-gf-uploader-btn-browse" href="#" style="display:none;"></a>';return __p}},function(t,e,i){"use strict";var n=i(3),s=n.Model.extend({defaults:{target:"",progress:0,totalCount:0,uploadedCount:0,state:""}});t.exports=s},function(t,e,i){var n=i(40),s=i(119),o=n.extend({className:"vls-gf-dialog",template:s,templateHelpers:function(){return{l10n:{uploadingTo:this.l10n.t("uploadingTo"),stop:this.l10n.t("buttons.stop"),close:this.l10n.t("buttons.close")}}},ui:{targetText:".vls-gf-target",progressText:".vls-gf-progress-text",progressBarValue:".vls-gf-progressbar>div",btnStop:"button.vls-gf-btn-stop",btnClose:"button.vls-gf-btn-close"},events:{"click @ui.btnStop":"onBtnStop","click @ui.btnClose":"onBtnClose"},modelEvents:{change:"onModelChange"},onRender:function(){var t=this.model.get("totalCount");this.ui.progressText.html(this.l10n.t("nOfN",{1:0,2:t}))},onShow:function(){this.$el.addClass("vls-gf-visible")},onModelChange:function(){var t=this,e=this.model.get("state"),i=this.model.get("progress"),n=this.model.get("totalCount"),s=this.model.get("uploadedCount");this.autocloseTimeout&&clearTimeout(this.autocloseTimeout),this.ui.targetText.html(this.model.get("target")),"error"==e?(this.ui.progressText.html(this.l10n.t("uploaderError")),this.ui.btnStop.css("display","none"),this.ui.btnClose.css("display","inline-block")):"done"==e?(this.ui.progressText.html(this.l10n.t("done")),this.ui.btnStop.css("display","none"),this.ui.btnClose.css("display","inline-block"),this.autocloseTimeout=setTimeout(function(){t.onBtnClose()},6e3)):"cancelled"==e?(this.ui.progressText.html(this.l10n.t("cancelled")),this.ui.btnStop.css("display","none"),this.ui.btnClose.css("display","inline-block")):this.ui.progressText.html(this.l10n.t("nOfN",{1:s,2:n})),this.ui.progressBarValue.css("width",i+"%")},onBtnStop:function(){this.triggerMethod("dialog:stop")},onBtnClose:function(){var t=this;t.$el.hasClass("vls-gf-visible")&&(t.$el.removeClass("vls-gf-visible"),setTimeout(function(){t.destroy()},600),this.triggerMethod("dialog:close"))}});t.exports=o},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="vls-gf-message">'+(null==(__t=l10n.uploadingTo)?"":__t)+'</div>\r\n<div class="vls-gf-target">'+(null==(__t=target)?"":__t)+'</div>\r\n<div class="vls-gf-progress-text"></div>\r\n<div class="vls-gf-progressbar">\r\n\t<div></div>\r\n</div>\r\n<div class="vls-gf-actions">\r\n\t<button class="vls-gf-btn-flat vls-gf-btn-stop">'+(null==(__t=l10n.stop)?"":__t)+'</button>\r\n\t<button class="vls-gf-btn-flat vls-gf-btn-close" style="display:none;">'+(null==(__t=l10n.close)?"":__t)+"</button>\r\n</div>";return __p}},function(t,e,i){var n=i(2),s=i(21),o=i(3),r=i(121),a=i(122),l=i(124),d=i(126),c=i(130),u=i(132),h=s.extend({el:"#vls-gf-layer-dialog",template:r,regions:{dialogContainer:".vls-gf-dialog-wrapper"},ui:{backdrop:".vls-gf-dialog-wrapper"},childEvents:{"dialog:cancelled":"onDialogCancelled","dialog:confirmed":"onDialogConfirmed"},initialize:function(t){this.state={opened:!1,dialogType:""},this.dialogModel={},this.render(),this.listenTo(this.radio,"dialog:newFolder:requested",this.onNewFolderDialogRequested),this.listenTo(this.radio,"dialog:newAlbum:requested",this.onNewAlbumDialogRequested),this.listenTo(this.radio,"dialog:deleteFolder:requested",this.onDeleteFolderDialogRequested),this.listenTo(this.radio,"dialog:deleteAlbum:requested",this.onDeleteAlbumDialogRequested),this.listenTo(this.radio,"dialog:selectImage:requested",this.onSelectImageDialogRequested),this.listenTo(this.radio,"dialog:cropper:requested",this.onCropperDialogRequested),this.listenTo(this.radio,"dialog:notification:requested",this.onNotificationRequested)},onRender:function(){},onNewFolderDialogRequested:function(t){this.dialogType="newFolder",this.dialogModel=new o.Model({header:this.l10n.t("enterNewFolderNameHeader"),btnCancel:this.l10n.t("buttons.cancel"),btnCreate:this.l10n.t("buttons.create"),value:"",parentId:t.parentId}),this._showDialog(new l({model:this.dialogModel}))},onNewAlbumDialogRequested:function(t){this.dialogType="newAlbum",this.dialogModel=new o.Model({header:this.l10n.t("enterNewAlbumNameHeader"),btnCancel:this.l10n.t("buttons.cancel"),btnCreate:this.l10n.t("buttons.create"),value:"",parentId:t.parentId}),this._showDialog(new l({model:this.dialogModel}))},onDeleteFolderDialogRequested:function(t){this.dialogType="deleteFolder",this.dialogModel=new o.Model({id:t.id,header:this.l10n.t("confirmFolderDeleteHeader"),text:this.l10n.t("confirmFolderDeleteText",{name:t.name}),btnCancel:this.l10n.t("buttons.cancel"),btnConfirm:this.l10n.t("buttons.delete"),parentId:t.parentId}),this._showDialog(new a({model:this.dialogModel}))},onDeleteAlbumDialogRequested:function(t){this.dialogType="deleteAlbum",this.dialogModel=new o.Model({id:t.id,header:this.l10n.t("confirmAlbumDeleteHeader"),text:this.l10n.t("confirmAlbumDeleteText",{name:t.name}),btnCancel:this.l10n.t("buttons.cancel"),btnConfirm:this.l10n.t("buttons.delete"),parentId:t.parentId}),this._showDialog(new a({model:this.dialogModel}))},onSelectImageDialogRequested:function(t){this.dialogType="selectImage",this.dialogModel=new o.Model({id:t.id,header:this.l10n.t("selectCoverImage"),text:"",btnCancel:this.l10n.t("buttons.cancel")});var e=new u([],{parent_id:t.id});e.fetch(),this._showDialog(new d({model:this.dialogModel,collection:e}))},onCropperDialogRequested:function(t){this.dialogType="cropper",this.dialogModel=new o.Model({header:this.l10n.t("thumbnailCrop"),btnSave:this.l10n.t("buttons.save"),btnCancel:this.l10n.t("buttons.cancel"),item:t.item}),this._showDialog(new c({model:this.dialogModel}))},onDialogCancelled:function(){this._closeDialog()},onDialogConfirmed:function(){this._closeDialog(),this.radio.trigger("dialog:"+this.dialogType+":confirmed",{id:this.dialogModel.get("id"),parentId:this.dialogModel.get("parentId"),value:this.dialogModel.get("value")})},onNotificationRequested:function(t){var e=this.$el,i=n('<div class="vls-gf-notification"></div>').html(t.message);e.append(i),e.show(),setTimeout(function(){i.addClass("vls-gf-visible")},10),setTimeout(function(){i.addClass("vls-gf-anim-out").removeClass("vls-gf-visible"),setTimeout(function(){},300)},2e3)},_showDialog:function(t){var e=this.ui.backdrop;e.show(),this.dialogContainer.show(t),setTimeout(function(){e.css("opacity","1")},10)},_closeDialog:function(){var t=this.ui.backdrop,e=this.dialogContainer;t.css("opacity","0"),setTimeout(function(){e.empty(),t.hide()},500)}});t.exports=h},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="vls-gf-dialog-wrapper"></div>';return __p}},function(t,e,i){var n=i(40),s=i(123),o=n.extend({className:"vls-gf-dialog vls-gf-x8",template:s,ui:{field:".vls-gf-field",input:"#vls-gf-dialog-input",btnCancel:'.vls-gf-actions>button[data-action="cancel"]',btnConfirm:'.vls-gf-actions>button[data-action="confirm"]'},triggers:{"click @ui.btnCancel":"dialog:cancelled","click @ui.btnConfirm":"dialog:confirmed"},events:{}});t.exports=o},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="vls-gf-header">'+(null==(__t=header)?"":__t)+'</div>\r\n<div class="vls-gf-content">\r\n\t<p>'+(null==(__t=text)?"":__t)+'</p>\r\n</div>\r\n<div class="vls-gf-actions">\r\n\t<button data-action="cancel" class="vls-gf-btn-flat">'+(null==(__t=btnCancel)?"":__t)+'</button>\r\n\t<button data-action="confirm" class="vls-gf-btn-flat">'+(null==(__t=btnConfirm)?"":__t)+"</button>\r\n</div>";return __p}},function(t,e,i){var n=i(40),s=i(125),o=n.extend({className:"vls-gf-dialog vls-gf-x8",template:s,ui:{field:".vls-gf-field",input:"#vls-gf-dialog-input",btnCancel:'.vls-gf-actions>button[data-action="cancel"]',btnConfirm:'.vls-gf-actions>button[data-action="confirm"]'},triggers:{"click @ui.btnCancel":"dialog:cancelled","click @ui.btnConfirm":"dialog:confirmed"},events:{"change @ui.input":"onInputChange"},initialize:function(t){},onRender:function(){var t=this;this.ui.input.keydown(function(e){13==e.which&&(t.ui.input.blur(),t.triggerMethod("dialog:confirmed"))})},onShow:function(){this.ui.input.focus()},onInputChange:function(){this.model.set("value",this.ui.input.val())}});t.exports=o},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="vls-gf-header">'+(null==(__t=header)?"":__t)+'</div>\r\n<div class="vls-gf-content vls-gf-form">\r\n\t<div class="vls-gf-field">\r\n\t\t<input id="vls-gf-dialog-input" type="text" value=""/>\r\n\t</div>\r\n</div>\r\n<div class="vls-gf-actions">\r\n\t<button data-action="cancel" class="vls-gf-btn-flat">'+(null==(__t=btnCancel)?"":__t)+'</button>\r\n\t<button data-action="confirm" class="vls-gf-btn-flat vls-gf-btn-cl">'+(null==(__t=btnCreate)?"":__t)+"</button>\r\n</div>";return __p}},function(t,e,i){var n=i(2),s=i(26),o=i(127),r=i(128),a=i(31),l=s.extend({className:"vls-gf-dialog vls-gf-fullscreen vls-gf-dialog-select-image",template:o,childView:r,childViewContainer:".vls-gf-image-list",ui:{content:".vls-gf-content",btnCancel:'.vls-gf-actions>button[data-action="cancel"]'
},triggers:{"click @ui.btnCancel":"dialog:cancelled"},childEvents:{"image:selected":"onImageSelected"},onAttach:function(){var t={$:n,scroller:".vls-gf-scroll-scroller",container:".vls-gf-content",bar:".vls-gf-scroll-bar",barOnCls:"vls-gf-bar-on",scrollingCls:"vls-gf-scrolling",cssGuru:!0};a.call(this.ui.content,t)},onImageSelected:function(t,e){this.model.set("id",t.model.get("id")),this.model.set("value",t.model.get("cover_url")),this.triggerMethod("dialog:confirmed")}});t.exports=l},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="vls-gf-header">'+(null==(__t=header)?"":__t)+'</div>\r\n<div class="vls-gf-content">\r\n\t<div class="vls-gf-scroll-scroller">\r\n\t\t<div class="vls-gf-image-list">\r\n\t\t</div>\r\n\t</div>\r\n\t<div class="vls-gf-scroll-bar"></div>\r\n</div>\r\n<div class="vls-gf-actions">\r\n\t<button data-action="cancel" class="vls-gf-btn-flat">'+(null==(__t=btnCancel)?"":__t)+"</button>\r\n</div>";return __p}},function(t,e,i){var n=i(40),s=i(129),o=n.extend({className:"vls-gf-image",template:s,triggers:{click:"image:selected"}});t.exports=o},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<img src="'+(null==(__t=icon_url)?"":__t)+'">';return __p}},function(t,e,i){var n=i(5),s=i(40),o=i(131),r=96,a=48,l=112,d=s.extend({className:"vls-gf-dialog vls-gf-fullscreen vls-gf-dialog-cropper",template:o,ui:{imageWrapper:".vls-gf-image-wrapper",cropRegion:".vls-gf-crop-region",btnSave:'.vls-gf-actions>button[data-action="save"]',btnCancel:'.vls-gf-actions>button[data-action="cancel"]'},triggers:{"click @ui.btnCancel":"dialog:cancelled"},events:{"click @ui.btnSave":"onBtnSave"},initialize:function(){this.listenTo(this.radio,"global:windowResize",this.adjustDialogPosition),this.image=this.model.get("item"),this.cropMeta=n.extend({},this.image.get("crop_meta"))},onShow:function(){this.adjustDialogPosition(),this.ui.cropRegion.resizable({containment:this.ui.imageWrapper,handles:"all",autoHide:!1,minHeight:43,minWidth:43,stop:this.onCropRegionDragResize.bind(this)}),this.ui.cropRegion.draggable({containment:this.ui.imageWrapper,distance:2,addClasses:!1,cursor:"move",stop:this.onCropRegionDragResize.bind(this)})},adjustDialogPosition:function(t){var e=this.$el.parent(),i=e.width(),n=e.height(),s=i-r-a,o=n-r-l,d=this.image.get("image_width"),c=this.image.get("image_height"),u=d/c,h=s/o;u>h?o=Math.round(s/u):s=Math.round(o*u);var g=s+a,p=o+l;this.$el.css({top:Math.ceil((n-p)/2),bottom:n-p-Math.ceil((n-p)/2),left:Math.ceil((i-g)/2),right:i-g-Math.ceil((i-g)/2)});var f=this.cropMeta,v=f.top||0,m=f.left||0,_=f.width||d,b=f.height||c;this.ui.cropRegion.css({top:Math.round(v/c*o)+"px",left:Math.round(m/d*s)+"px",width:Math.round(_/d*s)+"px",height:Math.round(b/c*o)+"px"})},onCropRegionDragResize:function(t,e){var i=this.image.get("image_width"),n=this.image.get("image_height"),s=this.ui.cropRegion,o=this.ui.imageWrapper,r=s.position(),a=s.width(),l=s.height(),d=o.width(),c=o.height();this.cropMeta={top:Math.round(r.top/c*n),left:Math.round(r.left/d*i),width:Math.round(a/d*i),height:Math.round(l/c*n)}},onBtnSave:function(){var t=this.image.get("image_width"),e=this.image.get("image_height");!this.cropMeta.top>0&&!this.cropMeta.left>0&&this.cropMeta.width===t&&this.cropMeta.height===e&&(this.cropMeta={}),this.image.set("crop_meta",this.cropMeta),this.triggerMethod("dialog:cancelled")},serializeData:function(){var t=s.prototype.serializeData.call(this);return t.url=t.item.get("url"),t}});t.exports=d},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="vls-gf-header">'+(null==(__t=header)?"":__t)+'</div>\r\n<div class="vls-gf-content">\r\n\t<div class="vls-gf-image-wrapper" style="background-image: url('+(null==(__t=url)?"":__t)+'); background-size: cover;">\r\n\t\t<!--<img src="'+(null==(__t=url)?"":__t)+'"/>-->\r\n\t\t<div class="vls-gf-crop-region">\r\n\t\t\t<span class="vls-gf-resize-helper"></span>\r\n\t\t\t<span class="vls-gf-resize-helper"></span>\r\n\t\t\t<span class="vls-gf-resize-helper"></span>\r\n\t\t\t<span class="vls-gf-resize-helper"></span>\r\n\t\t\t<span class="vls-gf-resize-helper"></span>\r\n\t\t\t<span class="vls-gf-resize-helper"></span>\r\n\t\t\t<span class="vls-gf-resize-helper"></span>\r\n\t\t\t<span class="vls-gf-resize-helper"></span>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n<div class="vls-gf-actions">\r\n\t<button data-action="cancel" class="vls-gf-btn-flat">'+(null==(__t=btnCancel)?"":__t)+'</button>\r\n\t<button data-action="save" class="vls-gf-btn-flat">'+(null==(__t=btnSave)?"":__t)+"</button>\r\n</div>";return __p}},function(t,e,i){var n=i(5),s=i(3),o=i(47),r=s.Collection.extend({model:o,url:"image_collection_descendant",initialize:function(t,e){this.parent_id=e.parent_id,this.sortAttribute="id",this.sortOrder="asc"},fetch:function(t){t=t?t:{},t=n.extend(t,{data:{parent_id:this.parent_id}}),s.Collection.prototype.fetch.call(this,t)},comparator:function(t){var e=this.sortAttribute;return t.get(e)},sortByAttribute:function(t,e){this.comparator=function(e){return e.get(t)},"desc"===e?(this.sort({silent:!0}),this.models=this.models.reverse(),this.trigger("sort",this)):this.sort()}});t.exports=r},function(t,e,i){"use strict";var n=i(2),s=i(40),o=i(134),r=s.extend({el:"#vls-gf-layer-tutorial",template:o,templateHelpers:function(){return{t:{continue:this.l10n.t("tutorial.continue"),skipTutorial:this.l10n.t("tutorial.skipTutorial")}}},ui:{wrapper:".vls-gf-wrapper",overlay:".vls-gf-overlay",btnNext:"button.vls-gf-btn-next",btnSkip:"button.vls-gf-btn-skip"},events:{"click @ui.btnNext":"onBtnNext","click @ui.btnSkip":"onBtnSkip"},modelEvents:{"change:currentView":"onCurrentViewChange"},initialize:function(t){this.page="",this.step=0,this.frame,this.render()},onRender:function(){this.ui.overlay.on("wheel mousewheel touchmove",function(t){t.preventDefault(),t.stopPropagation()})},onCurrentViewChange:function(){var t=this.model.get("currentView");setTimeout(function(e){return function(){e.script[t]&&vlsGFData.tutorialStatus[t]===!1&&(e.page=t,e.step=1,e._showTutorial(),e._showNextStep())}}(this),1e3)},onBtnNext:function(){this._showNextStep()},onBtnSkip:function(){this._closeTutorial()},script:{manager:{1:function(t){var e=n("<div>").append('<h1 style="margin-bottom: 16px;">'+this.l10n.t("tutorial.manager.step1h")+"</h1>").append("<p>"+this.l10n.t("tutorial.manager.step1t")+"</p>");n("<div>").addClass("vls-gf-message-wrapper").css({top:"45%",left:"50%","max-width":"500px",transform:"translate(-50%, -50%)"}).append(e).appendTo(t),n('<div class="vls-gf-focus-wrapper"><div class="vls-gf-focus"></div></div>').appendTo(t);this.onStepWipe=null},2:function(t){var e=n(window),i=n("#vls-gf-layer-primary .vls-gf-content-wrapper .vls-gf-nav-panel"),s=n("#vls-gf-layer-primary .vls-gf-content-wrapper .vls-gf-side-panel"),o=(n('<div class="vls-gf-v-line"></div>').css({top:"30px",left:i.offset().left+i.outerWidth()-2+"px",bottom:"270px"}).appendTo(t),n('<div class="vls-gf-v-line"></div>').css({top:"30px",right:s.outerWidth()-2+"px",bottom:"270px"}).appendTo(t),n("<div>").append("<h1>"+this.l10n.t("tutorial.manager.step2ah")+"</h1>").append("<p>"+this.l10n.t("tutorial.manager.step2at")+"</p>")),r=n("<div>").addClass("vls-gf-message-wrapper vls-gf-anim-in").css({top:"144px",left:i.offset().left+24+"px",width:i.outerWidth()-48+"px"}).append(o).appendTo(t),a=n("<div>").append("<h1>"+this.l10n.t("tutorial.manager.step2bh")+"</h1>").append("<p>"+this.l10n.t("tutorial.manager.step2bt")+"</p>"),l=n("<div>").addClass("vls-gf-message-wrapper vls-gf-anim-in").css({top:"144px",left:i.offset().left+i.outerWidth()+112+"px",right:e.width()-s.offset().left+112+"px"}).append(a).appendTo(t),d=n("<div>").append("<h1>"+this.l10n.t("tutorial.manager.step2ch")+"</h1>").append("<p>"+this.l10n.t("tutorial.manager.step2ct")+"</p>"),c=n("<div>").addClass("vls-gf-message-wrapper vls-gf-anim-in").css({top:"144px",right:"24px",width:s.outerWidth()-48+"px"}).append(d).appendTo(t),u=n("<div>").append("<h1>"+this.l10n.t("tutorial.manager.step2dh")+"</h1>").append("<p>"+this.l10n.t("tutorial.manager.step2dt")+"</p>"),h=n("<div>").addClass("vls-gf-message-wrapper vls-gf-anim-in").css({right:"144px",bottom:"120px","max-width":"412px"}).append(u).appendTo(t),g=n('<div class="vls-gf-focus"></div>').css({display:"block",right:"8px",bottom:"8px",width:"88px",height:"88px","border-radius":"44px"});n('<div class="vls-gf-focus-wrapper"></div>').append(g).appendTo(t),n("<div>").addClass("vls-gf-backdrop").css({right:"8px",bottom:"8px",width:"88px",height:"88px","border-radius":"44px","background-color":"#f7f7f7"}).appendTo(t);n("#vls-gf-app .vls-gf-view-gallery-manager .vls-gf-fab-wrapper").css("z-index",100130),this.onStepWipe=function(t){t("#vls-gf-app .vls-gf-view-gallery-manager .vls-gf-fab-wrapper").css("z-index","")};var p=n("<div>").addClass("vls-gf-arrow vls-gf-anim-in").css({bottom:"32px",right:"131px",width:"113px",height:"84px","background-image":'url("data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjRkZGRkZGIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMTMgODQiPjxwYXRoICBkPSJNMTEzLDY4Yy04LjctMi41LTE5LjYtNy4yLTI2LjUtMTIuNEw5Miw2Ny45Yy00Ni45LTEuNS04MC43LTM1LjEtODktNjYuN2MtMC4yLTAuOC0xLTEuMy0xLjgtMS4xQzAuMywwLjMtMC4yLDEuMSwwLDEuOWM4LjYsMzIuOCw0My43LDY3LjYsOTIuMiw2OUw4OC42LDg0Qzk0LjcsNzcuOCwxMDQuOCw3MS43LDExMyw2OHoiLz48L3N2Zz4=")'}).appendTo(t);setTimeout(function(){r.removeClass("vls-gf-anim-in")},200),setTimeout(function(){l.removeClass("vls-gf-anim-in")},400),setTimeout(function(){c.removeClass("vls-gf-anim-in")},600),setTimeout(function(){h.removeClass("vls-gf-anim-in")},1e3),setTimeout(function(){p.removeClass("vls-gf-anim-in")},1e3)},3:function(t){var e=n("#vls-gf-layer-primary .vls-gf-fixed-wrapper .vls-gf-more-menu"),i=n("#vls-gf-layer-primary .vls-gf-fixed-wrapper .vls-gf-main h3"),s=n("#vls-gf-layer-primary .vls-gf-navigation-tree .vls-gf-folder").first(),o=n("#vls-gf-layer-primary .vls-gf-fixed-wrapper .vls-gf-primary-toolbar .vls-gf-main");s.find(">div").trigger("click");var r=n("<div>").append("<p>"+this.l10n.t("tutorial.manager.step3a")+"</p>"),a=n("<div>").addClass("vls-gf-message-wrapper vls-gf-anim-in").css({top:"172px",left:i.offset().left+60+"px",width:"280px"}).append(r).appendTo(t),l=n("<div>").append('<p style="text-align:right;">'+this.l10n.t("tutorial.manager.step3b")+"</p>"),d=n("<div>").addClass("vls-gf-message-wrapper vls-gf-anim-in").css({top:"66px",right:"280px",width:"300px"}).append(l).appendTo(t),c=n("<div>").append('<p style="text-align:center;">'+this.l10n.t("tutorial.manager.step3c")+"</p>"),u=n("<div>").addClass("vls-gf-message-wrapper vls-gf-anim-in").css({top:"180px",right:"46px",width:"200px"}).append(c).appendTo(t),h=n("<div>").append('<p style="text-align:center;">'+this.l10n.t("tutorial.manager.step3d")+"</p>"),g=n("<div>").addClass("vls-gf-message-wrapper vls-gf-anim-in").css({top:"488px",left:"50%",width:"400px",transform:"translateX(-50%)"}).append(h).appendTo(t),p=n('<div class="vls-gf-focus"></div>').css({display:"block",top:i.offset().top+"px",left:i.offset().left-24+"px",width:i.outerWidth()+48+"px",height:"64px"}),f=(n('<div class="vls-gf-focus-wrapper"></div>').css({right:"200px",height:"100px"}).append(p).appendTo(t),n('<div class="vls-gf-focus"></div>').css({display:"block",top:e.offset().top+"px",right:"50px",width:"112px",height:"48px","border-radius":"4px"})),v=(n('<div class="vls-gf-focus-wrapper"></div>').css({right:0,left:"auto",bottom:"auto",width:"200px",height:"100px"}).append(f).appendTo(t),n('<div class="vls-gf-focus"></div>').css({display:"block",top:s.offset().top-100+"px",left:s.offset().left+"px",width:s.outerWidth()+"px",height:s.outerHeight()+"px"})),m=(n('<div class="vls-gf-focus-wrapper"></div>').css({top:"100px",bottom:"auto",height:"200px"}).append(v).appendTo(t),n('<div class="vls-gf-focus"></div>').css({display:"block",top:"35px",left:o.offset().left+"px",right:"320px",height:"48px"})),_=(n('<div class="vls-gf-focus-wrapper"></div>').css({top:"300px"}).append(m).appendTo(t),n("<div>").addClass("vls-gf-arrow vls-gf-anim-in").css({top:i.offset().top+16+"px",left:i.offset().left+i.outerWidth()+34+"px",width:"108px",height:"116px","background-image":'url("data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjRkZGRkZGIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDggMTE2Ij48cGF0aCBkPSJNOTcuMiw0MS42QzgzLjYsMjIuNSw1Ny45LDEyLjksMjAuOCwxMi45bDQtMTIuOUMxOC42LDYsOC4zLDExLjgsMCwxNS40YzguNiwyLjcsMTkuNCw3LjUsMjYuMiwxMi45TDIxLDE1LjljMzYsMCw2MC44LDkuMiw3My44LDI3LjRjMTYuOCwyMy42LDkuMiw1NS4xLDMuMSw3MS43bDIuOCwxQzEwNyw5OC44LDExNC45LDY2LjIsOTcuMiw0MS42eiIvPjwvc3ZnPg==")'}).appendTo(t)),b=n("<div>").addClass("vls-gf-arrow vls-gf-anim-in").css({top:"130px",left:i.offset().left-70+"px",width:"165px",height:"67px","background-image":'url("data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjRkZGRkZGIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNjUgNjciPjxwYXRoIGQ9Ik04OC40LDAuNUM1NS4zLDMuNCwyNy4zLDIwLjMsOS4xLDQ4TDAsMzhjMS45LDguNCwxLjcsMjAuMSwwLjUsMjlDNy4zLDYxLDE3LDU0LjMsMjUuMSw1MS4zbC0xMy40LTEuOUMyOS40LDIyLjYsNTYuNiw2LjMsODguNywzLjRjMzIuOC0yLjksNjIuMSw4LjksNzQuMSwyMmwyLjItMkMxNTAuMiw3LjIsMTE4LjctMi4zLDg4LjQsMC41eiIvPjwvc3ZnPg==")'}).appendTo(t),y=n("<div>").addClass("vls-gf-arrow vls-gf-anim-in").css({top:"48px",right:"186px",width:"66px",height:"30px","background-image":'url("data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjRkZGRkZGIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NiAzMCI+DQo8cGF0aCAgZD0iTTY2LDE0Yy04LjUtMy4xLTE5LjEtOC4zLTI1LjctMTRsNC44LDEyLjhjLTEwLjgsMS40LTI2LjYsNS00NC4zLDE0LjRjLTAuNywwLjQtMSwxLjMtMC42LDINCglDMC40LDI5LjcsMSwzMCwxLjUsMzBjMC4yLDAsMC41LTAuMSwwLjctMC4yQzE5LjMsMjAuNywzNC40LDE3LjEsNDUsMTUuOGwtNC40LDEyLjZDNDcsMjIuNiw1Ny41LDE3LjIsNjYsMTR6Ii8+DQo8L3N2Zz4=")'}).appendTo(t),w=n("<div>").addClass("vls-gf-arrow vls-gf-anim-in").css({top:"104px",right:"76px",width:"44px",height:"70px","background-image":'url("data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjRkZGRkZGIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0NCA3MCI+DQo8cGF0aCBkPSJNNDQsMjcuNkMzOS41LDIwLjIsMzYuMSw4LjksMzQuNSwwYy00LjYsNy44LTExLjgsMTcuMS0xOC42LDIyLjVsMTMuMy0yLjJjLTQuMiwxNS40LTEyLjQsMzUtMjguNiw0Nw0KCWMtMC43LDAuNS0wLjgsMS40LTAuMywyLjFDMC42LDY5LjgsMSw3MCwxLjUsNzBjMC4zLDAsMC42LTAuMSwwLjktMC4zYzE3LTEyLjYsMjUuNS0zMywyOS44LTQ4LjlMNDQsMjcuNnoiLz4NCjwvc3ZnPg==")'}).appendTo(t),x=n("<div>").addClass("vls-gf-arrow vls-gf-anim-in").css({top:"400px",left:"50%",width:"27px",height:"74px",transform:"translateX(-80%)","background-image":'url("data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjRkZGRkZGIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNyA3NCI+DQo8cGF0aCBkPSJNMjcsMTguN0MxOS4yLDE0LjcsMTAuMiw2LjgsNC4xLDBDNC4yLDkuMSwzLDIwLjksMCwyOS4xbDEwLjQtOC45YzYuNSwxOC44LDguOSwzNC4xLDguNCw1My44bDMsMC4xDQoJYzAuNS0yMC4xLTEuOS0zNS43LTguNi01NUwyNywxOC43eiIvPg0KPC9zdmc+")'}).appendTo(t);this.onStepWipe=null,setTimeout(function(){a.removeClass("vls-gf-anim-in"),_.removeClass("vls-gf-anim-in"),b.removeClass("vls-gf-anim-in")},200),setTimeout(function(){d.removeClass("vls-gf-anim-in"),y.removeClass("vls-gf-anim-in")},400),setTimeout(function(){u.removeClass("vls-gf-anim-in"),w.removeClass("vls-gf-anim-in")},600),setTimeout(function(){g.removeClass("vls-gf-anim-in"),x.removeClass("vls-gf-anim-in")},800)},4:function(t){var e=n("#vls-gf-layer-primary .vls-gf-content-wrapper .vls-gf-nav-panel").first();n("#vls-gf-layer-primary .vls-gf-navigation-tree .vls-gf-album").first().find(">div").trigger("click"),setTimeout(function(){n("#vls-gf-layer-primary .vls-gf-image-list li").first().trigger("click")},200);var i=n("<div>").append('<p style="text-align:center;">'+this.l10n.t("tutorial.manager.step4a")+"</p>"),s=n("<div>").addClass("vls-gf-message-wrapper vls-gf-anim-in").css({top:"196px",right:"376px",width:"440px"}).append(i).appendTo(t),o=n("<div>").addClass("vls-gf-arrow vls-gf-anim-in").css({top:"118px",right:"456px",width:"102px",height:"69px","background-image":'url("data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjRkZGRkZGIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDIgNjkiPg0KPHBhdGggZD0iTTc1LjEsMEw4MSwxMi4yYy0zNy44LDYuMS02NSwyNC40LTgwLjgsNTQuNmMtMC40LDAuNy0wLjEsMS42LDAuNiwyQzEsNjguOSwxLjMsNjksMS41LDY5DQoJYzAuNSwwLDEuMS0wLjMsMS4zLTAuOGMxNS4zLTI5LjIsNDEuNy00Nyw3OC40LTUzbC0zLjMsMTNjNi02LjMsMTUuOS0xMi43LDI0LjEtMTYuNkM5My4yLDkuMyw4Mi4yLDUsNzUuMSwweiIvPg0KPC9zdmc+")'}).appendTo(t),r=n("<div>").append('<p style="text-align:center;">'+this.l10n.t("tutorial.manager.step4b")+"</p>"),a=n("<div>").addClass("vls-gf-message-wrapper vls-gf-anim-in").css({top:"196px",right:"52px",width:"300px"}).append(r).appendTo(t),l=n("<div>").addClass("vls-gf-arrow vls-gf-anim-in").css({top:"120px",right:"226px",width:"79px",height:"62px","background-image":'url("data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjRkZGRkZGIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA3OSA2MiI+DQo8cGF0aCBkPSJNNzguOSw2MEM2Ny40LDI4LjYsMzYuMywxNi4yLDIwLjgsMTEuOUwyNy41LDBDMjAuMSw0LjUsOC45LDguMSwwLDkuOEM3LjksMTQuMywxNy40LDIxLjMsMjIuOSwyOA0KCWwtMi40LTEzLjFDMzUuNSwxOS4xLDY1LjIsMzEuMSw3Ni4xLDYxYzAuMiwwLjYsMC44LDEsMS40LDFjMC4yLDAsMC4zLDAsMC41LTAuMUM3OC44LDYxLjYsNzkuMiw2MC44LDc4LjksNjB6Ii8+DQo8L3N2Zz4=")'}).appendTo(t),d=n("#vls-gf-layer-primary .vls-gf-view-album-overview"),c=Math.floor((d.outerWidth()-48)/168),u=d.offset().left+28+168*(c-1),h=n('<div class="vls-gf-focus"></div>').css({display:"block",top:"156px",left:u+"px",width:"160px",height:"160px"}),g=(n('<div class="vls-gf-focus-wrapper"></div>').css({top:"200px",right:"320px"}).append(h).appendTo(t),n("<div>").append('<p style="text-align:center;">'+this.l10n.t("tutorial.manager.step4c")+"</p>")),p=n("<div>").addClass("vls-gf-message-wrapper vls-gf-anim-in").css({top:"540px",left:u+200+"px",right:"100px"}).append(g).appendTo(t),f=n("<div>").addClass("vls-gf-arrow vls-gf-anim-in").css({top:"420px",left:u+194+"px",width:"100px",height:"96px","background-image":'url("data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjRkZGRkZGIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgOTYiPg0KCTxwYXRoIGQ9Ik0xMDAsOTQuM0M5NSw1Ny45LDY1LjcsMTcuNiwyMC44LDEzbDQuMy0xM0MxOC43LDUuOSw4LjQsMTEuNiwwLDE1YzguNiwyLjksMTkuMiw3LjksMjUuOSwxMy40TDIxLDE2DQoJYzQzLjEsNC43LDcxLjIsNDMuNiw3Niw3OC43YzAuMSwwLjcsMC43LDEuMywxLjUsMS4zYzAuMSwwLDAuMSwwLDAuMiwwQzk5LjUsOTUuOSwxMDAuMSw5NS4xLDEwMCw5NC4zeiIvPg0KPC9zdmc+")'}).appendTo(t),v=n("<div>").addClass("vls-gf-arrow vls-gf-anim-in").css({top:"430px",right:"76px",width:"100px",height:"96px","background-image":'url("data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjRkZGRkZGIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgOTYiPg0KCTxwYXRoIGQ9Ik0wLDk0LjNDNSw1Ny45LDM0LjMsMTcuNiw3OS4yLDEzTDc0LjksMGM2LjMsNS45LDE2LjcsMTEuNiwyNS4xLDE1Yy04LjYsMi45LTE5LjIsNy45LTI1LjksMTMuNEw3OSwxNg0KCUMzNS45LDIwLjgsNy44LDU5LjYsMyw5NC43QzIuOSw5NS41LDIuMiw5NiwxLjUsOTZjLTAuMSwwLTAuMSwwLTAuMiwwQzAuNSw5NS45LTAuMSw5NS4xLDAsOTQuM3oiLz4NCjwvc3ZnPg==")'}).appendTo(t),m=n("<div>").append('<p style="text-align:center;">'+this.l10n.t("tutorial.manager.step4d")+"</p>"),_=n("<div>").addClass("vls-gf-message-wrapper vls-gf-anim-in").css({top:"420px",left:e.offset().left+e.outerWidth()-10+"px",width:"240px"}).append(m).appendTo(t),b=n("<div>").addClass("vls-gf-arrow vls-gf-anim-in").css({top:"408px",left:e.offset().left+120+"px",width:"256px",height:"207px","background-image":'url("data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjRkZGRkZGIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNTYgMjA3Ij4NCiAgICA8cGF0aCBkPSJNMjQ1LDE4NWMtNS41LDAtMTAsNC0xMC44LDkuM2MtOTAuNC01LTE5My43LTY5LjMtMjE5LjYtMTc0LjFMMjgsMjIuNEMyMS4xLDE3LjEsMTMuOCw3LjcsOS4xLDANCiAgICAgICAgICAgICAgICBDNy42LDguOSw0LjQsMjAuMywwLDI3LjhsMTEuNi02LjljMTYuMSw2NS4zLDU4LjgsMTA2LjcsOTIuMSwxMjkuOWMzOS4zLDI3LjQsODYuMiw0NC4xLDEzMC40LDQ2LjZjMC43LDUuNCw1LjMsOS43LDEwLjksOS43DQogICAgICAgICAgICAgICAgYzYuMSwwLDExLTQuOSwxMS0xMVMyNTEuMSwxODUsMjQ1LDE4NXoiLz4NCjwvc3ZnPg==")'}).appendTo(t),y=n('<div class="vls-gf-focus"></div>').css({display:"block",top:"105px",right:"325px",width:"112px",height:"48px","border-radius":"4px"}),w=(n('<div class="vls-gf-focus-wrapper"></div>').css({bottom:"auto",height:"200px"}).append(y).appendTo(t),n('<div class="vls-gf-focus"></div>').css({display:"block","border-radius":"24px"}));n('<div class="vls-gf-focus-wrapper"></div>').css({top:"200px",right:"0",left:"auto",width:"320px"}).append(w).appendTo(t);setTimeout(function(){var t=n("#vls-gf-layer-primary .vls-gf-content-wrapper .vls-gf-side-panel .vls-gf-icon-edit-h");w.css({top:t.offset().top-200+"px",right:"8px",width:"48px",height:"48px"})},600),setTimeout(function(){s.removeClass("vls-gf-anim-in"),o.removeClass("vls-gf-anim-in")},200),setTimeout(function(){a.removeClass("vls-gf-anim-in"),l.removeClass("vls-gf-anim-in")},400),setTimeout(function(){p.removeClass("vls-gf-anim-in"),f.removeClass("vls-gf-anim-in"),v.removeClass("vls-gf-anim-in")},600),setTimeout(function(){_.removeClass("vls-gf-anim-in"),b.removeClass("vls-gf-anim-in")},800),this.onStepWipe=null}}},_showNextStep:function(){var t=this.script[this.page][this.step];t?(this._wipeCurrentFrame(),this._showNewFrame(),t.call(this,this.frame),this.step++):this._closeTutorial()},_showNewFrame:function(){var t=n("<div>").addClass("vls-gf-frame vls-gf-anim-in");this.ui.wrapper.append(t),this.frame=t,setTimeout(function(){t.removeClass("vls-gf-anim-in")},20)},_wipeCurrentFrame:function(){if(this.frame){var t=this.frame;this.frame=null,t.addClass("vls-gf-anim-out"),this.onStepWipe&&this.onStepWipe.call(this,n),setTimeout(function(){t.remove()},2e3)}},_showTutorial:function(){this.model.get("tutorialActive")||(this.model.set("tutorialActive",!0),this.$el.show())},_closeTutorial:function(){if(this.model.get("tutorialActive")){this._wipeCurrentFrame(),this.model.set("tutorialActive",!1),this.$el.hide();var t=this.page,e={};e[this.page]=!0,n.post(ajaxurl,{action:"vls_gf_api_user_onboarding",_method:"PATCH",nonce:vlsGFData.nonce,model:JSON.stringify(e)},function(){vlsGFData.tutorialStatus[t]=!0,"manager"==t&&location.reload(!0)})}}});t.exports=r},function(module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<!--<div class="vls-gf-focus"></div>-->\r\n<div class="vls-gf-scrim"></div>\r\n\r\n<div class="vls-gf-wrapper">\r\n\r\n</div>\r\n\r\n<div class="vls-gf-overlay"></div>\r\n\r\n<div class="vls-gf-nav">\r\n\t<button class="vls-gf-btn-next">'+(null==(__t=t.continue)?"":__t)+'</button>\r\n\t<button class="vls-gf-btn-skip">'+(null==(__t=t.skipTutorial)?"":__t)+"</button>\r\n</div>\r\n";return __p}},function(t,e,i){"use strict";var n=i(22),s=i(28),o=i(35),r=i(59),a=i(62),l=function(){s.prototype.fetch=function(t){var e,i=this;e=0==this.parentId?[{id:1,type:"folder",name:n.t("tutorial.sampleFolder",{n:1})},{id:2,type:"folder",name:n.t("tutorial.sampleFolder",{n:2})},{id:3,type:"folder",name:n.t("tutorial.sampleFolder",{n:3})},{id:4,type:"folder",name:n.t("tutorial.sampleFolder",{n:4})},{id:5,type:"folder",name:n.t("tutorial.sampleFolder",{n:5})},{id:6,type:"album",name:n.t("tutorial.sampleAlbum",{n:1})}]:1==this.parentId?[{id:11,type:"folder",name:n.t("tutorial.sampleFolder",{n:6})},{id:12,type:"folder",name:n.t("tutorial.sampleFolder",{n:7})},{id:13,type:"album",name:n.t("tutorial.sampleAlbum",{n:2})},{id:14,type:"album",name:n.t("tutorial.sampleAlbum",{n:3})},{id:15,type:"album",name:n.t("tutorial.sampleAlbum",{n:4})}]:[],setTimeout(function(){i.reset(e,{}),i.trigger("sync",i,e,{})},100)}},d=function(){o.prototype.fetch=function(t){var e,i=this;if("folder"===this.type&&0==this.parentId)e=[{id:1,type:"folder",name:n.t("tutorial.sampleFolder",{n:1}),caption:"",description:""},{id:2,type:"folder",name:n.t("tutorial.sampleFolder",{n:2}),caption:"",description:""},{id:3,type:"folder",name:n.t("tutorial.sampleFolder",{n:3}),caption:"",description:""},{id:4,type:"folder",name:n.t("tutorial.sampleFolder",{n:4}),caption:"",description:""},{id:5,type:"folder",name:n.t("tutorial.sampleFolder",{n:5}),caption:"",description:""},{id:6,type:"album",name:n.t("tutorial.sampleAlbum",{n:1}),caption:"",description:""}];else if("folder"===this.type&&1==this.parentId)e=[{id:11,type:"folder",name:n.t("tutorial.sampleFolder",{n:6}),caption:"",description:""},{id:12,type:"folder",name:n.t("tutorial.sampleFolder",{n:7}),caption:"",description:"",folder_count:0,album_count:0},{id:13,type:"album",name:n.t("tutorial.sampleAlbum",{n:2}),caption:"",description:""},{id:14,type:"album",name:n.t("tutorial.sampleAlbum",{n:3}),caption:"",description:""},{id:15,type:"album",name:n.t("tutorial.sampleAlbum",{n:4}),caption:"",description:""}];else if("album"===this.type&&6==this.parentId){e=[];for(var s=1;s<60;s++)e.push({id:1e3+s,image_id:2e3+s,icon_url:"data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjRkZGRkZGIiB3aWR0aD0iMzAiIGhlaWdodD0iMzAiIHZpZXdCb3g9IjAgMCAzMCAzMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxwYXRoIGQ9Ik0yNCwyMlY4YzAtMS4xLTAuOS0yLTItMkg4QzYuOSw2LDYsNi45LDYsOHYxNGMwLDEuMSwwLjksMiwyLDJoMTRDMjMuMSwyNCwyNCwyMy4xLDI0LDIyeiBNMTEuNSwxNi41bDIuNSwzDQoJbDMuNS00LjVsNC41LDZIOEwxMS41LDE2LjV6Ii8+DQo8L3N2Zz4NCg=="})}else e=[];setTimeout(function(){i.reset(e,{}),i.trigger("sync",i,e,{})},100)}},c=function(){r.prototype.fetch=function(t){var e=this,i={name:"Sample album",caption:"Sample album",description:"The description of the sample album"};setTimeout(function(){e.set(i,{}),e.trigger("sync",e,i,{})},100)}},u=function(){a.prototype.fetch=function(t){var e=this,i={name:"Image",caption:"Sample image",description:"The description of the sample image",cover_url:"data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjRkZGRkZGIiB3aWR0aD0iMzAiIGhlaWdodD0iMzAiIHZpZXdCb3g9IjAgMCAzMCAzMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxwYXRoIGQ9Ik0yNCwyMlY4YzAtMS4xLTAuOS0yLTItMkg4QzYuOSw2LDYsNi45LDYsOHYxNGMwLDEuMSwwLjksMiwyLDJoMTRDMjMuMSwyNCwyNCwyMy4xLDI0LDIyeiBNMTEuNSwxNi41bDIuNSwzDQoJbDMuNS00LjVsNC41LDZIOEwxMS41LDE2LjV6Ii8+DQo8L3N2Zz4NCg==",created:"",alt_text:"sample image",filename:"filename.jpg",file_size:34e4,width:3e3,height:2e3,image_meta:{camera:"",lens:"",focal_length:"",shutter_speed:"",aperture:"",iso:"",creation_date:""}};setTimeout(function(){e.set(i,{}),e.trigger("sync",e,i,{})},100)}},h={setup:function(){l(),d(),c(),u()}};t.exports=h}]);