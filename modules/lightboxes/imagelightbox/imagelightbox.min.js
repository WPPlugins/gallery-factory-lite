!function(t,e,n,i){"use strict";var o=function(){var t=n.body||n.documentElement,t=t.style;return""==t.WebkitTransition?"-webkit-":""==t.MozTransition?"-moz-":""==t.OTransition?"-o-":""==t.transition&&""},r=o()!==!1,a=function(t,e,n){var i={},r=o();i[r+"transform"]="translateX("+e+")",i[r+"transition"]=r+"transform "+n+"s linear",t.css(i)},f="ontouchstart"in e,u=e.navigator.pointerEnabled||e.navigator.msPointerEnabled,c=function(t){if(f)return!0;if(!u||"undefined"==typeof t||"undefined"==typeof t.pointerType)return!1;if("undefined"!=typeof t.MSPOINTER_TYPE_MOUSE){if(t.MSPOINTER_TYPE_MOUSE!=t.pointerType)return!0}else if("mouse"!=t.pointerType)return!0;return!1};t.fn.imageLightbox=function(i){var i=t.extend({selector:'id="imagelightbox"',allowedTypes:"png|jpg|jpeg|gif",animationSpeed:250,preloadNext:!0,enableKeyboard:!0,quitOnEnd:!1,quitOnImgClick:!1,quitOnDocClick:!0,onStart:!1,onEnd:!1,onLoadStart:!1,onLoadEnd:!1,topShift:20,bottomShift:68,container:t()},i),o=t([]),d=t(),l=t(),h=0,p=0,g=0,s=!1,m=function(e){return"a"==t(e).prop("tagName").toLowerCase()&&new RegExp(".("+i.allowedTypes+")$","i").test(t(e).attr("href"))},v=function(){if(!l.length)return!0;var n=.9*t(e).width(),o=.94*(t(e).height()-i.topShift-i.bottomShift),r=new Image;r.src=l.attr("src"),r.onload=function(){if(h=r.width,p=r.height,h>n||p>o){var a=h/p>n/o?h/n:p/o;h/=a,p/=a}l.css({width:h+"px",height:p+"px",top:(t(e).height()-p-i.topShift-i.bottomShift)/2+i.topShift+"px",left:(t(e).width()-h)/2+"px"})}},x=function(e){if(s)return!1;if(e="undefined"!=typeof e&&("left"==e?1:-1),l.length){if(e!==!1&&(o.length<2||i.quitOnEnd===!0&&(e===-1&&0==o.index(d)||1===e&&o.index(d)==o.length-1)))return E(),!1;var n={opacity:0};r?a(l,100*e-g+"px",i.animationSpeed/1e3):n.left=parseInt(l.css("left"))+100*e+"px",l.animate(n,i.animationSpeed,function(){S()}),g=0}s=!0,i.onLoadStart!==!1&&i.onLoadStart(),setTimeout(function(){l=t("<img "+i.selector+" />").attr("src",d.attr("href")).load(function(){l.appendTo("body"),v();var n={opacity:1};if(l.css("opacity",0),r)a(l,-100*e+"px",0),setTimeout(function(){a(l,"0px",i.animationSpeed/1e3)},50);else{var f=parseInt(l.css("left"));n.left=f+"px",l.css("left",f-100*e+"px")}if(l.animate(n,i.animationSpeed,function(){s=!1,i.onLoadEnd!==!1&&i.onLoadEnd()}),i.preloadNext){var u=o.eq(o.index(d)+1);u.length||(u=o.eq(0)),t("<img />").attr("src",u.attr("href")).load()}}).error(function(){i.onLoadEnd!==!1&&i.onLoadEnd()});var n=0,f=0,p=0;l.on(u?"pointerup MSPointerUp":"click",function(t){if(t.preventDefault(),i.quitOnImgClick)return E(),!1;if(c(t.originalEvent))return!0;var e=(t.pageX||t.originalEvent.pageX)-t.target.offsetLeft;d=o.eq(o.index(d)-(h/2>e?1:-1)),d.length||(d=o.eq(h/2>e?o.length:0)),x(h/2>e?"left":"right")}).on("touchstart pointerdown MSPointerDown",function(t){return!(c(t.originalEvent)&&!i.quitOnImgClick)||(r&&(p=parseInt(l.css("left"))),void(n=t.originalEvent.pageX||t.originalEvent.touches[0].pageX))}).on("touchmove pointermove MSPointerMove",function(t){return!(c(t.originalEvent)&&!i.quitOnImgClick)||(t.preventDefault(),f=t.originalEvent.pageX||t.originalEvent.touches[0].pageX,g=n-f,void(r?a(l,-g+"px",0):l.css("left",p-g+"px")))}).on("touchend touchcancel pointerup pointercancel MSPointerUp MSPointerCancel",function(t){return!(c(t.originalEvent)&&!i.quitOnImgClick)||void(Math.abs(g)>50?(d=o.eq(o.index(d)-(g<0?1:-1)),d.length||(d=o.eq(g<0?o.length:0)),x(g>0?"right":"left")):r?a(l,"0px",i.animationSpeed/1e3):l.animate({left:p+"px"},i.animationSpeed/2))})},i.animationSpeed+100)},S=function(){return!!l.length&&(l.remove(),void(l=t()))},E=function(){return!!l.length&&void l.animate({opacity:0},i.animationSpeed,function(){S(),s=!1,i.onEnd!==!1&&i.onEnd()})};return t(e).on("resize",v),i.quitOnDocClick&&t(n).on(f?"touchend":"click",function(e){l.length&&!t(e.target).is(l)&&E()}),i.enableKeyboard&&t(n).on("keyup",function(t){return!l.length||(t.preventDefault(),27==t.keyCode&&E(),void(37!=t.keyCode&&39!=t.keyCode||(d=o.eq(o.index(d)-(37==t.keyCode?1:-1)),d.length||(d=o.eq(37==t.keyCode?o.length:0)),x(37==t.keyCode?"left":"right"))))}),this.switchImageLightbox=function(t){var e=o.eq(t);if(e.length){var n=o.index(d);d=e,x(t<n?"left":"right")}return this},this.switchNextImage=function(){d=o.eq(o.index(d)+1),d.length||(d=o.eq(0)),x("right")},this.switchPrevImage=function(){d=o.eq(o.index(d)-1),d.length||(d=o.eq(o.length-1)),x("left")},this.quitImageLightbox=function(){return E(),this},this.updateTargets=function(e,n){n||(o.each(function(){t(this).off("click.imagelightbox")}),o=t([])),e.find(".vls-gf-item:not(.vls-gf-hidden) a").each(function(){m(this)&&(o=o.add(t(this)))}),o.off(),o.on("click.imagelightbox",function(e){return!m(this)||(e.preventDefault(),!s&&(s=!1,i.onStart!==!1&&i.onStart(),d=t(this),x(),!1))})},this.updateTargets(i.container,!1),this}}(jQuery,window,document);